!function(e){function t(t){for(var i,a,o=t[0],h=t[1],l=t[2],c=0,p=[];c<o.length;c++)a=o[c],Object.prototype.hasOwnProperty.call(n,a)&&n[a]&&p.push(n[a][0]),n[a]=0;for(i in h)Object.prototype.hasOwnProperty.call(h,i)&&(e[i]=h[i]);for(u&&u(t);p.length;)p.shift()();return r.push.apply(r,l||[]),s()}function s(){for(var e,t=0;t<r.length;t++){for(var s=r[t],i=!0,o=1;o<s.length;o++){var h=s[o];0!==n[h]&&(i=!1)}i&&(r.splice(t--,1),e=a(a.s=s[0]))}return e}var i={},n={0:0},r=[];function a(t){if(i[t])return i[t].exports;var s=i[t]={i:t,l:!1,exports:{}};return e[t].call(s.exports,s,s.exports,a),s.l=!0,s.exports}a.m=e,a.c=i,a.d=function(e,t,s){a.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:s})},a.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},a.t=function(e,t){if(1&t&&(e=a(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var s=Object.create(null);if(a.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)a.d(s,i,function(t){return e[t]}.bind(null,i));return s},a.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return a.d(t,"a",t),t},a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},a.p="";var o=window.webpackJsonp=window.webpackJsonp||[],h=o.push.bind(o);o.push=t,o=o.slice();for(var l=0;l<o.length;l++)t(o[l]);var u=h;r.push([529,1]),s()}({1429:function(e,t){
/**
 * PLEASE DO NOT REMOVE THIS NOTICE!
 *
 * @template        This Phaser game was built using phaser-project-template-es6 (https://github.com/yandeu/phaser-project-template-es6)
 * @author          Yannick Deubel (https://github.com/yandeu)
 * @copyright       2019 Yannick Deubel
 * @license         {@link https://github.com/yandeu/phaser-project-template-es6/blob/master/LICENSE|MIT License}
 */
console.log("%c %c %c %c %c Built using phaser-project-template-es6 %c https://github.com/yandeu/phaser-project-template-es6","background: #ff0000","background: #ffff00","background: #00ff00","background: #00ffff","color: #fff; background: #000000;","background: none")},1430:function(e,t,s){"use strict";s.r(t);s(530),Math.lerp=function(e,t,s){return e+(t-e)*s},Math.unlerp=function(e,t,s){return(s-e)/(t-e)},Math.rotateToAngle=function(e,t,s){if(e.rotation){var i=Math.angRotate(e.rotation,s,t);isNaN(i)||e.rotation!==i&&(e.rotation=i)}},Math.angRotate=function(e,t,s){var i,n=Math.sin(e),r=Math.cos(e),a=Math.sin(t),o=Math.cos(t);return i=Math.acos(n*a+r*o)>s?r*a-n*o>0?e+s:e-s:t,Math.clampAngle(i)},Math.clampAngle=function(e){return(e%=2*Math.PI)<0&&(e+=2*Math.PI),e},Math.cloneDeep=function(e){return JSON.parse(JSON.stringify(e))};function i(e,t){for(var s=0;s<t.length;s++){var i=t[s];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var n=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,s,n;return t=e,n=[{key:"isMobile",get:function(){var e=!1;return this.isCordova=void 0!==window.device&&(void 0!==window.device.cordova||void 0!==window.device.phonegap),this.isMicrosoftEdge=/edge\//i.test(navigator.userAgent),this.isIE=(/msie/i.test(navigator.userAgent)||/trident/i.test(navigator.userAgent)||/iemobile/i.test(navigator.userAgent))&&!this.isMicrosoftEdge,this.isTizen=/tizen/i.test(navigator.userAgent),this.isAndroid=/android/i.test(navigator.userAgent)&&!this.isTizen&&!this.isIE&&!this.isMicrosoftEdge,this.isiPhone=(/iphone/i.test(navigator.userAgent)||/ipod/i.test(navigator.userAgent))&&!this.isIE&&!this.isMicrosoftEdge,this.isiPad=/ipad/i.test(navigator.userAgent),this.isiOS=this.isiPhone||this.isiPad,this.isiPhoneiOS6=this.isiPhone&&/os\s6/i.test(navigator.userAgent),this.isSafari=/safari/i.test(navigator.userAgent)&&!this.isChrome&&!this.isIE&&!this.isMicrosoftEdge,this.maxTouchPoints=navigator.maxTouchPoints>0,(e=this.isCordova||this.isAndroid||this.isiOS||this.isiPhoneiOS6||this.isTizen||this.maxTouchPoints)||(e=/(blackberry|bb10|playbook|palm|symbian|nokia|windows\s+ce|phone|mobile|tablet|kindle|silk)/i.test(navigator.userAgent)),e}}],(s=null)&&i(t.prototype,s),n&&i(t,n),e}();function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function a(e,t){for(var s=0;s<t.length;s++){var i=t[s];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function o(e,t){return!t||"object"!==r(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function h(e){return(h=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function l(e,t){return(l=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var u=function(e){function t(e,s){var i;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(i=o(this,h(t).call(this,e,s))).scene=e,i.worldView={},i.anchorObjects||(i.anchorObjects={}),i.anchorObjects[i.scene.scene.key]=[];return i.scene.scale.on("resize",function(e,t,s,r){!function(e){var t=-(e.width-i.game.config.width)/2,s=-(e.height-i.game.config.height)/2;i.worldView.left=t,i.worldView.top=s,i.worldView.right=t+e.width,i.worldView.bottom=s+e.height,i.worldView.width=e.width,i.worldView.height=e.height,i.scene.game.renderer.resize(e.width,e.height,1),i.scene.physics&&i.scene.physics.world&&i.scene.physics.world.setBounds(t,s,e.width,e.height,!1,!1,!1,!1),i.scene.cameras&&i.scene.cameras.main&&(i.scene.cameras.resize(e.width,e.height),i.scene.cameras.main.setSize(e.width,e.height),i.scene.cameras.main.centerOn(i.game.config.width/2,i.game.config.height/2),i.scene.cameras.main.setBounds(t,s,e.width,e.height),i.posAnchorObjects(i.scene)),i.scene.isMobile=n.isMobile,"MobileJoystick"===i.scene.scene.key&&i.scene.isMobile,i.scene.onResize&&i.scene.onResize.call(i.scene)}(e)}),i.scene.scale.refresh(),i}var s,i,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&l(e,t)}(t,Phaser.Plugins.ScenePlugin),s=t,(i=[{key:"posAnchorObjects",value:function(e){var t=e.children.list.length;if(0!==t)for(var s=this.worldView,i=e.game.config.width,n=e.game.config.height,r=0;r<t;r++){var a=e.children.list[r];if(a.anchor_ltrd&&""!==a.anchor_ltrd){var o=/L/i.test(a.anchor_ltrd),h=/R/i.test(a.anchor_ltrd),l=/T/i.test(a.anchor_ltrd),u=/D/i.test(a.anchor_ltrd),c=a.anchor_weight.length>0?a.anchor_weight[0]:1,p=a.anchor_weight.length>1?a.anchor_weight[1]:c;o&&(a.x=Math.round(Math.lerp(a.init_x,s.left+a.init_x,c))),h&&(a.x=Math.round(Math.lerp(a.init_x,s.right-(i-a.init_x),c))),l&&(a.y=Math.round(Math.lerp(a.init_y,s.top+a.init_y,p))),u&&(a.y=Math.round(Math.lerp(a.init_y,s.bottom-(n-a.init_y),p)))}}}},{key:"addAnchorObject",value:function(e){}}])&&a(s.prototype,i),r&&a(s,r),t}();function c(e){return(c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function p(e,t){var s=function e(t,s){for(var i in t){var n=t[i];"object"!==c(n)||Array.isArray(n)?Array.isArray(n)?(s.hasOwnProperty(i)&&c(s[i])===c(n)||(s[i]=[],s[i]=Math.cloneDeep(e(n,s[i]))),0!==s[i].length&&"object"!==c(s[i][0])||(s[i]=Math.cloneDeep(e(n,s[i])))):s.hasOwnProperty(i)||(s[i]=n):s.hasOwnProperty(i)?s[i]=Math.cloneDeep(e(n,s[i])):(s[i]={},s[i]=Math.cloneDeep(n))}return s};for(var i in e)if(t.hasOwnProperty(i)&&t[i].hasOwnProperty("units")){if(e[i].hasOwnProperty("units"))for(var n in e[i].units)t[i].units.hasOwnProperty(n)||(t[i].units[n]=Math.cloneDeep(e[i].units[n]))}else if(t[i]={},t[i].units={},e[i].hasOwnProperty("units"))for(var r in Array.isArray(e[i].units)&&(t[i].units=[]),e[i].units)t[i].units[r]=Math.cloneDeep(e[i].units[r]);var a=[],o=[];if(t.hasOwnProperty("asteroids")&&t.asteroids.hasOwnProperty("units")&&(a=Object.keys(t.asteroids.units)),t.hasOwnProperty("enemies")&&t.enemies.hasOwnProperty("units")&&(o=Object.keys(t.enemies.units)),e.hasOwnProperty("waves")&&e.waves.hasOwnProperty("bases")&&e.waves.bases.hasOwnProperty("part")){if(e.waves.bases.part.hasOwnProperty("asteroids")&&e.waves.bases.part.asteroids.hasOwnProperty("chance_types")){var h=e.waves.bases.part.asteroids.chance_types;h.hasOwnProperty("e_val")&&(h=h.e_val);for(var l=0;l<a.length;l++){var u=a[l];h.hasOwnProperty(u)||(h[u]=0)}}if(e.waves.bases.part.hasOwnProperty("enemies")&&e.waves.bases.part.enemies.hasOwnProperty("chance_types")){var p=e.waves.bases.part.enemies.chance_types;p.hasOwnProperty("e_val")&&(p=p.e_val);for(var d=0;d<o.length;d++){var f=o[d];p.hasOwnProperty(f)||(p[f]=0)}}}for(var y in t)if(t[y].hasOwnProperty("units")){var m=t[y].units;for(var v in m){var _=m[v],g="default";if(_.hasOwnProperty("base")&&(g=_.base),e[y].hasOwnProperty("bases")&&e[y].bases.hasOwnProperty(g)){var b=e[y].bases[g];t[y].units[v]=Object.assign({},s(b,_))}var w="part";if(_.hasOwnProperty("parts")){var k=_.parts;for(var O in k)if(w=k[O].base,e[y].hasOwnProperty("bases")&&e[y].bases.hasOwnProperty(w)){var S=e[y].bases[w];t[y].units[v].parts[O]=Math.cloneDeep(s(S,k[O]))}}}e[y].hasOwnProperty("skins")&&(t[y].skins=e[y].skins)}return t}function d(e){return(d="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function f(e,t){for(var s=0;s<t.length;s++){var i=t[s];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function y(e,t){return!t||"object"!==d(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function m(e){return(m=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function v(e,t){return(v=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var _=function(e){function t(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=y(this,m(t).call(this,{key:"PreloadScene"}))).UIsArr=["MenuUI","MissionCompleteUI","IngameUI","MobileJoystick","PauseUI","ScoreUI","ReminderUI","MissionUI"],e}var s,i,n;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&v(e,t)}(t,Phaser.Scene),s=t,(i=[{key:"preload",value:function(){var e=this,t=this.add.graphics();this.load.on("progress",function(s,i){void 0!==i?e.UIsArr.splice(e.UIsArr.indexOf(i),1):s*=.9,t.clear(),t.fillStyle(12051967,1),t.fillRect(e.cameras.main.worldView.left,e.sys.game.config.height/2-5,e.cameras.main.worldView.width*s,10),0===e.UIsArr.length&&setTimeout(function(){t.destroy(),e.createObjectsAnimations(),e.scene.start("GameScene")},0)}),this.load.on("complete",function(){Phaser.GLOBALS.units_waves=e.cache.json.get("units_waves"),e.cache.json.remove("units_waves"),Phaser.GLOBALS.units_waves=p(e.cache.json.get("base_config"),Phaser.GLOBALS.units_waves),Phaser.GLOBALS.load_data();try{Phaser.EDITOR=new Editor(e,function(){e.sleepUIs()})}catch(t){e.sleepUIs()}}),this.load.json("base_config","assets/base_config.json"),this.load.json("units_waves","assets/units_waves.json"),this.load.image("bg_1","assets/img/bg1.png"),this.load.multiatlas("atlas_objects","assets/atlases/atlas_objects.json","assets/atlases"),this.load.bitmapFont("aller_white","assets/fonts/aller_white.png","assets/fonts/aller_white.fnt"),this.load.bitmapFont("aller_dark","assets/fonts/aller_dark.png","assets/fonts/aller_white.fnt"),this.load.bitmapFont("aller_yellow","assets/fonts/aller_yellow.png","assets/fonts/aller_white.fnt"),this.load.bitmapFont("aller_red","assets/fonts/aller_red.png","assets/fonts/aller_white.fnt"),this.load.bitmapFont("aller_orange","assets/fonts/aller_orange.png","assets/fonts/aller_white.fnt"),this.load.bitmapFont("aller_green","assets/fonts/aller_green.png","assets/fonts/aller_white.fnt"),this.load.bitmapFont("aller_white_it","assets/fonts/aller_white_it.png","assets/fonts/aller_white_it.fnt"),this.load.bitmapFont("white","assets/fonts/white.png","assets/fonts/white.fnt"),this.load.bitmapFont("dark","assets/fonts/dark.png","assets/fonts/white.fnt"),this.load.bitmapFont("yellow","assets/fonts/yellow.png","assets/fonts/white.fnt"),this.load.audio("thrust",["assets/snd/thrust2.wav","assets/snd/thrust2.mp3","assets/snd/thrust2.ogg"]),this.load.audio("bang_small",["assets/snd/bang_small.wav","assets/snd/bang_small.mp3","assets/snd/bang_small.ogg"]),this.load.audio("bang_medium",["assets/snd/bang_medium.wav","assets/snd/bang_medium.mp3","assets/snd/bang_medium.ogg"]),this.load.audio("bang_large",["assets/snd/bang_large.wav","assets/snd/bang_large.mp3","assets/snd/bang_large.ogg"]),this.load.audio("fire",["assets/snd/fire.wav","assets/snd/fire.mp3","assets/snd/fire.ogg"]),this.load.audio("lock_gun",["assets/snd/lock_gun.mp3","assets/snd/lock_gun.ogg"]),this.load.audio("extra_ship",["assets/snd/extra_ship.mp3","assets/snd/extra_ship.ogg"]),this.load.audio("saucer_big",["assets/snd/saucer_big_slow.wav","assets/snd/saucer_big_slow.mp3","assets/snd/saucer_big_slow.ogg"]),this.load.audio("saucer_small",["assets/snd/saucer_small_slow.wav","assets/snd/saucer_small_slow.mp3","assets/snd/saucer_small_slow.ogg"]),this.load.audio("close_to_black_hole",["assets/snd/close_to_black_hole.mp3","assets/snd/close_to_black_hole.ogg"]),this.load.audio("killed_by_black_hole",["assets/snd/killed_by_black_hole.mp3","assets/snd/killed_by_black_hole.ogg"]),this.load.audio("game_over",["assets/snd/game_over.mp3","assets/snd/game_over.ogg"]),this.load.audio("mission_fail_out_of_time",["assets/snd/mission_fail_out_of_time.mp3","assets/snd/mission_fail_out_of_time.ogg"]),this.load.audio("mission_success_or_wave_complete",["assets/snd/mission_success_or_wave_complete.mp3","assets/snd/mission_success_or_wave_complete.ogg"]),this.load.audio("new_ship_unlocked",["assets/snd/new_ship_unlocked.mp3","assets/snd/new_ship_unlocked.ogg"]),this.load.audio("player_clicks_any_ui_button",["assets/snd/player_clicks_any_ui_button.mp3","assets/snd/player_clicks_any_ui_button.ogg"]),this.load.audio("extra_life",["assets/snd/extra_life.mp3","assets/snd/extra_life.ogg"]),this.load.audio("player_hits_kitty",["assets/snd/player_hits_kitty.mp3","assets/snd/player_hits_kitty.ogg"]),this.load.audio("player_kills_a_UFO",["assets/snd/player_kills_a_UFO.mp3","assets/snd/player_kills_a_UFO.ogg"]),this.load.audio("player_loses_a_life",["assets/snd/player_loses_a_life.mp3","assets/snd/player_loses_a_life.ogg"]),this.load.audio("press_go_button",["assets/snd/press_go_button.mp3","assets/snd/press_go_button.ogg"]),this.load.audio("tank_bubble_gets_popped",["assets/snd/tank_bubble_gets_popped.mp3","assets/snd/tank_bubble_gets_popped.ogg"]),this.load.audio("reverse_thrust",["assets/snd/reverse_thrust2.wav","assets/snd/reverse_thrust2.mp3","assets/snd/reverse_thrust2.ogg"])}},{key:"create",value:function(){}},{key:"sleepUIs",value:function(){for(var e=this,t=this.UIsArr.slice(),s=function(s){var i=t[s];e.scene.launch(i),e.scene.get(i).events.on("sleep",function(n){n.events.removeListener("sleep"),e.load.emit("progress",.9+(s+1)/t.length*.1,i)})},i=0;i<t.length;i++)s(i)}},{key:"loadCompleted",value:function(){var e=this;Phaser.GLOBALS.units_waves=this.cache.json.get("units_waves"),this.cache.json.remove("units_waves"),Phaser.GLOBALS.units_waves=p(this.cache.json.get("base_config"),Phaser.GLOBALS.units_waves),Phaser.GLOBALS.load_data(),Phaser.EDITOR&&(Phaser.EDITOR=new Editor(this,function(){e.createObjectsAnimations(),e.scene.start("GameScene")}))}},{key:"createObjectsAnimations",value:function(){var e=[],t="";e=this.anims.generateFrameNames("atlas_objects",{start:1,end:1,zeroPad:4,prefix:"ship_1/ship_1",suffix:".png",frames:!0}),this.anims.create({key:"ship_1_idle",frames:e,frameRate:0,repeat:0}),e=this.anims.generateFrameNames("atlas_objects",{start:2,end:3,zeroPad:4,prefix:"ship_1/ship_1",suffix:".png",frames:!0}),this.anims.create({key:"ship_1_engine",frames:e,frameRate:20,repeat:-1,yoyo:!0}),e=this.anims.generateFrameNames("atlas_objects",{start:1,end:1,zeroPad:4,prefix:"ship_yellow_1/ship_yellow_1",suffix:".png",frames:!0}),this.anims.create({key:"ship_yellow_1_idle",frames:e,frameRate:0,repeat:0}),e=this.anims.generateFrameNames("atlas_objects",{start:2,end:3,zeroPad:4,prefix:"ship_yellow_1/ship_yellow_1",suffix:".png",frames:!0}),this.anims.create({key:"ship_yellow_1_engine",frames:e,frameRate:20,repeat:-1,yoyo:!0}),e=this.anims.generateFrameNames("atlas_objects",{start:1,end:1,zeroPad:4,prefix:"ship_2/ship_2",suffix:".png",frames:!0}),this.anims.create({key:"ship_2_idle",frames:e,frameRate:0,repeat:0}),e=this.anims.generateFrameNames("atlas_objects",{start:2,end:3,zeroPad:4,prefix:"ship_2/ship_2",suffix:".png",frames:!0}),this.anims.create({key:"ship_2_engine",frames:e,frameRate:20,repeat:-1,yoyo:!0}),e=this.anims.generateFrameNames("atlas_objects",{start:1,end:1,zeroPad:4,prefix:"ship_3/ship_3",suffix:".png",frames:!0}),this.anims.create({key:"ship_3_idle",frames:e,frameRate:0,repeat:0}),e=this.anims.generateFrameNames("atlas_objects",{start:2,end:3,zeroPad:4,prefix:"ship_3/ship_3",suffix:".png",frames:!0}),this.anims.create({key:"ship_3_engine",frames:e,frameRate:20,repeat:-1,yoyo:!0}),e=this.anims.generateFrameNames("atlas_objects",{start:1,end:1,zeroPad:4,prefix:"ship_4/ship_4",suffix:".png",frames:!0}),this.anims.create({key:"ship_4_idle",frames:e,frameRate:0,repeat:0}),e=this.anims.generateFrameNames("atlas_objects",{start:2,end:3,zeroPad:4,prefix:"ship_4/ship_4",suffix:".png",frames:!0}),this.anims.create({key:"ship_4_engine",frames:e,frameRate:20,repeat:-1,yoyo:!0}),e=this.anims.generateFrameNames("atlas_objects",{start:1,end:1,zeroPad:4,prefix:"ship_5/ship_5",suffix:".png",frames:!0}),this.anims.create({key:"ship_5_idle",frames:e,frameRate:0,repeat:0}),e=this.anims.generateFrameNames("atlas_objects",{start:2,end:3,zeroPad:4,prefix:"ship_5/ship_5",suffix:".png",frames:!0}),this.anims.create({key:"ship_5_engine",frames:e,frameRate:20,repeat:-1,yoyo:!0}),e=this.anims.generateFrameNames("atlas_objects",{start:1,end:1,zeroPad:4,prefix:"ship_6/ship_6",suffix:".png",frames:!0}),this.anims.create({key:"ship_6_idle",frames:e,frameRate:0,repeat:0}),e=this.anims.generateFrameNames("atlas_objects",{start:2,end:3,zeroPad:4,prefix:"ship_6/ship_6",suffix:".png",frames:!0}),this.anims.create({key:"ship_6_engine",frames:e,frameRate:20,repeat:-1,yoyo:!0}),e=this.anims.generateFrameNames("atlas_objects",{start:1,end:1,zeroPad:4,prefix:"ship_7/ship_7",suffix:".png",frames:!0}),this.anims.create({key:"ship_7_idle",frames:e,frameRate:0,repeat:0}),e=this.anims.generateFrameNames("atlas_objects",{start:2,end:3,zeroPad:4,prefix:"ship_7/ship_7",suffix:".png",frames:!0}),this.anims.create({key:"ship_7_engine",frames:e,frameRate:20,repeat:-1,yoyo:!0});for(var s=["light_blue","white","red","green","yellow","blue","blue_destr"],i=0;i<s.length;i++)t=s[i],e=this.anims.generateFrameNames("atlas_objects",{start:1,end:50,zeroPad:4,prefix:t+"/"+t,suffix:".png",frames:!0}),this.anims.create({key:t+"_0",frames:e,frameRate:10,repeat:-1}),e=this.anims.generateFrameNames("atlas_objects",{start:52,end:81,zeroPad:4,prefix:t+"/"+t,suffix:".png",frames:!0}),this.anims.create({key:t+"_1",frames:e,frameRate:12,repeat:-1}),e=this.anims.generateFrameNames("atlas_objects",{start:83,end:112,zeroPad:4,prefix:t+"/"+t,suffix:".png",frames:!0}),this.anims.create({key:t+"_2",frames:e,frameRate:18,repeat:-1});this.anims.create({key:"asteroid_1_0",frames:[{key:"asteroid_1_1"}],frameRate:0,repeat:0}),this.anims.create({key:"asteroid_1_1",frames:[{key:"asteroid_1_2"}],frameRate:0,repeat:0}),this.anims.create({key:"asteroid_1_2",frames:[{key:"asteroid_1_3"}],frameRate:0,repeat:0}),this.anims.create({key:"asteroid_2_0",frames:[{key:"asteroid_2_1"}],frameRate:0,repeat:0}),this.anims.create({key:"asteroid_2_1",frames:[{key:"asteroid_2_2"}],frameRate:0,repeat:0}),this.anims.create({key:"asteroid_2_2",frames:[{key:"asteroid_2_3"}],frameRate:0,repeat:0}),e=this.anims.generateFrameNames("atlas_objects",{start:0,end:19,zeroPad:4,prefix:"ufo_1/ufo_1",suffix:".png",frames:!0}),this.anims.create({key:"ufo_1",frames:e,frameRate:20,repeat:-1,yoyo:!1}),e=this.anims.generateFrameNames("atlas_objects",{start:0,end:19,zeroPad:4,prefix:"ufo_1_pink/ufo_1",suffix:".png",frames:!0}),this.anims.create({key:"ufo_1_pink",frames:e,frameRate:20,repeat:-1,yoyo:!1}),e=this.anims.generateFrameNames("atlas_objects",{start:0,end:19,zeroPad:4,prefix:"ufo_1_purple/ufo_1",suffix:".png",frames:!0}),this.anims.create({key:"ufo_1_purple",frames:e,frameRate:20,repeat:-1,yoyo:!1}),e=this.anims.generateFrameNames("atlas_objects",{start:0,end:19,zeroPad:4,prefix:"ufo_1_green/ufo_1",suffix:".png",frames:!0}),this.anims.create({key:"ufo_1_green",frames:e,frameRate:20,repeat:-1,yoyo:!1}),e=this.anims.generateFrameNames("atlas_objects",{start:0,end:19,zeroPad:4,prefix:"ufo_2/ufo_2",suffix:".png",frames:!0}),this.anims.create({key:"ufo_2",frames:e,frameRate:20,repeat:-1,yoyo:!1}),this.anims.create({key:"drop_bomb",frames:[{key:"atlas_objects",frame:"powerups/drop_bomb.png"}],frameRate:0,repeat:0}),this.anims.create({key:"drop_fast_acceleration",frames:[{key:"atlas_objects",frame:"powerups/drop_fast_acceleration.png"}],frameRate:0,repeat:0}),this.anims.create({key:"drop_fast_shot",frames:[{key:"atlas_objects",frame:"powerups/drop_fast_shot.png"}],frameRate:0,repeat:0}),this.anims.create({key:"drop_freeze",frames:[{key:"atlas_objects",frame:"powerups/drop_freeze.png"}],frameRate:0,repeat:0}),this.anims.create({key:"drop_homing_missle",frames:[{key:"atlas_objects",frame:"powerups/drop_homing_missle.png"}],frameRate:0,repeat:0}),this.anims.create({key:"drop_shield",frames:[{key:"atlas_objects",frame:"powerups/drop_shield.png"}],frameRate:0,repeat:0}),this.anims.create({key:"drop_triple_shot",frames:[{key:"atlas_objects",frame:"powerups/drop_triple_shot.png"}],frameRate:0,repeat:0}),this.anims.create({key:"ui_bomb",frames:[{key:"atlas_objects",frame:"powerups/ui_bomb.png"}],frameRate:0,repeat:0}),this.anims.create({key:"ui_freeze",frames:[{key:"atlas_objects",frame:"powerups/ui_freeze.png"}],frameRate:0,repeat:0}),this.anims.create({key:"ui_homing_missle",frames:[{key:"atlas_objects",frame:"powerups/ui_homing_missle.png"}],frameRate:0,repeat:0}),s=["light_blue","white","red","green","yellow","blue"];for(var n=0;n<s.length;n++)t=s[n]+"_explode_1",e=this.anims.generateFrameNames("atlas_objects",{start:11,end:27,zeroPad:0,prefix:t+"/"+t+"_",suffix:".png",frames:!0}),this.anims.create({key:t,frames:e,frameRate:15,repeat:0}),t=s[n]+"_explode_2",e=this.anims.generateFrameNames("atlas_objects",{start:11,end:27,zeroPad:0,prefix:t+"/"+t+"_",suffix:".png",frames:!0}),this.anims.create({key:t,frames:e,frameRate:15,repeat:0}),t=s[n]+"_explode_3",e=this.anims.generateFrameNames("atlas_objects",{start:11,end:27,zeroPad:0,prefix:t+"/"+t+"_",suffix:".png",frames:!0}),this.anims.create({key:t,frames:e,frameRate:15,repeat:0});t="ship_track",e=this.anims.generateFrameNames("atlas_objects",{start:1,end:10,zeroPad:4,prefix:t+"/"+t,suffix:".png",frames:!0}),this.anims.create({key:t,frames:e,frameRate:20,repeat:0}),t="ship_1_explode",e=this.anims.generateFrameNames("atlas_objects",{start:2,end:20,zeroPad:4,prefix:t+"/"+t,suffix:".png",frames:!0}),this.anims.create({key:t,frames:e,frameRate:25,repeat:0}),t="ufo_1_explode",e=this.anims.generateFrameNames("atlas_objects",{start:1,end:39,zeroPad:4,prefix:t+"/"+t,suffix:".png",frames:!0}),this.anims.create({key:t,frames:e,frameRate:25,repeat:0}),t="ufo_2_explode",e=this.anims.generateFrameNames("atlas_objects",{start:1,end:34,zeroPad:4,prefix:t+"/"+t,suffix:".png",frames:!0}),this.anims.create({key:t,frames:e,frameRate:25,repeat:0}),t="shield_explode",e=this.anims.generateFrameNames("atlas_objects",{start:1,end:21,zeroPad:4,prefix:t+"/"+t,suffix:".png",frames:!0}),this.anims.create({key:t,frames:e,frameRate:25,repeat:0}),t="bullet_explode",e=this.anims.generateFrameNames("atlas_objects",{start:1,end:9,zeroPad:4,prefix:t+"/"+t,suffix:".png",frames:!0}),this.anims.create({key:t,frames:e,frameRate:20,repeat:0})}}])&&f(s.prototype,i),n&&f(s,n),t}();function g(e,t,s){if(e&&"number"!=typeof e){if(e.hasOwnProperty(t))return e[t].hasOwnProperty("e_val")?{key:t,value:e[t].e_val,parentKey:"",parentValue:e}:{key:t,value:e[t],parentKey:"",parentValue:e};if(-1!==t.indexOf(".")){for(var i=t.split("."),n=e,r=s,a="",o="",h=e,l=0,u=i.length;l<u;l++){var c=i[l];if(!n.hasOwnProperty(c)){r=s;break}if(r=n[c],h=n,n=n[c],o=a,"e_val"===c){a=""===a?c:a;break}a=c}return r.hasOwnProperty("e_val")&&(r=r.e_val),{key:a,value:r,parentKey:o,parentValue:h}}return{key:t,value:s,parentKey:"",parentValue:e}}return{key:t,value:s,parentKey:"",parentValue:e}}var b={addEditorEmmiter:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:function(){};Phaser.hasOwnProperty("EDITOR")&&Phaser.EDITOR.emitter.on("changed",function(s,i,n){if(console.log(222,e.category,i,e.type,n),e.category===i&&e.type===n){var r=g(Phaser.GLOBALS,s);e.hasOwnProperty(r.key)?e["set_"+r.key]&&e["set_"+r.key](r.value):e.hasOwnProperty(r.parentKey)&&e["set_"+r.parentKey]&&e["set_"+r.parentKey](r.parentValue),t(r)}},this)}};function w(e){return(w="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function k(e,t){for(var s=0;s<t.length;s++){var i=t[s];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function O(e){return(O=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function S(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function P(e,t){return(P=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var M=function(e){function t(e,s,i,n){var r,a,o;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),a=this,(r=!(o=O(t).call(this,e,s,i,"bullet_3"))||"object"!==w(o)&&"function"!=typeof o?S(a):o).scene=e,r.scene.add.existing(S(r)),r.scene.physics.add.existing(S(r)),r.setOrigin(.5),r.category="bullets",r.type="default",r.units=Phaser.GLOBALS.units_waves[r.category].units,r.config=n||r.units[r.type],r.skin="bullet_4",r.speed=70,r.lifetime=6e3,r.power=1,r.size=1,r.collider={shape:"circle",radius:2,offset_x:-2,offset_y:-2},r.origin={x:.75,y:.5},r.deadTime=0,r.shooter=null,r.soundFire=r.scene.sound.add("fire",{mute:!1,volume:.5,loop:!1}),r.readConfigByType(r.type),r.addEditorEmmiter(),r}var s,i,n;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&P(e,t)}(t,Phaser.Physics.Arcade.Image),s=t,(i=[{key:"fire",value:function(e,t,s){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{type:null,velocity:null,speed:null,lifetime:null,lifetime_mult:null,size_mult:null,skin:"",power:null},n=i.type||this.type;n!==this.type&&(this.type=n,this.readConfigByType(this.type));var r=i.velocity||{x:0,y:0};this.speed=i.speed||this.speed;var a=i.lifetime||this.lifetime,o=i.lifetime_mult||1,h=i.size_mult||1,l=i.hasOwnProperty("skin")?i.skin:"";i.power||this.power,""!==l&&this.skin!==l&&this.set_skin(l),this.scale!==this.size&&this.set_size(),1!==h&&this.setScale(this.size*h),1!==this.depth&&this.setDepth(1),this.setRotation(s);var u=r.x,c=r.y,p=.001*this.scene.game.loop.delta;this.body.reset(e+u*p,t+c*p);var d=this.rotation,f=Math.cos(d)*this.speed+u,y=Math.sin(d)*this.speed+c;this.setVelocity(f,y),this.deadTime=this.scene.time.now+a*o,this.show(),"game"!==this.scene.layoutState||this.scene.isGameOver||this.soundFire.play()}},{key:"show",value:function(){this.setActive(!0),this.setVisible(!0),this.body.setEnable(!0)}},{key:"hide",value:function(){this.shooter&&this.shooter.use_num_shots&&this.shooter.bulletsAlive--,this.setActive(!1),this.setVisible(!1),this.body.setEnable(!1)}},{key:"preUpdate",value:function(e,t){this.active&&e>this.deadTime&&(this.hide(),this.scene.wavesManager.is_limited_ammo&&this.scene.wavesManager.limitedAmmoManager.checkEmptyAmmo()),this.body.world.wrap(this,0)}},{key:"set_skin",value:function(e){return void 0!==e&&""!==e&&(this.skin=e,this.setTexture("atlas_objects",this.skin+".png"),this.set_collider()),this}},{key:"set_collider",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.collider,t=e.shape;if("string"==typeof t)if("circle"===t){var s=e.radius;this.body.setCircle(s,this.displayOriginX-s,this.displayOriginY-s)}else"rectangle"===t&&(this.body.setSize(e.width,e.height),this.body.setOffset(e.offset_x,e.offset_y))}},{key:"set_speed",value:function(e){return this.speed=e,this}},{key:"set_lifetime",value:function(e){return this.lifetime=e,this}},{key:"set_power",value:function(e){return this.power=e,this}},{key:"set_size",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.size;return this.setScale(e),this.size=e,this}},{key:"set_origin",value:function(e){return this.origin=e,this.setOrigin(this.origin.x,this.origin.y),this.set_collider(),this}},{key:"readConfig",value:function(e){this.set_skin(g(e,"skin",this.skin).value),this.set_size(g(e,"size",this.size).value),this.set_speed(g(e,"speed",this.speed).value),this.set_lifetime(g(e,"lifetime",this.lifetime).value),this.set_power(g(e,"power",this.power).value),this.set_origin(g(e,"origin",this.origin).value),this.set_collider(g(e,"collider",this.collider).value)}},{key:"readConfigByType",value:function(e){var t=this.units.hasOwnProperty(e)?this.units[e]:this.config;this.readConfig(t)}}])&&k(s.prototype,i),n&&k(s,n),t}();Object.assign(M.prototype,b);var x=M;function T(e){if(null==e)throw new TypeError("Cannot destructure undefined")}function C(e,t){for(var s=0;s<t.length;s++){var i=t[s];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var E=function(){function e(t,s){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.scene=t,this.gameObject=s,this.paramfortween=0,this.on_time=1500,this.off_time=1500,this.duration=2e4,this.time_remain=this.duration,this.steps=[.45,.8],this.wait=0,this.blink_state=!1,this.type="flash",this.timerWait=null,this.timerFlash=null,this.tween=null,this.endTime=0,this.curStep=0,this.stepsTime=[],this.prevBlinkTime=9999999,this.alphaTime=0,this.prevTimeRemain=0,this.durMult=1}var t,s,i;return t=e,(s=[{key:"start",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{scene:this.scene,game_object:this.gameObject,wait:0,on_time:300,off_time:300,duration:1e3,time_remain:3e3,steps:3,type:"flash"},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){};this.scene=e.hasOwnProperty("scene")?e.scene:this.scene,this.gameObject=e.hasOwnProperty("game_object")?e.game_object:this.gameObject,this.wait=e.hasOwnProperty("wait")?e.wait:0,this.on_time=e.hasOwnProperty("on_time")?e.on_time:300,this.off_time=e.hasOwnProperty("off_time")?e.off_time:300,this.duration=e.hasOwnProperty("duration")?e.duration:3,this.time_remain=e.hasOwnProperty("time_remain")?e.time_remain:this.duration,this.steps=e.hasOwnProperty("steps")?e.steps:this.steps,this.type=e.hasOwnProperty("type")?e.type:this.type,this.stop(),this.runTimerWait(this.wait,t)}},{key:"stop",value:function(){this.timerFlash&&this.timerFlash.remove(),this.timerWait&&this.timerWait.remove(),this.tween&&this.tween.remove(),this.gameObject.setVisible(!0),this.curStep=0,this.blink_state=!1,this.prevBlinkTime=9999999,this.alphaTime=0,this.prevTimeRemain=0,this.durMult=1}},{key:"runTimerWait",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){};this.timerWait=this.scene.time.addEvent({delay:t,callback:function(){e.timerWait.remove(),e.endTime=e.scene.time.now+e.time_remain,e.startTime=e.endTime-e.duration,e.curStep=0;for(var t=0;t<e.steps.length;t++)e.stepsTime[t]=e.startTime+e.steps[t]*e.duration,e.scene.time.now>e.stepsTime[t]&&(e.curStep=t);"flash"===e.type?e.runTimerFlash(0,s):e.runTweenAlpha({},s)},callbackScope:this})}},{key:"runTimerFlash",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){};this.timerFlash=this.scene.time.addEvent({delay:t,callback:function(){if(e.timerFlash.remove(),e.scene.time.now<e.endTime){var t=1;e.steps.length>1&&(e.scene.time.now>e.stepsTime[e.curStep]&&(e.curStep++,e.curStep=Math.min(e.steps.length,e.curStep)),t=Math.lerp(1,.3,Math.unlerp(0,e.steps.length,e.curStep))),e.gameObject.setVisible(e.blink_state),e.blink_state=!e.blink_state;var i=e.blink_state?e.on_time*t:e.off_time*t;e.runTimerFlash(i,s)}else e.gameObject.setVisible(!1),s()},callbackScope:this})}},{key:"runTweenAlpha",value:function(e){var t=this;T(e);var s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){};this.tween=this.scene.tweens.add({targets:this.gameObject,alpha:{from:1,to:.2},duration:this.on_time+this.off_time,ease:"Sine",repeat:-1,yoyo:!0,onComplete:function(e){},onRepeat:function(e){if(t.scene.time.now<t.endTime){var i=1;if(t.steps.length>1&&t.scene.time.now>t.stepsTime[t.curStep]){t.curStep++,t.curStep=Math.min(t.steps.length,t.curStep),i=Math.lerp(1,.2,Math.unlerp(0,t.steps.length,t.curStep));var n=(t.on_time+t.off_time)*i;e.resetTweenData(),e.data[0].duration=n,e.updateTweenData(e,e.data[0],1)}}else t.gameObject.setVisible(!1),t.gameObject.setActive(1),e.remove(),s()},onStart:function(){},onUpdate:function(e,t){}},this)}},{key:"flashFromTimeRemain",value:function(e,t){var s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{on_time:300,off_time:300,steps:[.5,.2]};e<t&&e<=this.prevBlinkTime&&(0===this.curStep?e<s.steps[this.curStep]*t&&(this.curStep=1):1===this.curStep&&e<s.steps[this.curStep]*t&&(this.curStep=2),this.durMult=Math.lerp(1,.3,Math.unlerp(0,s.steps.length,this.curStep)),this.prevBlinkTime=e-s.on_time*this.durMult,this.gameObject.setVisible(this.blink_state),this.blink_state=!this.blink_state)}},{key:"alphaFromTimeRemain",value:function(e,t){var s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{on_time:300,off_time:300,steps:[.5,.2]};if(e<t){e<=this.prevBlinkTime&&(0===this.curStep?e<s.steps[this.curStep]*t&&(this.curStep=1):1===this.curStep&&e<s.steps[this.curStep]*t&&(this.curStep=2),this.durMult=Math.lerp(1,4,Math.unlerp(0,s.steps.length,this.curStep)),this.prevBlinkTime=e-s.on_time*this.durMult);var i=.4*Math.cos(this.alphaTime*this.durMult*.01)+.6;this.gameObject.setAlpha(i),this.alphaTime+=this.prevTimeRemain-e}this.prevTimeRemain=e}},{key:"preUpdate",value:function(e,t){}}])&&C(t.prototype,s),i&&C(t,i),e}();function A(e){return(A="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function j(e,t){for(var s=0;s<t.length;s++){var i=t[s];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function B(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function D(e,t,s){return(D="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,s){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=R(e)););return e}(e,t);if(i){var n=Object.getOwnPropertyDescriptor(i,t);return n.get?n.get.call(s):n.value}})(e,t,s||e)}function R(e){return(R=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function G(e,t){return(G=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var I=function(e){function t(e,s,i){var n,r,a;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),r=this,(n=!(a=R(t).call(this,e,s,i))||"object"!==A(a)&&"function"!=typeof a?B(r):a).scene=e,n.scene.add.existing(B(n)),n.scene.physics.add.existing(B(n)),n.ship=null,n.collider={shape:"circle",radius:22,offset_x:0,offset_y:0},n.type="",n.origin={x:.5,y:.5},n.enable=!1,n.skin="ship_shield";var o=n.scene.anims.generateFrameNames("atlas_objects",{start:1,end:13,zeroPad:4,prefix:"powerups/tanky_shield",suffix:".png",frames:!0});return n.scene.anims.create({key:n.skin,frames:o,frameRate:5,repeat:-1,yoyo:!1}),n.play(n.skin),n.set_origin(),n.set_collider(),n.overlapdAsteroids=null,n.overlapdEnemies=null,n.overlapdEnemyBullets=null,n.overlapdMines=null,n.addOverlapAsteroids(),n.addOverlapEnemies(),n.addOverlapEnemyBullets(),n.addOverlapMines(),n.soundPopped=n.scene.sound.add("tank_bubble_gets_popped",{mute:!1,volume:1,loop:!1}),n}var s,i,n;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&G(e,t)}(t,Phaser.Physics.Arcade.Sprite),s=t,(i=[{key:"start",value:function(){this.ship.overlapShipAsteroids&&(this.ship.overlapShipAsteroids.active=!1),this.ship.overlapShipEnemies&&(this.ship.overlapShipEnemies.active=!1),this.ship.overlapShipEnemyBullets&&(this.ship.overlapShipEnemyBullets.active=!1),this.overlapdAsteroids.active=this.scene.powerupManager.shield.is_bounce,this.show()}},{key:"stop",value:function(){this.ship.overlapShipAsteroids&&!this.ship.immortal&&(this.ship.overlapShipAsteroids.active=!0),this.ship.overlapShipEnemies&&!this.ship.immortal&&(this.ship.overlapShipEnemies.active=!0),this.ship.overlapShipEnemyBullets&&!this.ship.immortal&&(this.ship.overlapShipEnemyBullets.active=!0),this.overlapdAsteroids.active=!1,this.hide()}},{key:"recharge",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.setVisible(e),this.body.setEnable(e)}},{key:"overlapBounce",value:function(e,t){var s=Math.min(120,1.5*e.body.speed),i=new Phaser.Math.Vector2(t.body.x-e.body.x,t.body.y-e.body.y),n=new Phaser.Math.Vector2(t.body.velocity.x,t.body.velocity.y),r=new Phaser.Math.Vector2(e.body.velocity.x,e.body.velocity.y);n.add(i);var a=n.angle();if(t.body.setVelocity(Math.cos(a)*s,Math.sin(a)*s),e.body.mass<t.body.mass){r.add(i.negate());var o=r.angle();e.body.setVelocity(Math.cos(o)*e.body.speed,Math.sin(o)*e.body.speed)}}},{key:"overlapRemoveShield",value:function(e){e.recharge(!1),this.scene.effectsManager.spawnEffect(this.ship.x,this.ship.y,"shield_explode"),e.ship.setOverlapsActive(!1),e.ship.isBlink=!0,setTimeout(function(){e.ship.setOverlapsActive(!0),e.ship.isBlink=!1},1e3),e.soundPopped.play()}},{key:"addOverlapAsteroids",value:function(){var e=this;return this.overlapdAsteroids=this.scene.physics.add.overlap(this,this.scene.asteroidsGroup,function(s,i){var n,r;s instanceof t?(n=s,r=i):(n=i,r=s),n.ship.isBlink||(e.overlapBounce(r,n.ship),r.shooter=n.ship,r.subDestruction(),e.overlapRemoveShield(n))}),this.overlapdAsteroids}},{key:"addOverlapEnemies",value:function(){var e=this;return this.overlapdEnemies=this.scene.physics.add.overlap(this,this.scene.enemiesGroup,function(s,i){var n,r;s instanceof t?(n=s,r=i):(n=i,r=s),n.ship.isBlink||(e.overlapBounce(r,n.ship),r.shooter=n.ship,r.subDestruction(1,"collide"),e.overlapRemoveShield(n))}),this.overlapdEnemies}},{key:"addOverlapEnemyBullets",value:function(){var e=this;return this.overlapdEnemyBullets=this.scene.physics.add.overlap(this,this.scene.enemiesBulletsGroup,function(s,i){var n,r;s instanceof t?(n=s,r=i):(n=i,r=s),n.ship.isBlink||(r.hide(),e.overlapRemoveShield(n))}),this.overlapdEnemyBullets}},{key:"addOverlapMines",value:function(){var e=this;return this.overlapdMines=this.scene.physics.add.overlap(this,this.scene.wavesManager.minesManager.mineGroup,function(s,i){var n,r;s instanceof t?(n=s,r=i):(n=i,r=s),n.ship.isBlink||(r.explode(),e.overlapRemoveShield(n))}),this.overlapdMines}},{key:"show",value:function(){this.is_blink=!1,this.enable=!0,this.setActive(!0),this.setVisible(!0),this.body.setEnable(!0),this.setAlpha(1)}},{key:"hide",value:function(){this.is_blink=!1,this.enable=!1,this.setActive(!1),this.setVisible(!1),this.body.setEnable(!1)}},{key:"preUpdate",value:function(e,s){D(R(t.prototype),"preUpdate",this).call(this,e,s)}},{key:"set_collider",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.collider,t=e.shape;if("string"==typeof t)if("circle"===t){var s=e.radius;this.body.setCircle(s,this.displayOriginX-s,this.displayOriginY-s)}else"rectangle"===t&&(this.body.setSize(e.width,e.height),this.body.setOffset(e.offset_x,e.offset_y))}},{key:"set_origin",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.origin;return this.origin=e,this.setOrigin(this.origin.x,this.origin.y),this}}])&&j(s.prototype,i),n&&j(s,n),t}();function L(e,t){for(var s=0;s<t.length;s++){var i=t[s];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var z=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.scene=t,this.category="powerups",this.type="shield",this.units=Phaser.GLOBALS.units_waves[this.category].units,this.is_bounce=!1,this.lifetime=3e4,this.blinktime=1e4,this.addCount=1,this.spriteGroup=this.scene.add.group({classType:I,maxSize:2,runChildUpdate:!0,active:!1,visible:!1}),this.readConfigByType(this.type),b.addEditorEmmiter.call(this,function(e){})}var t,s,i;return t=e,(s=[{key:"apply",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{add:null,lifetime:null,blinktime:null};if(e){var s=null,i=null===t.add||void 0===t.add?this.addCount:t.add;e.powerups.hasOwnProperty(this.type)||(e.powerups[this.type]={}),e.powerups[this.type].hasOwnProperty("count")||(e.powerups[this.type].count=0),i&&(e.powerups[this.type].count+=i),e.powerups[this.type].hasOwnProperty("go")||(e.powerups[this.type].go=null),null===e.powerups[this.type].go?(s=this.spriteGroup.get(),e.powerups[this.type].go=s,e.add(s)):s=e.powerups[this.type].go,s.type=this.type,s.ship=e,s.start()}}},{key:"reset",value:function(){this.spriteGroup.getChildren().forEach(function(e){e.stop()})}},{key:"enableOverlapShieldAsteroids",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.overlapShieldAsteroids.active=e}},{key:"set_is_bounce",value:function(e){var t=this;return this.is_bounce=e,this.spriteGroup.getChildren().forEach(function(e){e.overlapdAsteroids.active=t.is_bounce}),e}},{key:"readConfig",value:function(e){return this.set_is_bounce(g(e,"is_bounce",this.is_bounce).value),this}},{key:"readConfigByType",value:function(e){var t=this.units.hasOwnProperty(e)?this.units[e]:{};this.readConfig(t)}}])&&L(t.prototype,s),i&&L(t,i),e}();function V(e){return(V="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function U(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),s.push.apply(s,i)}return s}function F(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}function H(e,t){for(var s=0;s<t.length;s++){var i=t[s];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function N(e){return(N=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function W(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function K(e,t){return(K=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Q=function(e){function t(e,s,i,n){var r,a,o;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),a=this,(r=!(o=N(t).call(this,e,s,i))||"object"!==V(o)&&"function"!=typeof o?W(a):o).scene=e,r.scene.add.existing(W(r)),r.scene.physics.world.enable(W(r),0),r.angle=-90,r.category="ships",r.type="ship_classic",r.units=Phaser.GLOBALS.units_waves[r.category].units,r.config=n||r.units[r.type],r.skin="ship_1",r.max_speed=400,r.min_speed=0,r.acceleration=700,r.reverse_acceleration=500,r.slowdown=.99,r.rotate_speed=5,r.rotate_max_speed=5,r.shot_delay=300,r.use_num_shots=!0,r.num_shots=3,r.wait_bullets_die=!0,r.delay_num_shots=500,r.bullet="default",r.is_fuzzy_fire=!0,r.fuzzy_range=.1,r.frames_to_rotate=7,r.frames_rot_speed=3,r.collider={shape:"circle",radius:9,offset_x:-10,offset_y:-9},r.playerID=0,r.skinGO=null,r.gunGO=null,r.bulletOffset=12,r.controls=null,r.isEngineDown=!1,r.isReverseEngineDown=!1,r.isLeftDown=!1,r.isRightDown=!1,r.isFireDown=!1,r.isBombDown=!1,r.isFreezeDown=!1,r.mobileJoystick=null,r.isStickMove=!1,r.stickRot=0,r.helpLeftCompleted=!1,r.helpUpCompleted=!1,r.helpRightCompleted=!1,r.helpShootCompleted=!1,r.helpReverseCompleted=!1,r.enable=!0,r.size=1,r.wrap=!0,r.padding=0,r.lastFired=0,r.lastBackFired=0,r.defaultX=r.scene.game.config.width/2,r.defaultY=r.scene.game.config.height/2,r.isBlink=!1,r.curAnimation="idle",r.curAngVel=0,r.bulletsAlive=0,r.bulletsShot=0,r.numShotsTrigger=!1,r.lastNumShotsDelay=0,r.delayBeforeResurrect=1500,r.trackEffectNextTime=0,r.gravity_={x:0,y:0},r.gravityAccum={x:0,y:0},r.powerups={},r.is_powerups_remain=!1,r.is_shield=!1,r.is_double_shot=!1,r.doubleShotDist=20,r.doubleShotRot=0,r.is_triple_shot=!1,r.tripleShotRot=Phaser.Math.DegToRad(15),r.is_quadruple_shot=!1,r.is_back_shot=!1,r.thrusters_lvl=0,r.thrustersMult=1,r.reverse_thrusters_lvl=0,r.reverseThrustersMult=1,r.brakes_lvl=0,r.brakesMult=1,r.fire_rate_lvl=0,r.fireRateMult=1,r.shot_distance_lvl=0,r.shotDistanceMult=1,r.bullet_size_lvl=0,r.bulletSizeMult=1,r.is_reverse_thrusters=!1,r.is_fast_acceleration=!1,r.fastAccelerationMult=3,r.fastAccelerationRotationMult=1.2,r.fastAccelerationSlowdown=.9,r.is_fast_shot=!1,r.fastShotDelayMult=.7,r.is_blast_radius=!1,r.astronautPicked=null,r.astronautIsPull=!1,r.astronautFull=!1,r.astronautGO=null,r.immortal=!1,r.overlapShipAsteroids=null,r.overlapShipEnemies=null,r.overlapShipEnemyBullets=null,r.overlapShipShipBullets=null,r.addOverlapShipAsteroids(),r.addOverlapShipEnemies(),r.addOverlapShipEnemyBullets(),r.addOverlapShipShipBullets(),r.timerHide=null,r.timerBlink=null,r.timerShipExplode=null,r.soundThrust=r.scene.sound.add("thrust",{mute:!1,volume:1,loop:!0}),r.soundReverseThrust=r.scene.sound.add("reverse_thrust",{mute:!1,volume:1,loop:!0}),r.soundBangMedium=r.scene.sound.add("bang_medium"),r.soundLockGun=r.scene.sound.add("lock_gun",{mute:!1,volume:1,loop:!1}),r.isSoundLockGunPlayed=!1,r.soundPlayerKillsUFO=r.scene.sound.add("player_kills_a_UFO",{mute:!1,volume:1,loop:!1}),r.soundPlayerLosesLife=r.scene.sound.add("player_loses_a_life",{mute:!1,volume:1,loop:!1}),r.readConfigByType(r.type),r.resetShip(),r.resetPosition(),r.body.maxAngular=350;var h=Math.round(Math.PI*Math.pow(r.body.halfWidth,2));return r.body.setMass(h),b.addEditorEmmiter.call(W(r),function(e){}),Phaser.hasOwnProperty("EDITOR")&&r.setImmortal(Phaser.EDITOR.immortal),r}var s,i,n;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&K(e,t)}(t,Phaser.GameObjects.Container),s=t,(i=[{key:"fireBullet",value:function(e){var t=this;if(arguments.length>1&&void 0!==arguments[1]&&arguments[1],!(this.shot_delay<0)&&e>this.lastFired){if(this.is_back_shot)return;if(this.scene.wavesManager.is_timed_survival)return this.isSoundLockGunPlayed||this.soundLockGun.play(),void(this.isSoundLockGunPlayed=!0);var s=this.shot_delay*this.fireRateMult;if(this.lastFired=e+s,this.scene.wavesManager.is_limited_ammo){if(this.scene.wavesManager.limitedAmmoManager.isStartDelay)return;if(0===this.scene.wavesManager.limited_ammo_curCount)return;this.scene.wavesManager.limited_ammo_curCount--,this.scene.wavesManager.limited_ammo_curCount=Math.max(0,this.scene.wavesManager.limited_ammo_curCount),this.scene.wavesManager.updateTaskText()}if(this.use_num_shots&&(this.wait_bullets_die?(this.bulletsAlive<=0&&(this.bulletsAlive=0,this.bulletsShot=0,this.numShotsTrigger=!0),this.numShotsTrigger&&this.bulletsAlive>=this.num_shots&&(this.numShotsTrigger=!1)):(e>this.lastNumShotsDelay&&(this.bulletsAlive=0,this.numShotsTrigger=!0),this.numShotsTrigger&&this.bulletsShot>=this.num_shots&&(this.bulletsShot=0,this.lastNumShotsDelay=e+this.delay_num_shots,this.numShotsTrigger=!1)),!this.numShotsTrigger))return;var i,n,r,a=function(){return t.is_blast_radius?t.scene.powerupManager.blastRadius.bulletGroup.getFirstDead(!0):t.scene.playerBulletsGroup.getFirstDead(!0)},o=null;if(this.is_double_shot)for(var h=0;h<2;h++)(o=a())&&(o.shooter=this,r=this.rotation+this.doubleShotRot*(0===h?1:-1),i=this.x+Math.cos(r)*this.bulletOffset,n=this.y+Math.sin(r)*this.bulletOffset,o.fire(i,n,this.rotation,{type:this.bullet,velocity:this.body.velocity,lifetime_mult:this.shotDistanceMult,size_mult:this.bulletSizeMult}));else if(o=a()){o.shooter=this,this.bulletsAlive++,this.bulletsShot++,r=this.rotation;var l=this.rotation;this.is_fuzzy_fire&&(l=this.rotation+Phaser.Math.RND.sign()*Phaser.Math.FloatBetween(0,this.fuzzy_range)),i=this.x+Math.cos(l)*this.bulletOffset,n=this.y+Math.sin(l)*this.bulletOffset,o.fire(i,n,r,{type:this.bullet,velocity:this.body.velocity,lifetime_mult:this.shotDistanceMult,size_mult:this.bulletSizeMult})}if(this.is_triple_shot||this.is_quadruple_shot)for(var u=0;u<2;u++)(o=a())&&(o.shooter=this,r=this.rotation+this.tripleShotRot*(0===u?1:-1),i=this.x+Math.cos(r)*this.bulletOffset,n=this.y+Math.sin(r)*this.bulletOffset,o.fire(i,n,r,{type:this.bullet,velocity:this.body.velocity,lifetime_mult:this.shotDistanceMult,size_mult:this.bulletSizeMult}));this.is_quadruple_shot&&(o=a())&&(o.shooter=this,r=this.rotation+Math.PI,i=this.x+Math.cos(r)*this.bulletOffset,n=this.y+Math.sin(r)*this.bulletOffset,o.fire(i,n,r,{type:this.bullet,velocity:this.body.velocity,lifetime_mult:this.shotDistanceMult,size_mult:this.bulletSizeMult}))}}},{key:"fireBackBullet",value:function(e){var t=this;if(arguments.length>1&&void 0!==arguments[1]&&arguments[1],e>this.lastBackFired){if(this.scene.wavesManager.is_timed_survival)return void(this.isSoundLockGunPlayed=!0);var s=this.shot_delay*this.fireRateMult;if(this.lastBackFired=e+s,this.use_num_shots&&(this.wait_bullets_die?(this.bulletsAlive<=0&&(this.bulletsAlive=0,this.bulletsShot=0,this.numShotsTrigger=!0),this.numShotsTrigger&&this.bulletsAlive>=this.num_shots&&(this.numShotsTrigger=!1)):(e>this.lastNumShotsDelay&&(this.bulletsAlive=0,this.numShotsTrigger=!0),this.numShotsTrigger&&this.bulletsShot>=this.num_shots&&(this.bulletsShot=0,this.lastNumShotsDelay=e+this.delay_num_shots,this.numShotsTrigger=!1)),!this.numShotsTrigger))return;var i,n,r,a=function(){return t.is_blast_radius?t.scene.powerupManager.blastRadius.bulletGroup.getFirstDead(!0):t.scene.playerBulletsGroup.getFirstDead(!0)},o=null;(o=a())&&(o.shooter=this,this.bulletsAlive++,this.bulletsShot++,r=this.rotation+Math.PI,i=this.x+Math.cos(r)*this.bulletOffset,n=this.y+Math.sin(r)*this.bulletOffset,o.fire(i,n,r,{type:this.bullet,velocity:this.body.velocity,lifetime_mult:this.shotDistanceMult,size_mult:this.bulletSizeMult}))}}},{key:"applyPowerups",value:function(){for(var e in this.powerups){var t=this.powerups[e].hasOwnProperty("lvl")?this.powerups[e].lvl:0;this.scene.powerupManager.applyPowerup(e,{ship:this,add:0,lvl:t})}}},{key:"runPowerup",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"bomb";if(this.powerups.hasOwnProperty(e)){switch(e){case"bomb":this.powerups[e].hasOwnProperty("count")&&this.powerups[e].count>0&&(this.powerups[e].count--,this.scene.powerupManager.bomb.run(this.x,this.y,this));break;case"freeze":this.powerups[e].hasOwnProperty("count")&&this.powerups[e].count>0&&(this.powerups[e].count--,this.scene.powerupManager.freeze.run(this.x,this.y,this))}this.scene.powerupManager.setPowerupCount(e,this.powerups[e].count,this)}}},{key:"setDoubleShot",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.scene.powerupManager.doubleShot.double_shot_dist;if(this.is_double_shot=e,this.doubleShotDist=t,this.doubleShotRot=Math.asin(Math.min(this.doubleShotDist/2,this.bulletOffset)/Math.max(1,this.bulletOffset)),this.is_double_shot){var s=this.powerups.double_shot.go;s.play(s.skin),this.gunGO&&this.gunGO.setVisible(!1),this.is_blast_radius&&this.powerups.double_shot&&this.powerups.double_shot.go&&(this.powerups.double_shot.go.play("blast_radius"),this.powerups.blast_radius.go.setVisible(!1)),this.scene.powerupManager.setPowerupCount("triple_shot",-1,this),this.scene.powerupManager.setPowerupCount("quadruple_shot",-1,this)}}},{key:"setTripleShot",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.scene.powerupManager.tripleShot.triple_shot_angle;if(this.is_triple_shot=e,this.tripleShotRot=Phaser.Math.DegToRad(t),this.is_triple_shot){var s=this.powerups.triple_shot.go;s.play(s.skin),this.gunGO&&this.gunGO.setVisible(!0),this.is_blast_radius&&this.powerups.triple_shot&&this.powerups.triple_shot.go&&(this.powerups.triple_shot.go.play("blast_radius"),this.powerups.blast_radius.go.setVisible(!0)),this.scene.powerupManager.setPowerupCount("double_shot",-1,this),this.scene.powerupManager.setPowerupCount("quadruple_shot",-1,this)}}},{key:"setQuadrupleShot",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(this.is_quadruple_shot=e,this.is_triple_shot=this.is_quadruple_shot,this.is_quadruple_shot){var t=this.powerups.quadruple_shot.go;t.play(t.skin);var s=this.powerups.quadruple_shot.go2;s.play(s.skin2),this.is_blast_radius&&this.powerups.quadruple_shot&&(this.powerups.quadruple_shot.go&&this.powerups.quadruple_shot.go.play("blast_radius"),this.powerups.quadruple_shot.go2&&this.powerups.quadruple_shot.go2.play("blast_radius2")),this.scene.powerupManager.setPowerupCount("double_shot",-1,this),this.scene.powerupManager.setPowerupCount("triple_shot",-1,this)}}},{key:"setBackShot",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(this.is_back_shot=e,this.is_back_shot){var t=this.powerups.back_shot.go;t.play(t.skin),this.is_blast_radius&&this.powerups.back_shot&&this.powerups.back_shot.go&&this.powerups.back_shot.go.play("blast_radius"),this.scene.powerupManager.setPowerupCount("double_shot",-1,this),this.scene.powerupManager.setPowerupCount("triple_shot",-1,this),this.scene.powerupManager.setPowerupCount("quadruple_shot",-1,this)}}},{key:"setBlastRadius",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:500;this.is_blast_radius=e,this.is_blast_radius?(this.set_shot_delay(t),this.gunGO&&this.gunGO.setVisible(!1)):(this.set_shot_delay(g(this.config,"shot_delay",this.shot_delay).value),this.gunGO&&this.gunGO.setVisible(!0)),this.is_double_shot?this.setDoubleShot(!0):this.is_triple_shot?this.is_quadruple_shot?this.setQuadrupleShot(!0):this.setTripleShot(!0):this.is_back_shot&&this.setBackShot(!0)}},{key:"setThrusters",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.thrusters_lvl;this.thrusters_lvl=e,this.thrustersMult=1+this.scene.powerupManager.thrusters.acceleration_percent/100*this.thrusters_lvl}},{key:"setReverseThrusters",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.reverse_thrusters_lvl;this.reverse_thrusters_lvl=e,this.is_reverse_thrusters=0!==this.reverse_thrusters_lvl,this.reverse_acceleration=this.scene.powerupManager.reverseThrusters.acceleration,this.reverseThrustersMult=1+this.scene.powerupManager.reverseThrusters.acceleration_percent/100*this.reverse_thrusters_lvl}},{key:"setBrakes",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.brakes_lvl;this.brakes_lvl=e,this.brakesMult=1/(1+this.scene.powerupManager.brakes.slowdown_percent/100*this.brakes_lvl);var t=g(this.config,"slowdown",this.slowdown).value;this.set_slowdown(t*this.brakesMult)}},{key:"setFireRate",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.fire_rate_lvl;this.fire_rate_lvl=e,this.fireRateMult=1/(1+this.scene.powerupManager.fireRate.shot_delay_percent/100*this.fire_rate_lvl)}},{key:"setShotDistance",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.shot_distance_lvl;this.shot_distance_lvl=e,this.shotDistanceMult=1+this.scene.powerupManager.shotDistance.shot_delay_percent/100*this.shot_distance_lvl}},{key:"setBulletSize",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.bullet_size_lvl;this.bullet_size_lvl=e,this.bulletSizeMult=1+this.scene.powerupManager.bulletSize.size_percent/100*this.bullet_size_lvl}},{key:"setFastAccelerate",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:3,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1.2,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.9;this.is_fast_acceleration=e,this.is_fast_acceleration?(this.fastAccelerationMult=t,this.fastAccelerationRotationMult=s,this.fastAccelerationSlowdown=i,this.set_slowdown(this.fastAccelerationSlowdown)):this.set_slowdown(g(this.config,"slowdown",this.slowdown).value)}},{key:"setFastShot",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.7;this.is_fast_shot=e,this.fastShotDelayMult=t}},{key:"setImmortal",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.immortal=e,this.overlapShipAsteroids&&(this.overlapShipAsteroids.active=!!this.overlapShipAsteroids.active&&!this.immortal),this.overlapShipEnemies&&(this.overlapShipEnemies.active=!!this.overlapShipEnemies.active&&!this.immortal),this.overlapShipEnemyBullets&&(this.overlapShipEnemyBullets.active=!!this.overlapShipEnemyBullets.active&&!this.immortal),this.overlapShipShipBullets&&(this.overlapShipShipBullets.active=!!this.overlapShipShipBullets.active&&!this.immortal)}},{key:"setOverlapsActive",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.overlapShipAsteroids&&(this.overlapShipAsteroids.active=e),this.overlapShipEnemies&&(this.overlapShipEnemies.active=e),this.overlapShipEnemyBullets&&(this.overlapShipEnemyBullets.active=e),this.overlapShipShipBullets&&(this.overlapShipShipBullets.active=e)}},{key:"firstInvulnerability",value:function(){var e=this;this.isBlink||this.isFirstInvulnerability||(this.isBlink=!0,this.isFirstInvulnerability=!0,this.timeoutFirstInvulnerability=setTimeout(function(){e.isFirstInvulnerability=!1,e.isBlink=!1},3e3))}},{key:"resetPosition",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.defaultX,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.defaultY;this.body.reset(e,t),this.body.setVelocity(0,0),this.show()}},{key:"resetShip",value:function(){this.angle=-90,this.skin="ship_1",this.curAnimation="idle",this.skinGO.play(this.skin+"_"+this.curAnimation),this.gunGO&&this.gunGO.setVisible(!0),this.isBackyBlasterDisabledTrigger=0,this.isFirstInvulnerability=!1,this.timeoutFirstInvulnerability&&clearTimeout(this.timeoutFirstInvulnerability),this.resetMoveKeys()}},{key:"resetMoveKeys",value:function(){this.isEngineDown=!1,this.isReverseEngineDown=!1,this.isLeftDown=!1,this.isRightDown=!1,this.isFireDown=!1,this.isBombDown=!1,this.isFreezeDown=!1,this.isStickMove=!1,this.isSoundLockGunPlayed=!1}},{key:"rechargeShield",value:function(){this.powerups.hasOwnProperty("shield")&&this.powerups.shield.hasOwnProperty("go")&&this.powerups.shield.go.recharge(!0)}},{key:"destroyAllBulletsOnUfoAttack",value:function(){var e=this;this.scene.enemiesBulletsGroup.getChildren().forEach(function(e){e.active&&e.hide()}),this.scene.enemiesGroup.getChildren().forEach(function(t){t.active&&t.timerShotDelay&&(t.timerShotDelay.remove(),t.timerUfoAttackWait=e.scene.time.addEvent({delay:1e3+1e3*t.timerShotDelay.getProgress(),callback:function(){t.timerUfoAttackWait.remove(),t.active&&t.runTimerShotDelay()},callbackScope:e}))})}},{key:"setEnable",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.enable=e}},{key:"show",value:function(){this.timerHide&&this.timerHide.remove(),this.setActive(!0),this.setVisible(!0),this.body.setEnable(!0),this.setAlpha(1),this.setEnable(!0)}},{key:"hide",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.timerHide&&this.timerHide.remove(),t?(this.setActive(!1),this.setVisible(!1)):this.timerHide=this.scene.tweens.add({targets:this,alpha:0,duration:3500,ease:"Power0",onComplete:function(){e.timerHide.remove(),e.setActive(!1),e.setVisible(!1)}},this),this.curAnimation="idle",this.skinGO.play(this.skin+"_"+this.curAnimation),this.soundThrust.stop(),this.soundReverseThrust.stop(),this.body.setEnable(!1),this.setEnable(!1)}},{key:"setOverlap",value:function(e){e?(this.is_overlap=!0,this.addOverlapShipAsteroids()):(this.is_overlap=!1,this.removeOverlapShipAsteroids())}},{key:"addOverlapShipAsteroids",value:function(){return this.overlapShipAsteroids=this.scene.physics.add.overlap(this,this.scene.asteroidsGroup,function(e,s){var i,n;e instanceof t?(i=e,n=s):(i=s,n=e),i.isBlink||(i.shipDie(),n.shooter=i,n.subDestruction(),i.soundPlayerLosesLife.play())}),this.overlapShipAsteroids}},{key:"addOverlapShipEnemies",value:function(){return this.overlapShipEnemies=this.scene.physics.add.overlap(this,this.scene.enemiesGroup,function(e,s){var i,n;e instanceof t?(i=e,n=s):(i=s,n=e),i.isBlink||(i.shipDie(),n.subDestruction(1,"collide"),i.soundPlayerLosesLife.play())}),this.overlapShipEnemies}},{key:"addOverlapShipEnemyBullets",value:function(){var e=this;return this.overlapShipEnemyBullets=this.scene.physics.add.overlap(this,this.scene.enemiesBulletsGroup,function(s,i){var n,r;s instanceof t?(n=s,r=i):(n=i,r=s),n.isBlink||e.scene.isMissionCompleted||(r.hide(),n.shipDie(),n.soundPlayerLosesLife.play())}),this.overlapShipEnemyBullets}},{key:"addOverlapShipShipBullets",value:function(){if(1!==this.scene.players)return this.overlapShipShipBullets=this.scene.physics.add.overlap(this,this.scene.playerBulletsGroup,function(e,s){var i,n;e instanceof t?(i=e,n=s):(i=s,n=e),n.shooter!==i&&(i.isBlink||(n.hide(),i.shipDie(),i.soundPlayerLosesLife.play()))}),this.overlapShipShipBullets}},{key:"blink",value:function(){this.runTimerBlink()}},{key:"explode",value:function(){this.hide(!0),this.scene.effectsManager.spawnEffect(this.x,this.y,"ship_1_explode",{rotation:this.rotation}),this.soundBangMedium.play(),this.scene.cameras.main.shake(100,.01)}},{key:"shipDie",value:function(e){var t=this;(e=function(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?U(s,!0).forEach(function(t){F(e,t,s[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):U(s).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))})}return e}({},{explode:!0,explode_zero_lives:!0},{},e)).explode&&this.explode(),this.scene.curLives--,this.scene.curLives=Math.max(0,this.scene.curLives),this.scene.ui.set_lives(this.scene.curLives),this.scene.lostLives++,this.scene.curLives>0?(e.explode?this.timerShipExplode=this.scene.time.addEvent({delay:this.delayBeforeResurrect,callback:function(){t.timerShipExplode.remove(),t.resetPosition(),t.rechargeShield(),t.blink(),t.scene.wavesManager.is_ufo_attack&&t.destroyAllBulletsOnUfoAttack()},callbackScope:this}):this.blink(),this.scene.effectsManager.spawnLivesLeft(this.defaultX,this.defaultY-70,1===this.scene.curLives?"1 LIFE LEFT!":this.scene.curLives+" LIVES LEFT!",0,22)):(this.timerBlink&&this.timerBlink.remove(),e.explode_zero_lives&&this.explode(),this.scene.gameOver())}},{key:"blasterDisabledTrigger",value:function(){var e=this;this.isBlasterDisabledTriggered||(this.isBlasterDisabledTriggered=!0,this.timerBlasterDisabledTrigger=this.scene.time.addEvent({delay:2e3,callback:function(){e.timerBlasterDisabledTrigger.remove(),e.isBlasterDisabledTriggered=!1},callbackScope:this}),this.isBackyBlasterDisabledTrigger||"ship_drilly"===this.type||this.scene.effectsManager.spawnBlasterDisabled(this.x,this.y-60),"ship_backy"!==this.type||this.isBackyBlasterDisabledTrigger||(this.isBackyBlasterDisabledTrigger=1))}},{key:"preUpdate",value:function(e,t){var s=.001*t,i=this.body;if(!this.enable)return this.body.setAcceleration(0),this.body.setAngularVelocity(0),this;var n=this.mobileJoystick&&this.mobileJoystick.isFireDown||this.isFireDown,r=this.mobileJoystick&&this.mobileJoystick.isEngineDown||this.isEngineDown,a=this.mobileJoystick&&this.mobileJoystick.isReverseEngineDown||this.isReverseEngineDown,o=this.mobileJoystick&&this.mobileJoystick.isBombDown||this.isBombDown,h=this.mobileJoystick&&this.mobileJoystick.isFreezeDown||this.isFreezeDown,l=(!this.mobileJoystick||!this.mobileJoystick.isStickMove)&&this.isLeftDown,u=(!this.mobileJoystick||!this.mobileJoystick.isStickMove)&&this.isRightDown;if(r||a){if(r){var c=this.acceleration*this.thrustersMult;if(this.scene.physics.velocityFromRotation(this.rotation,c,this.body.acceleration),"engine"!==this.curAnimation&&(this.curAnimation="engine",this.skinGO.play(this.skin+"_"+this.curAnimation)),this.soundThrust.isPlaying||(this.soundThrust.play(),this.soundThrust.volume=1),e>this.trackEffectNextTime){this.trackEffectNextTime=e+60;var p=this.rotation+Phaser.Math.FloatBetween(-.2,.2),d=this.x-15*Math.cos(p),f=this.y-15*Math.sin(p);this.scene.effectsManager.spawnTrack(d,f,this.rotation,this.body.velocity,1)}this.is_back_shot&&(this.fireBackBullet(e),this.scene.wavesManager.is_timed_survival&&this.blasterDisabledTrigger())}else if(this.is_reverse_thrusters&&(this.scene.physics.velocityFromRotation(this.rotation+Math.PI,this.reverse_acceleration*this.reverseThrustersMult,this.body.acceleration),"idle"!==this.curAnimation&&(this.curAnimation="idle",this.skinGO.play(this.skin+"_"+this.curAnimation)),this.soundReverseThrust.isPlaying||(this.soundReverseThrust.play(),this.soundReverseThrust.volume=1),e>this.trackEffectNextTime)){this.trackEffectNextTime=e+60;for(var y=0;y<2;y++){var m=this.rotation+1*(0===y?1:-1)+Phaser.Math.FloatBetween(-.2,.2),v=this.x+14*Math.cos(m),_=this.y+14*Math.sin(m);this.scene.effectsManager.spawnTrack(v,_,this.rotation+Math.PI,this.body.velocity,.8)}}}else i.setAcceleration(0),this.scene.wavesManager.is_black_hole?i.setVelocity(i.velocity.x*this.slowdown+this.gravity_.x*s,i.velocity.y*this.slowdown+this.gravity_.y*s):(i.setVelocity(i.velocity.x*this.slowdown,i.velocity.y*this.slowdown),i.speed<1&&i.setVelocity(0,0)),"idle"!==this.curAnimation&&(this.curAnimation="idle",this.skinGO.play(this.skin+"_"+this.curAnimation)),this.soundThrust.isPlaying&&(this.soundThrust.isFading||this.scene.soundFadeTo(this.soundThrust,0,100)),this.soundReverseThrust.isPlaying&&this.soundReverseThrust.stop(),this.is_back_shot&&(this.isSoundLockGunPlayed=!1);this.rot=this.rotate_speed*s,l?(this.frames_to_rotate>0&&(this.curAngVel++,this.curAngVel<this.frames_to_rotate*this.thrustersMult&&(this.rot=this.frames_rot_speed*s)),this.rot=this.rot*(this.is_fast_acceleration?this.fastAccelerationRotationMult:1),Math.rotateToAngle(this,this.rot,this.rotation-this.rot)):u?(this.curAngVel++,this.frames_to_rotate>0&&(this.curAngVel++,this.curAngVel<this.frames_to_rotate*this.thrustersMult&&(this.rot=this.frames_rot_speed*s)),this.rot=this.rot*(this.is_fast_acceleration?this.fastAccelerationRotationMult:1),Math.rotateToAngle(this,this.rot,this.rotation+this.rot)):(this.curAngVel=0,i.setAngularVelocity(0),i.setAngularAcceleration(0)),this.mobileJoystick&&this.mobileJoystick.isStickMove&&(this.rot=this.rot*(this.is_fast_acceleration?this.fastAccelerationRotationMult:1),this.rot*=1,Math.rotateToAngle(this,1*this.rot,this.mobileJoystick.stickRot)),n?(this.fireBullet(e),this.scene.wavesManager.is_timed_survival&&this.blasterDisabledTrigger()):(this.use_num_shots&&(this.wait_bullets_die||(this.bulletsShot=0,this.numShotsTrigger=!0)),this.is_back_shot||(this.isSoundLockGunPlayed=!1)),o&&(this.mobileJoystick&&(this.mobileJoystick.isBombDown=!1),this.isBombDown=!1,this.runPowerup("bomb")),h&&(this.mobileJoystick&&(this.mobileJoystick.isFreezeDown=!1),this.isFreezeDown=!1,this.runPowerup("freeze")),i.world.wrap(this,this.padding)}},{key:"runTimerBlink",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:100;this.timerBlink&&this.timerBlink.remove(),this.setVisible(!1),this.isBlink=!0;var s=this.scene.wavesManager.is_ufo_attack?40:20;this.timerBlink=this.scene.time.addEvent({delay:t,repeat:s,callback:function(){e.setVisible(!e.visible),0===e.timerBlink.getRepeatCount()&&(e.setVisible(!0),e.isBlink=!1)},callbackScope:this})}},{key:"set_id",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;this.playerID=e,1==this.playerID&&this.skinGO.setTint("0xffff00"),this.setControlKeys()}},{key:"setControlKeys",value:function(e){var t=this;return this.eventKeydown&&this.eventKeydown.removeAllListeners(),this.eventKeyup&&this.eventKeyup.removeAllListeners(),this.controls=e,0===this.playerID?(1===this.scene.players?(this.eventKeydown=this.scene.input.keyboard.on("keydown",function(e){Phaser.EDITOR||e.preventDefault(),e.keyCode===Phaser.Input.Keyboard.KeyCodes.LEFT?(t.isLeftDown=!0,t.helpLeftCompleted=!0):e.keyCode===Phaser.Input.Keyboard.KeyCodes.RIGHT&&(t.isRightDown=!0,t.helpRightCompleted=!0),e.keyCode===Phaser.Input.Keyboard.KeyCodes.UP?(t.isEngineDown=!0,t.helpUpCompleted=!0):e.keyCode===Phaser.Input.Keyboard.KeyCodes.DOWN&&(t.isReverseEngineDown=!0,t.helpReverseCompleted=!0),e.keyCode!==Phaser.Input.Keyboard.KeyCodes.SPACE||t.scene.keyPressed.has(e.keyCode)||(t.scene.keyPressed.add(e.keyCode),t.isFireDown=!0,t.helpShootCompleted=!0),(e.keyCode===Phaser.Input.Keyboard.KeyCodes.E||"Control"===e.key&&1===e.location)&&(t.scene.keyPressed.has(e.keyCode)||(t.scene.keyPressed.add(e.keyCode),t.isBombDown=!0,t.isFreezeDown=!0)),t.checkHelpCompleted()}),this.eventKeyup=this.scene.input.keyboard.on("keyup",function(e){t.scene.keyPressed.delete(e.keyCode),e.keyCode===Phaser.Input.Keyboard.KeyCodes.LEFT?t.isLeftDown=!1:e.keyCode===Phaser.Input.Keyboard.KeyCodes.RIGHT&&(t.isRightDown=!1),e.keyCode===Phaser.Input.Keyboard.KeyCodes.UP?t.isEngineDown=!1:e.keyCode===Phaser.Input.Keyboard.KeyCodes.DOWN&&(t.isReverseEngineDown=!1),e.keyCode===Phaser.Input.Keyboard.KeyCodes.SPACE&&(t.isFireDown=!1),(e.keyCode===Phaser.Input.Keyboard.KeyCodes.E||"Control"===e.key&&1===e.location)&&(t.isBombDown=!1,t.isFreezeDown=!1)})):(this.eventKeydown=this.scene.input.keyboard.on("keydown",function(e){Phaser.EDITOR||e.preventDefault(),e.keyCode===Phaser.Input.Keyboard.KeyCodes.A?t.isLeftDown=!0:e.keyCode===Phaser.Input.Keyboard.KeyCodes.D&&(t.isRightDown=!0),e.keyCode===Phaser.Input.Keyboard.KeyCodes.W?t.isEngineDown=!0:e.keyCode===Phaser.Input.Keyboard.KeyCodes.S&&(t.isReverseEngineDown=!0),"Space"===e.code&&(t.isFireDown=!0)}),this.eventKeyup=this.scene.input.keyboard.on("keyup",function(e){e.keyCode===Phaser.Input.Keyboard.KeyCodes.A?t.isLeftDown=!1:e.keyCode===Phaser.Input.Keyboard.KeyCodes.D&&(t.isRightDown=!1),e.keyCode===Phaser.Input.Keyboard.KeyCodes.W?t.isEngineDown=!1:e.keyCode===Phaser.Input.Keyboard.KeyCodes.S&&(t.isReverseEngineDown=!1),"Space"===e.code&&(t.isFireDown=!1)})),this.mobileJoystick=this.scene.scene.get("MobileJoystick")):(this.eventKeydown=this.scene.input.keyboard.on("keydown",function(e){Phaser.EDITOR||e.preventDefault(),e.keyCode===Phaser.Input.Keyboard.KeyCodes.LEFT?t.isLeftDown=!0:e.keyCode===Phaser.Input.Keyboard.KeyCodes.RIGHT&&(t.isRightDown=!0),e.keyCode===Phaser.Input.Keyboard.KeyCodes.UP?t.isEngineDown=!0:e.keyCode===Phaser.Input.Keyboard.KeyCodes.DOWN&&(t.isReverseEngineDown=!0),e.ctrlKey&&2===e.location&&(t.isFireDown=!0)}),this.eventKeyup=this.scene.input.keyboard.on("keyup",function(e){e.keyCode===Phaser.Input.Keyboard.KeyCodes.LEFT?t.isLeftDown=!1:e.keyCode===Phaser.Input.Keyboard.KeyCodes.RIGHT&&(t.isRightDown=!1),e.keyCode===Phaser.Input.Keyboard.KeyCodes.UP?t.isEngineDown=!1:e.keyCode===Phaser.Input.Keyboard.KeyCodes.DOWN&&(t.isReverseEngineDown=!1),"Control"===e.key&&2===e.location&&(t.isFireDown=!1)})),this}},{key:"checkHelpCompleted",value:function(){this.scene.ui.isHelpNeed&&("ship_zoomy"===this.type?this.helpReverseCompleted&&(this.scene.ui.isHelpNeed=!1,this.scene.ui.setZoomyShipHelp()):this.helpLeftCompleted&&this.helpRightCompleted&&this.helpUpCompleted&&this.helpShootCompleted&&(this.scene.ui.isHelpNeed=!1,this.scene.ui.setHelp()))}},{key:"set_skin",value:function(e){return void 0!==e&&""!==e&&(this.skin=e),null===this.skinGO&&(this.skinGO=this.scene.add.sprite(0,0,this.skin),this.add(this.skinGO),this.skinGO.setZ(2)),this.skinGO.setTexture(this.skin),this.skinGO.setOrigin(.5),this.curAnimation="idle",this.skinGO.play(this.skin+"_"+this.curAnimation),this.sort("z"),this}},{key:"set_size",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.size;return null!==this.skinGO&&(this.setScale(e),this.size=e),this}},{key:"set_bullet",value:function(e){return this.bullet=e,this}},{key:"set_collider",value:function(e){if(this.collider=e,null!==this.skinGO){var t=e.shape;if("string"==typeof t)if("circle"===t){var s=e.radius;this.body.setCircle(s,this.displayOriginX-s,this.displayOriginY-s)}else"rectangle"===t&&(this.body.setSize(e.width,e.height),this.body.setOffset(e.offset_x,e.offset_y))}}},{key:"set_powerups",value:function(e){for(var t in e)this.powerups[t]=Object.assign({},e[t]);return this}},{key:"set_max_speed",value:function(e){return this.body.setMaxSpeed(e),this.max_speed=e,this}},{key:"set_min_speed",value:function(e){return this.min_speed=e,this}},{key:"set_acceleration",value:function(e){return this.acceleration=e,this}},{key:"set_slowdown",value:function(e){return this.slowdown=e,this}},{key:"set_rotate_speed",value:function(e){return this.rotate_speed=e,this}},{key:"set_use_num_shots",value:function(e){return this.use_num_shots=e,this}},{key:"set_num_shots",value:function(e){return this.num_shots=e,this}},{key:"set_wait_bullets_die",value:function(e){return this.wait_bullets_die=e,this}},{key:"set_delay_num_shots",value:function(e){return this.delay_num_shots=e,this}},{key:"set_shot_delay",value:function(e){return this.shot_delay=e,this}},{key:"set_bullet",value:function(e){return this.bullet=e,this}},{key:"set_bullet_offset",value:function(e){return this.bulletOffset=e,this}},{key:"set_is_fuzzy_fire",value:function(e){return this.is_fuzzy_fire=e,this}},{key:"set_fuzzy_range",value:function(e){return this.fuzzy_range=e,this}},{key:"set_frames_to_rotate",value:function(e){return this.frames_to_rotate=e,this}},{key:"set_frames_rot_speed",value:function(e){return this.frames_rot_speed=e,this}},{key:"readConfig",value:function(e){return this.set_skin(g(e,"skin",this.skin).value),this.set_max_speed(g(e,"max_speed",this.max_speed).value),this.set_min_speed(g(e,"min_speed",this.min_speed).value),this.set_acceleration(g(e,"acceleration",this.acceleration).value),this.set_slowdown(g(e,"slowdown",this.slowdown).value),this.set_rotate_speed(g(e,"rotate_speed",this.rotate_speed).value),this.set_shot_delay(g(e,"shot_delay",this.shot_delay).value),this.set_use_num_shots(g(e,"use_num_shots",this.use_num_shots).value),this.set_num_shots(g(e,"num_shots",this.num_shots).value),this.set_wait_bullets_die(g(e,"wait_bullets_die",this.wait_bullets_die).value),this.set_delay_num_shots(g(e,"delay_num_shots",this.delay_num_shots).value),this.set_is_fuzzy_fire(g(e,"is_fuzzy_fire",this.is_fuzzy_fire).value),this.set_fuzzy_range(g(e,"fuzzy_range",this.fuzzy_range).value),this.set_frames_to_rotate(g(e,"frames_to_rotate",this.frames_to_rotate).value),this.set_frames_rot_speed(g(e,"frames_rot_speed",this.frames_rot_speed).value),this.set_bullet(g(e,"bullet",this.bullet).value),this.set_bullet_offset(g(e,"bullet_offset",this.bulletOffset).value),this.set_collider(g(e,"collider",this.collider).value),this.set_powerups(g(e,"powerups",this.powerups).value),this.set_size(g(e,"size",this.size).value),this}},{key:"readConfigByType",value:function(e){var t=this.units.hasOwnProperty(e)?this.units[e]:this.config;this.config=t,this.readConfig(t)}}])&&H(s.prototype,i),n&&H(s,n),t}();function Y(e){return(Y="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function X(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),s.push.apply(s,i)}return s}function J(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}function Z(e,t){for(var s=0;s<t.length;s++){var i=t[s];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function q(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function $(e,t,s){return($="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,s){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=ee(e)););return e}(e,t);if(i){var n=Object.getOwnPropertyDescriptor(i,t);return n.get?n.get.call(s):n.value}})(e,t,s||e)}function ee(e){return(ee=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function te(e,t){return(te=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var se=function(e){function t(e,s,i,n){var r,a,o;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),a=this,(r=!(o=ee(t).call(this,e,s,i))||"object"!==Y(o)&&"function"!=typeof o?q(a):o).scene=e,r.scene.add.existing(q(r)),r.scene.physics.add.existing(q(r)),r.setOrigin(.5),r.body.setEnable(!1),r.category="asteroids",r.type="light_blue",r.units=Phaser.GLOBALS.units_waves[r.category].units,r.config=n||r.units[r.type],r.skin="light_blue",r.skins=["asteroid_1","asteroid_2","asteroid_3"],r.size=[1,1,1],r.destructions=2,r.explosive_parts=[2,2,2],r.part_hp=1,r.move_speeds=[[50,50,50],[60,60,60],[70,70,70]],r.is_rotate=!0,r.rot_speeds=[[0,0,0],[0,0,0],[0,0,0]],r.scores=[20,50,100],r.collider=[{shape:"circle",radius:38,offset_x:2,offset_y:2},{shape:"circle",radius:28,offset_x:2,offset_y:2},{shape:"circle",radius:16,offset_x:2,offset_y:2}],r.loot_chances=[.1,.3,.6],r.mass=[],r.curDestr=0,r.curCollider={},r.curHP=r.part_hp,r.curRotSpeed=0,r.curScore=r.scores["score_"+r.curDestr],r.velocity={x:0,y:0},r.padding=0,r.uid=0,r.shooter=null,r.predicted_parts=null,r.isFreeze=!1,r.ice=null,r.destroy_all_add_time=1,r.destroy_all_add_time_mobile=2,r.overlapAsteroidsShipBullets=null,r.overlapAsteroidsEnemyBullets=null,r.overlapdEachOther=null,r.addOverlapAsteroidsShipBullets(),r.addOverlapAsteroidsEnemyBullets(),r.collideIDs={},r.colliderID=Phaser.Math.RND.between(0,99999),r.soundBangLarge=r.scene.sound.add("bang_large"),r.soundBangMedium=r.scene.sound.add("bang_medium"),r.soundBangSmall=r.scene.sound.add("bang_small"),r.readConfigByType(r.type),r.resetCurVars(),r.addEditorEmmiter(),r}var s,i,n;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&te(e,t)}(t,Phaser.Physics.Arcade.Sprite),s=t,(i=[{key:"updateCurRotation",value:function(e){return e||(e=this.curDestr),this.curRotSpeed=Phaser.Math.DegToRad(Phaser.Math.RND.pick(this.rot_speeds[e])),this.curMoveSpeed}},{key:"updateCurMoveSpeed",value:function(e){return e||(e=this.curDestr),this.move_speeds&&this.move_speeds[e]&&(this.curMoveSpeed=Phaser.Math.RND.pick(this.move_speeds[e])),this.curMoveSpeed}},{key:"updateCurScore",value:function(e){return e||(e=this.curDestr),this.curScore=this.scores[e],this.curScore}},{key:"setCurDestr",value:function(e){this.curDestr=e,this.updateCurRotation(),this.updateCurMoveSpeed(),this.updateCurScore(),this.play(this.skin+"_"+this.curDestr),this.set_scale(this.size[this.curDestr])}},{key:"resetCurVars",value:function(){this.curDestr=0,this.curHP=this.part_hp,this.velocity={x:0,y:0},this.ice=null,this.isFreeze=!1,this.updateCurRotation(this.curDestr),this.updateCurMoveSpeed(this.curDestr),this.updateCurScore(this.curDestr)}},{key:"spawn",value:function(e,t,s,i){var n=this,r=(i=function(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?X(s,!0).forEach(function(t){J(e,t,s[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):X(s).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))})}return e}({},{rotation:null,parentVelocity:{x:0,y:0},destruction:null,speed:null,uid:null,skin:null,debug:!1},{},i)).hasOwnProperty("rotation")?i.rotation:Phaser.Math.RND.rotation(),a=i.hasOwnProperty("parentVelocity")?i.parentVelocity:{x:0,y:0},o=null!==i.destruction?i.destruction:0;i.hasOwnProperty("skin")&&i.skin,null!==i.debug&&i.debug,this.uid=null!==i.uid?i.uid:0,this.scene.wavesManager.asteroidsManager.uidHash[this.uid]++,this.scene.wavesManager.asteroidsManager.aliveCount++,o===this.destructions&&this.scene.wavesManager.asteroidsManager.aliveLastDestrCount++,e!==this.type&&(this.type=e,this.readConfigByType(this.type)),this.setCurDestr(o),this.curMoveSpeed=null!==i.speed?i.speed:this.curMoveSpeed,this.setRotation(Phaser.Math.DegToRad(Phaser.Math.Between(-15,15)));var h=a.x,l=a.y;this.scene.game.loop.delta,this.body.reset(t,s),this.set_collider(),this.velocity.x=Math.cos(r)*this.curMoveSpeed,this.velocity.y=Math.sin(r)*this.curMoveSpeed,this.velocity.x+=.6*h,this.velocity.y+=.6*l,this.body.setVelocity(this.velocity.x,this.velocity.y),this.isFreeze&&this.setFreeze(this.isFreeze);var u=this.mass[this.curDestr]?this.mass[this.curDestr]:Math.round(Math.PI*Math.pow(this.body.halfWidth,2));this.body.setMass(u),this.body.preUpdate(),this.setActive(!0),setTimeout(function(){n.setVisible(!0),n.setAlpha(1),n.body.setEnable(!0)},0)}},{key:"subDestruction",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(this.curHP-=e,this.curHP<=0){this.curHP=this.part_hp;var s=this.curDestr;this.curDestr+=e,this.scene.wavesManager.asteroidsManager.uidHash[this.uid]--,this.scene.wavesManager.asteroidsManager.aliveCount--,this.scene.wavesManager.asteroidsManager.destroyed++,this.scene.wavesManager.asteroidsManager.destroyedTypes[this.type]++;var i=this.isFreeze;if(this.ice&&this.ice.stop(),this.curDestr<=this.destructions){var n=this.type,r=this.x,a=this.y,o=this.body.velocity,h=Phaser.Math.Angle.Between(0,0,o.x,o.y),l=this.curDestr,u=(this.skin,Phaser.Math.RND.sign(),Phaser.Math.RND.pick(this.explosive_parts));null!==this.predicted_parts&&this.predicted_parts.hasOwnProperty(l-1)&&(u=this.predicted_parts[l-1].pop());var c=0,p=0;i&&(c=Phaser.Math.RND.rotation(),p=2*Math.PI/u);for(var d=0;d<u;d++){var f=this.scene.asteroidsGroup.get();if(f){var y=void 0,m=void 0;if(m=Phaser.Math.RND.rotation(),f.setDepth(12),f.predicted_parts=this.predicted_parts,0===d?Math.random()<.7&&(y=Phaser.Math.DegToRad(10),m=Phaser.Math.RND.between(-y,y)):1===d&&Math.random()<.7&&(y=Phaser.Math.DegToRad(Phaser.Math.RND.between(80,100)),m=Phaser.Math.RND.sign()*y),f.isFreeze=i,i){f.setDepth(1);var v=this.collider[l-1].radius,_=c+p*d;r=this.x+Math.cos(_)*v/2,a=this.y+Math.sin(_)*v/2}f.spawn(n,r,a,{rotation:h+m,parentVelocity:{x:o.x,y:o.y},destruction:l,uid:this.uid,debug:!0})}}1===this.curDestr?"game"===this.scene.layoutState&&this.soundBangLarge.play():2===this.curDestr&&"game"===this.scene.layoutState&&this.soundBangMedium.play(),this.scene.effectsManager.spawnEffect(this.x,this.y,this.type+"_explode_"+this.curDestr,{velocity:this.body.velocity})}else{var g=this.curDestr===this.destructions+1?this.curDestr:s+1;this.scene.effectsManager.spawnEffect(this.x,this.y,this.type+"_explode_"+g,{velocity:this.body.velocity}),"game"===this.scene.layoutState&&this.soundBangSmall.play(),this.curDestr=0,this.predicted_parts=null,this.set_collider(),this.scene.wavesManager.asteroidsManager.uidHash[this.uid]<=0&&(this.scene.wavesManager.asteroidsManager.uidDestroyed++,this.scene.wavesManager.asteroidsManager.uidDestroyedTypes[this.type]++),this.scene.wavesManager.asteroidsManager.aliveLastDestrCount--,t||this.scene.wavesManager.checkEndOfWave()}t||("mission"===this.scene.mode&&(this.scene.wavesManager.is_tasks&&this.scene.wavesManager.tasks_is_asteroids&&(this.scene.wavesManager.tasks_asteroids--,this.ui&&this.ui.jumpMissionTask(),this.scene.wavesManager.checkEndOfWave()),this.scene.wavesManager.is_limited_ammo&&(this.scene.wavesManager.limited_ammo_asteroids--,this.scene.wavesManager.updateTaskText()),"ships"===this.shooter.category&&this.scene.wavesManager.is_destroy_all&&this.scene.wavesManager.missiomTime-.5>0&&(this.scene.wavesManager.missiomTime+=(this.scene.isMobile?this.destroy_all_add_time_mobile:this.destroy_all_add_time)||3,this.scene.ui&&(this.scene.ui.jumpMissionTimer(),this.scene.ui.missionTimerSec.setText(this.scene.wavesManager.missiomTime),this.scene.ui.checkTimerRed()),this.scene.effectsManager.spawnAddTime(this.x,this.y-50,"+"+(this.scene.isMobile?this.destroy_all_add_time_mobile:this.destroy_all_add_time)+" sec",0,18)),this.scene.powerupManager.is_drop_from_ast&&(this.scene.powerupManager.is_drop_each_ast_part?this.scene.powerupManager.lootChooser({x:this.x,y:this.y,velocity:this.body.velocity,from:"asteroid",type:this.type,chance:this.loot_chances[s]}):this.curDestr>this.destructions&&this.scene.powerupManager.lootChooser({x:this.x,y:this.y,velocity:this.body.velocity,from:"asteroid",type:this.type,chance:this.loot_chances[s]}))),"ships"===this.shooter.category&&(this.scene.stats||(this.scene.stats={}),this.scene.stats.hasOwnProperty("destroyed_asteroids")||(this.scene.stats.destroyed_asteroids=0),this.scene.stats.destroyed_asteroids++,this.scene.saveSaves())),this.hide()}else"blue"===this.type&&this.anims.play("blue_destr_"+this.curDestr,[],this.anims.currentFrame.index),this.setFreeze(this.isFreeze)}},{key:"setFreeze",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(this.isFreeze=e,this.isFreeze){this.body.setVelocity(0,0),this.anims.pause(),this.anims.isPlaying=!1;var t=null;(t=null===this.ice?this.scene.powerupManager.freeze.iceGroup.get():this.ice)&&(t.start(this.x,this.y,"asteroid_"+this.curDestr),this.setDepth(1),t.setDepth(this.depth+1),t.freezedObject=this,this.ice=t,"blue"===this.type&&1===this.curHP&&this.ice.start(this.x,this.y,"asteroid_"+this.curDestr+"_2"))}else this.setDepth(5),this.body.setVelocity(this.velocity.x,this.velocity.y),this.anims.resume(),this.anims.isPlaying=!0,this.ice&&(this.ice.stop(),this.ice=null)}},{key:"show",value:function(){this.setActive(!0),this.setVisible(!0),this.body.setEnable(!0),this.setAlpha(1)}},{key:"hide",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(t)this.setActive(!1),this.setVisible(!1);else{var s=function(){var t=.001*e.scene.game.loop.delta;e.setPosition(e.x+e.body.velocity.x*t,e.y+e.body.velocity.y*t)};this.scene.tweens.add({targets:this,alpha:0,duration:50,ease:"Power0",onComplete:function(){e.setActive(!1),e.setVisible(!1),e.setCurDestr(e.curDestr)},onStart:function(){s()},onUpdate:function(e,t){s()}},this)}this.body.setEnable(!1),this.resetCurVars()}},{key:"shipBulletHitAsteroid",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this,s=Math.round(t.curScore*this.scene.scoreIncreaseMult);this.scene.addScores(s),"classic"===this.scene.mode&&this.scene.effectsManager.spawnEffect(t.x,t.y,"scores_asteroid_1",{scores:s,ast_size:t.curDestr}),t.shooter=e.shooter,t.subDestruction(e.power)}},{key:"addOverlapAsteroidsShipBullets",value:function(){return this.overlapAsteroidsShipBullets=this.scene.physics.add.overlap(this,this.scene.playerBulletsGroup,function(e,s){var i,n;e instanceof t?(i=e,n=s):(i=s,n=e),i.shipBulletHitAsteroid(n),n.hide()}),this.overlapAsteroidsShipBullets}},{key:"addOverlapAsteroidsEnemyBullets",value:function(){return this.overlapAsteroidsEnemyBullets=this.scene.physics.add.overlap(this,this.scene.enemiesBulletsGroup,function(e,s){var i,n;e instanceof t?(i=e,n=s):(i=s,n=e),i.shooter=n.shooter,i.subDestruction(n.power),n.hide()}),this.overlapAsteroidsEnemyBullets}},{key:"addOverlapdEachOther",value:function(){return this.overlapdAsteroidsAsteroids=this.scene.physics.add.collider(this.scene.asteroidsGroup,void 0,function(e,t){}),this.overlapdAsteroidsAsteroids}},{key:"preUpdate",value:function(e,s){$(ee(t.prototype),"preUpdate",this).call(this,e,s),this.is_rotate&&(this.rotation+=this.curRotSpeed*s*.001),this.body.world.wrap(this,this.padding)}},{key:"set_skin",value:function(e){return void 0!==e&&""!==e&&(this.skin=e,this.play(this.skin+"_"+this.curDestr,[],Phaser.Math.Between(0,29)),this.anims.setTimeScale(Phaser.Math.Between(1,1.5)),Phaser.Math.RND.sign()>0&&this.anims.reverse(),this.set_collider()),this}},{key:"set_skins",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.skins;void 0!==e&&Array.isArray(e)&&(this.skins=e,this.set_skin(Phaser.Math.RND.pick(this.skins)))}},{key:"set_collider",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.collider;this.collider=e;var t=e[this.curDestr],s=t.shape;if("string"==typeof s)if("circle"===s){var i=t.radius;this.body.setCircle(i,this.displayOriginX-i,this.displayOriginY-i),this.padding=1*i}else"rectangle"===s&&(this.body.setSize(t.width,t.height),this.body.setOffset(t.offset_x,t.offset_y));return this}},{key:"set_scale",value:function(e){this.setScale(e)}},{key:"set_size",value:function(e){return this.size=e,this.set_scale(this.size[this.curDestr]),this}},{key:"set_destructions",value:function(e){return this.destructions=e,this}},{key:"set_explosive_parts",value:function(e){return this.explosive_parts=e,this}},{key:"set_part_hp",value:function(e){return this.part_hp=e,this.curHP=this.part_hp,this}},{key:"set_move_speeds",value:function(e){return this.move_speeds=e,this}},{key:"set_is_rotate",value:function(e){return this.is_rotate=e,this.is_rotate||(this.rotation=0),this}},{key:"set_rot_speeds",value:function(e){return this.rot_speeds=e,this}},{key:"set_scores",value:function(e){return this.scores=e,this}},{key:"set_loot_chances",value:function(e){return this.loot_chances=e,this}},{key:"readConfig",value:function(e){this.set_skin(g(e,"skin",this.skin).value),this.set_size(g(e,"size",this.size).value),this.set_destructions(g(e,"destructions",this.destructions).value),this.set_explosive_parts(g(e,"explosive_parts",this.explosive_parts).value),this.set_part_hp(g(e,"part_hp",this.part_hp).value),this.set_move_speeds(g(e,"move_speeds",this.move_speeds).value),this.set_is_rotate(g(e,"is_rotate",this.is_rotate).value),this.set_rot_speeds(g(e,"rot_speeds",this.rot_speeds).value),this.set_scores(g(e,"scores",this.scores).value),this.set_collider(g(e,"collider",this.collider).value),this.set_loot_chances(g(e,"loot_chances",this.loot_chances).value)}},{key:"readConfigByType",value:function(e){var t=this.units.hasOwnProperty(e)?this.units[e]:this.config;this.readConfig(t)}}])&&Z(s.prototype,i),n&&Z(s,n),t}();Object.assign(se.prototype,b);var ie=se;function ne(e,t,s,i,n){var r=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,a=arguments.length>6&&void 0!==arguments[6]?arguments[6]:0,o=!(arguments.length>7&&void 0!==arguments[7])||arguments[7],h=!(arguments.length>8&&void 0!==arguments[8])||arguments[8],l=arguments.length>9?arguments[9]:void 0,u=arguments.length>10?arguments[10]:void 0,c=arguments.length>11&&void 0!==arguments[11]?arguments[11]:0,p=arguments.length>12&&void 0!==arguments[12]?arguments[12]:0,d=arguments.length>13&&void 0!==arguments[13]?arguments[13]:20,f={x:t,y:s},y=t+r,m=s+a;l=l||e.cameras.main.width,u=u||e.cameras.main.height;for(var v=e.physics.overlapRect(y,m,i,n),_=0,g=0;g<v.length;g++)v[g].enable&&_++;return 0!==_&&void 0!==(f=function(t,s,i,n){for(var r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,o=!(arguments.length>6&&void 0!==arguments[6])||arguments[6],h=!(arguments.length>7&&void 0!==arguments[7])||arguments[7],l=arguments.length>8?arguments[8]:void 0,u=arguments.length>9?arguments[9]:void 0,c=arguments.length>10?arguments[10]:void 0,p=o?Phaser.Math.RND.sign():0,d=h?Phaser.Math.RND.sign():0,f=c,y=c,m=t,v=s,_=0;_<2;_++){for(var g=p>0?Math.floor(Math.abs(r-i-m)/f):p<0?Math.floor(Math.abs(m-l)/f):1,b=d>0?Math.floor(Math.abs(a-n-v)/y):d<0?Math.floor(Math.abs(v-u)/y):1,w=0;w<g;w++)for(var k=0===w?1:0;k<b;k++){for(var O=m+f*w*p,S=v+y*k*d,P=e.physics.overlapRect(O,S,i,n),M=0,x=0;x<P.length;x++)P[x].enable&&M++;if(0===M)return{x:O,y:S}}p*=-1,d*=-1}}(y,m,i,n,l,u,o,h,c,p,d))&&(f={x:f.x-r,y:f.y-a}),f}function re(e){return(re="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ae(e,t){for(var s=0;s<t.length;s++){var i=t[s];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function oe(e){return(oe=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function he(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function le(e,t){return(le=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var ue=function(e){function t(e,s,i,n){var r,a,o;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),a=this,(r=!(o=oe(t).call(this,e,s,i))||"object"!==re(o)&&"function"!=typeof o?he(a):o).scene=e,r.scene.add.existing(he(r)),r.scene.physics.world.enable(he(r),0),r.category="enemies",r.type="ufo_1",r.units=Phaser.GLOBALS.units_waves[r.category].units,r.config=n||r.units[r.type],r.skin="ufo_1",r.speed=[60,60,65],r.lifetime=[4e3,4100,4200],r.random_move_angles=[0,45,-45],r.random_move_delay=[100,200,500,1e3,1e3,2e3],r.bullet_type="default",r.is_use_bullet_type=!0,r.bullet_skin="bullet_enemy",r.bullet_speed=700,r.bullet_lifetime=600,r.bullet_power=1,r.wait_before_first_shot=[900,1e3,1200],r.shot_delay=[500,800,1100],r.score=200,r.destroy_all_add_time=3,r.is_player_target=!0,r.is_asteroid_target=!1,r.is_move_to_player=!1,r.accuracy=.5,r.accuracy_angles_range={from:-15,to:15},r.is_dies_by_asteroids=!0,r.is_die_outside=!0,r.hp=1,r.is_jerk=!1,r.jerk_dist=100,r.jerk_wait=1e3,r.is_loot_powerups=!1,r.loot_chances=[.9],r.looted_powerups=["all"],r.collider={shape:"circle",radius:10,offset_x:-10,offset_y:-9},r.skinGO=null,r.bulletOffset=10,r.size=1,r.padding=0,r.velocity={x:0,y:0},r.uid=0,r.lastFired=0,r.deadTime=0,r.startRot=0,r.spawnSide="",r.deadSide="",r.shooter=null,r.curSpeed=0,r.curLifetime=1e4,r.curMoveAngle=0,r.curMoveDelay=100,r.curWaitBeforeFirstShot=0,r.curShotDelay=900,r.curHP=r.hp,r.isFreeze=!1,r.ice=null,r.overlapEnemiesShipBullets=null,r.overlapEnemiesAsteroids=null,r.addOverlapEnemiesShipBullets(),r.addOverlapEnemiesAsteroids(),r.timerMoveDelay=null,r.timerWaitBeforeFirstShot=null,r.timerShotDelay=null,r.timerUfoAttackWait=null,r.soundBangLarge=r.scene.sound.add("bang_large"),r.readConfigByType(r.type),r.updateCurVars(),b.addEditorEmmiter.call(he(r),function(e){}),r}var s,i,n;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&le(e,t)}(t,Phaser.GameObjects.Container),s=t,(i=[{key:"spawn",value:function(e,t,s){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{rotation:null,skin:null,spawn_side:null,dead_side:null,uid:null,find_free_space:null};this.setVisible(!1),this.updateCurVars(),this.startRot=i.hasOwnProperty("rotation")?i.rotation:Phaser.Math.RND.pick([0,Phaser.Math.DegToRad(180)]);var n=i.hasOwnProperty("skin")?i.skin:"";this.spawnSide=i.hasOwnProperty("spawn_side")?i.spawn_side:t<0?"l":t>this.scene.cameras.main.width?"r":s<0?"t":"d",this.deadSide=i.hasOwnProperty("dead_side")?i.dead_side:"";var r=!i.hasOwnProperty("find_free_space")||i.find_free_space,a={x:t,y:s};if(this.uid=i.hasOwnProperty("uid")?i.uid:0,this.scene.wavesManager.enemiesManager.uidHash[this.uid]++,this.scene.wavesManager.enemiesManager.aliveCount++,"ufo_1"===e&&this.scene.wavesManager.enemiesManager.aliveCountUfo1++,"ufo_2"===e&&this.scene.wavesManager.enemiesManager.aliveCountUfo2++,""!==n&&n!==this.skin&&this.set_skin(n),e!==this.type&&(this.type=e,this.readConfigByType(this.type)),r){var o="l"===this.spawnSide||"r"===this.spawnSide,h="t"===this.spawnSide||"d"===this.spawnSide,l=3;if(void 0===(a=ne(this.scene,t,s,2*this.padding*l,2*this.padding*l,-this.padding*l,-this.padding*l,h,o)))return this.scene.wavesManager.enemiesManager.destroyedByBorder++,this.hide(),void this.disappear()}this.body.reset(a.x,a.y),this.setBodyVelocity(this.startRot),this.runTimerMoveDelay(),this.runTimerWaitBeforeFirstShot(),this.deadTime=this.scene.time.now+this.curLifetime,this.scene.wavesManager.enemiesManager.controlEnemiesSound(),this.show(),this.uid=Phaser.Math.RND.between(0,1e3)}},{key:"setBodyVelocity",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.startRot,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.curSpeed;this.velocity.x=Math.cos(e)*t,this.velocity.y=Math.sin(e)*t,this.body.setVelocity(this.velocity.x,this.velocity.y)}},{key:"fireBullet",value:function(e){var t=this.scene.enemiesBulletsGroup.getFirstDead(!0);if(t){t.shooter=this;var s=.001*this.scene.game.loop.delta,i=Phaser.Math.RND.rotation();if(this.is_player_target=Math.random()<.3,this.is_asteroid_target=!0,this.is_player_target&&this.scene.ships.length>0){var n=this.scene.ships.length>1?Phaser.Math.RND.pick(this.scene.ships):this.scene.ships[0],r=Phaser.Math.Angle.Between(this.x+this.body.velocity.x*s,this.y+this.body.velocity.y*s,n.x,n.y),a=.5*Math.max(0,Math.unlerp(.5,0,this.accuracy)),o=this.accuracy_angles_range.from*a,h=this.accuracy_angles_range.to*a,l=0;l="from"===Phaser.Math.RND.pick(["from","to"])?Phaser.Math.RND.between(o,this.accuracy_angles_range.from):Phaser.Math.RND.between(h,this.accuracy_angles_range.to);var u=r+Phaser.Math.DegToRad(l);i=Phaser.Math.Linear(u,r,Math.max(0,Math.unlerp(.4,1,this.accuracy)))}else if(this.is_asteroid_target){var c=this.getNearest(this.scene.asteroidsGroup,this.x,this.y,this.scene.cameras.main.width,this.scene.cameras.main.height);c&&(i=Phaser.Math.Angle.Between(this.x+this.body.velocity.x*s,this.y+this.body.velocity.y*s,c.x,c.y))}var p=this.x+Math.cos(i)*this.bulletOffset+this.body.velocity.x*s,d=this.y+Math.sin(i)*this.bulletOffset+this.body.velocity.y*s,f={type:this.bullet_type};this.is_use_bullet_type||(f={skin:this.bullet_skin,speed:this.bullet_speed,lifetime:this.bullet_lifetime,power:this.bullet_power}),f.skin="bullet_enemy",t.fire(p,d,i,f)}}},{key:"getNearest",value:function(e,t,s,i,n){var r,a=9999999;return e.getChildren().forEach(function(e){if(e.active&&e.body.enable){var o=Math.abs(e.x-t)+Math.abs(e.y-s);o<=a&&(a=o,r=e);var h=Math.abs(i-e.x+t)+Math.abs(n-e.y+s);h<=a&&(a=h,r=e)}}),r}},{key:"subDestruction",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"bullet",s=arguments.length>2?arguments[2]:void 0;if(this.curHP-=e,this.curHP<=0){if("game"===this.scene.layoutState&&this.soundBangLarge.play(),"collide"===t?this.scene.wavesManager.enemiesManager.destroyedByCollide++:this.scene.wavesManager.enemiesManager.destroyedByHero++,"mission"===this.scene.wavesManager.mode&&this.scene.wavesManager.is_ufo_attack&&this.scene.ui){var i=Math.max(0,this.scene.wavesManager.partEnemiesCount-(this.scene.wavesManager.enemiesManager.destroyedByHero+this.scene.wavesManager.enemiesManager.destroyedByCollide));this.scene.ui.setShipText(i)}this.scene.effectsManager.spawnEffect(this.x,this.y,this.type+"_explode"),this.ice&&this.ice.stop(),this.hide(),s&&"ships"!==s.category||(this.scene.stats||(this.scene.stats={}),this.scene.stats.hasOwnProperty("destroyed_ufos")||(this.scene.stats.destroyed_ufos=0),this.scene.stats.destroyed_ufos++,this.scene.saveSaves())}}},{key:"disappear",value:function(){this.scene.wavesManager.enemiesManager.uidHash[this.uid]--,this.scene.wavesManager.enemiesManager.aliveCount--,this.scene.wavesManager.enemiesManager.uidHash[this.uid]<=0&&this.scene.wavesManager.enemiesManager.uidDestroyed++,this.scene.wavesManager.is_ufo_attack&&(this.scene.wavesManager.enemiesManager.aliveCount<=0||this.scene.wavesManager.enemiesManager.aliveCount<this.scene.wavesManager.partMinEnemiesOnScreen)&&this.scene.wavesManager.enemiesSpawn(),this.scene.isGameOver||this.scene.isMissionCompleted||("classic"===this.scene.wavesManager.mode&&this.scene.wavesManager.runTimerSpawnUfoDelay(),this.scene.wavesManager.checkEndOfWave())}},{key:"setFreeze",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(this.isFreeze=e,this.isFreeze){if(this.body.setVelocity(0,0),this.skinGO.anims.pause(),this.skinGO.anims.isPlaying=!1,null===this.ice){var t=this.scene.powerupManager.freeze.iceGroup.get();t.start(this.x,this.y,this.type),t.setDepth(this.depth+1),t.freezedObject=this,this.ice=t}this.timerMoveDelay&&(this.timerMoveDelay.timeScale=0),this.timerWaitBeforeFirstShot&&(this.timerWaitBeforeFirstShot.timeScale=0),this.timerShotDelay&&(this.timerShotDelay.timeScale=0)}else this.body.setVelocity(this.velocity.x,this.velocity.y),this.skinGO.anims.resume(),this.skinGO.anims.isPlaying=!0,this.ice.stop(),this.ice=null,this.timerMoveDelay&&(this.timerMoveDelay.timeScale=1),this.timerWaitBeforeFirstShot&&(this.timerWaitBeforeFirstShot.timeScale=1),this.timerShotDelay&&(this.timerShotDelay.timeScale=1)}},{key:"show",value:function(){this.setActive(!0),this.setVisible(!0),this.body.setEnable(!0),this.setAlpha(1)}},{key:"hide",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if("ufo_1"===this.type&&this.scene.wavesManager.enemiesManager.aliveCountUfo1--,"ufo_2"===this.type&&this.scene.wavesManager.enemiesManager.aliveCountUfo2--,this.resetTimers(),t)this.setActive(!1),this.setVisible(!1),this.scene.wavesManager.enemiesManager.controlEnemiesSound();else{var s=function(){var t=.001*e.scene.game.loop.delta;e.setPosition(e.x+e.body.velocity.x*t,e.y+e.body.velocity.y*t)};this.scene.tweens.add({targets:this,alpha:0,duration:50,ease:"Power0",onComplete:function(){e.setActive(!1),e.setVisible(!1),e.disappear(),e.scene.wavesManager.enemiesManager.controlEnemiesSound()},onStart:function(){s()},onUpdate:function(e,t){s()}},this)}this.body.setEnable(!1),this.updateCurVars()}},{key:"resetTimers",value:function(){this.timerMoveDelay&&this.timerMoveDelay.remove(),this.timerWaitBeforeFirstShot&&this.timerWaitBeforeFirstShot.remove(),this.timerShotDelay&&this.timerShotDelay.remove(),this.timerUfoAttackWait&&this.timerUfoAttackWait.remove()}},{key:"shipBulletHitEnemy",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this,s=Math.round(t.score*this.scene.scoreIncreaseMult);this.scene.addScores(s),"classic"===this.scene.mode&&this.scene.effectsManager.spawnEffect(t.x,t.y,"scores_enemy_1",{scores:s,enemy_type:t.type}),t.subDestruction(e.power),"mission"===this.scene.mode&&this.scene.wavesManager.is_destroy_all&&this.scene.wavesManager.missiomTime-.5>0&&(this.scene.wavesManager.missiomTime+=t.destroy_all_add_time||3,this.scene.ui&&(this.scene.ui.jumpMissionTimer(),this.scene.ui.missionTimerSec.setText(this.scene.wavesManager.missiomTime),this.scene.ui.checkTimerRed()),this.scene.effectsManager.spawnAddTime(t.x,t.y-50,"+"+t.destroy_all_add_time+" sec",0,18)),e.shooter&&e.shooter.soundPlayerKillsUFO.play()}},{key:"addOverlapEnemiesShipBullets",value:function(){return this.overlapEnemiesShipBullets=this.scene.physics.add.overlap(this,this.scene.playerBulletsGroup,function(e,s){var i,n;e instanceof t?(i=e,n=s):(i=s,n=e),i.shipBulletHitEnemy(n),n.hide()}),this.overlapEnemiesShipBullets}},{key:"addOverlapEnemiesAsteroids",value:function(){return this.overlapEnemiesAsteroids=this.scene.physics.add.overlap(this,this.scene.asteroidsGroup,function(e,t){var s,i;"asteroids"===e.category?(s=e,i=t):(s=t,i=e),s.subDestruction(1),i.subDestruction(1,"collide",s)}),this.overlapEnemiesAsteroids}},{key:"preUpdate",value:function(e,t){!this.scene.wavesManager.is_ufo_attack&&e>this.deadTime&&(this.is_die_outside?""!==this.deadSide&&("l"===this.deadSide?this.x<=this.scene.cameras.main.worldView.left-this.padding&&(this.scene.wavesManager.enemiesManager.destroyedByBorder++,this.hide(!0),this.disappear()):"r"===this.deadSide?this.x>=this.scene.cameras.main.worldView.right+this.padding&&(this.scene.wavesManager.enemiesManager.destroyedByBorder++,this.hide(!0),this.disappear()):"t"===this.deadSide?this.y<=this.scene.cameras.main.worldView.top-this.padding&&(this.scene.wavesManager.enemiesManager.destroyedByBorder++,this.hide(!0),this.disappear()):this.y>=this.scene.cameras.main.worldView.bottom+this.padding&&(this.scene.wavesManager.enemiesManager.destroyedByBorder++,this.hide(!0),this.disappear())):this.hide()),this.body.world.wrap(this,this.padding)}},{key:"runTimerMoveDelay",value:function(){var e=this;this.timerMoveDelay=this.scene.time.addEvent({delay:this.curMoveDelay,callback:function(){var t=e.startRot+Phaser.Math.DegToRad(e.curMoveAngle);if(e.is_move_to_player=!0,e.is_move_to_player&&e.scene.ships.length>0){var s=.001*e.scene.game.loop.delta,i=e.scene.ships.length>1?Phaser.Math.RND.pick(e.scene.ships):e.scene.ships[0],n=Phaser.Math.Angle.Between(e.x+e.body.velocity.x*s,e.y+e.body.velocity.y*s,i.x,i.y),r=Phaser.Math.RadToDeg(Math.round(n/(Math.PI/4))*(Math.PI/4)),a=Phaser.Math.Angle.ShortestBetween(Phaser.Math.RadToDeg(e.startRot),r);Math.abs(a)<90&&(t=Phaser.Math.DegToRad(r))}e.setBodyVelocity(t),e.updateCurMoveAngle(),e.updateCurMovDelay(),e.runTimerMoveDelay()},callbackScope:this})}},{key:"runTimerWaitBeforeFirstShot",value:function(){var e=this;this.timerWaitBeforeFirstShot&&this.timerWaitBeforeFirstShot.remove(),this.timerWaitBeforeFirstShot=this.scene.time.addEvent({delay:this.curWaitBeforeFirstShot,callback:function(){e.runTimerShotDelay()},callbackScope:this})}},{key:"runTimerShotDelay",value:function(){var e=this;this.timerShotDelay&&this.timerShotDelay.remove(),this.timerShotDelay=this.scene.time.addEvent({delay:this.curShotDelay,callback:function(){e.fireBullet(),e.updateCurShotDelay(),e.runTimerShotDelay()},callbackScope:this})}},{key:"updateCurSpeed",value:function(){return this.curSpeed=Phaser.Math.RND.pick(this.speed),this.curSpeed}},{key:"updateCurLifetime",value:function(){return this.curLifetime=Phaser.Math.RND.pick(this.lifetime),this.curLifetime}},{key:"updateCurMoveAngle",value:function(){return this.curMoveAngle=Phaser.Math.RND.pick(this.random_move_angles),this.curMoveAngle}},{key:"updateCurMovDelay",value:function(){return this.curMoveDelay=Phaser.Math.RND.pick(this.random_move_delay),this.curMoveDelay}},{key:"updateCurWaitBeforeFirstShot",value:function(){return this.curWaitBeforeFirstShot=Phaser.Math.RND.pick(this.wait_before_first_shot),this.curWaitBeforeFirstShot}},{key:"updateCurShotDelay",value:function(){return this.curShotDelay=Phaser.Math.RND.pick(this.shot_delay),this.curShotDelay}},{key:"updateCurVars",value:function(){this.curHP=this.hp,this.velocity={x:0,y:0},this.ice=null,this.isFreeze=!1,this.updateCurSpeed(),this.updateCurLifetime(),this.updateCurMoveAngle(),this.updateCurMovDelay(),this.updateCurWaitBeforeFirstShot(),this.updateCurShotDelay(),this.timerMoveDelay&&this.timerMoveDelay.remove(),this.timerWaitBeforeFirstShot&&this.timerWaitBeforeFirstShot.remove(),this.timerShotDelay&&this.timerShotDelay.remove()}},{key:"set_skin",value:function(e){return void 0!==e&&""!==e&&(this.skin=e),null===this.skinGO?(this.skinGO=this.scene.add.sprite(0,0,this.skin),this.add(this.skinGO)):this.skinGO.setTexture(this.skin),this.skinGO.play(this.skin),this.skinGO.setOrigin(.5),this}},{key:"set_size",value:function(e){return null!==this.skinGO&&(this.setScale(e),this.size=e),this}},{key:"set_collider",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.collider,t=e.shape;if("string"==typeof t)if("circle"===t){var s=e.radius;this.body.setCircle(s,this.displayOriginX-s,this.displayOriginY-s),this.padding=1*s}else"rectangle"===t&&(this.body.setSize(e.width,e.height),this.body.setOffset(e.offset_x,e.offset_y))}},{key:"set_speed",value:function(e){return this.speed=e,this.body.setMaxSpeed(Phaser.Math.RND.pick(this.speed)),this}},{key:"set_lifetime",value:function(e){return this.lifetime=e,this}},{key:"set_random_move_angles",value:function(e){return this.random_move_angles=e,this}},{key:"set_random_move_delay",value:function(e){return this.random_move_delay=e,this}},{key:"set_wait_before_first_shot",value:function(e){return this.wait_before_first_shot=e,this}},{key:"set_is_use_bullet_type",value:function(e){return this.is_use_bullet_type=e,this}},{key:"set_bullet_skin",value:function(e){return this.bullet_skin=e,this}},{key:"set_bullet_speed",value:function(e){return this.bullet_speed=e,this}},{key:"set_bullet_lifetime",value:function(e){return this.bullet_lifetime=e,this}},{key:"set_bullet_power",value:function(e){return this.bullet_power=e,this}},{key:"set_shot_delay",value:function(e){return this.shot_delay=e,this}},{key:"set_score",value:function(e){return this.score=e,this}},{key:"set_is_player_target",value:function(e){return this.is_player_target=e,this}},{key:"set_is_asteroid_target",value:function(e){return this.is_asteroid_target=e,this}},{key:"set_accuracy",value:function(e){return this.accuracy=e,this}},{key:"set_accuracy_angles_range",value:function(e){return this.accuracy_angles_range=e,this}},{key:"set_is_dies_by_collision",value:function(e){return this.is_dies_by_asteroids=e,this.overlapEnemiesAsteroids.active=this.is_dies_by_asteroids,this}},{key:"set_is_die_outside",value:function(e){return this.is_die_outside=e,this}},{key:"set_hp",value:function(e){return this.hp=e,this}},{key:"set_is_jerk",value:function(e){return this.is_jerk=e,this}},{key:"set_jerk_dist",value:function(e){return this.jerk_dist=e,this}},{key:"set_jerk_wait",value:function(e){return this.jerk_wait=e,this}},{key:"set_is_loot_powerups",value:function(e){return this.is_loot_powerups=e,this}},{key:"set_loot_chances",value:function(e){return this.loot_chances=e,this}},{key:"set_spawned_powerups",value:function(e){return this.looted_powerups=e,this}},{key:"readConfig",value:function(e){return this.set_skin(g(e,"skin",this.skin).value),this.set_size(g(e,"size",this.size).value),this.set_speed(g(e,"speed",this.speed).value),this.set_lifetime(g(e,"lifetime",this.lifetime).value),this.set_random_move_angles(g(e,"random_move_angles",this.random_move_angles).value),this.set_random_move_delay(g(e,"random_move_delay",this.random_move_delay).value),this.set_wait_before_first_shot(g(e,"wait_before_first_shot",this.wait_before_first_shot).value),this.set_is_use_bullet_type(g(e,"is_use_bullet_type",this.is_use_bullet_type).value),this.set_bullet_skin(g(e,"bullet_skin",this.bullet_skin).value),this.set_bullet_speed(g(e,"bullet_speed",this.bullet_speed).value),this.set_bullet_lifetime(g(e,"bullet_lifetime",this.bullet_lifetime).value),this.set_bullet_power(g(e,"bullet_power",this.bullet_power).value),this.set_shot_delay(g(e,"shot_delay",this.shot_delay).value),this.set_score(g(e,"score",this.score).value),this.set_is_player_target(g(e,"is_player_target",this.is_player_target).value),this.set_is_asteroid_target(g(e,"is_asteroid_target",this.is_asteroid_target).value),this.set_accuracy(g(e,"accuracy",this.accuracy).value),this.set_accuracy_angles_range(g(e,"accuracy_angles_range",this.accuracy_angles_range).value),this.set_is_dies_by_collision(g(e,"is_dies_by_asteroids",this.is_dies_by_asteroids).value),this.set_is_die_outside(g(e,"is_die_outside",this.is_die_outside).value),this.set_hp(g(e,"hp",this.hp).value),this.set_is_jerk(g(e,"is_jerk",this.is_jerk).value),this.set_jerk_dist(g(e,"jerk_dist",this.jerk_dist).value),this.set_jerk_wait(g(e,"jerk_wait",this.jerk_wait).value),this.set_is_loot_powerups(g(e,"is_loot_powerups",this.is_loot_powerups).value),this.set_loot_chances(g(e,"loot_chances",this.loot_chances).value),this.set_spawned_powerups(g(e,"looted_powerups",this.looted_powerups).value),this.set_collider(g(e,"collider",this.collider).value),this}},{key:"readConfigByType",value:function(e){var t=this.units.hasOwnProperty(e)?this.units[e]:this.config;this.readConfig(t)}}])&&ae(s.prototype,i),n&&ae(s,n),t}();function ce(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),s.push.apply(s,i)}return s}function pe(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}function de(e,t){for(var s=0;s<t.length;s++){var i=t[s];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var fe=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.scene=t,this.options={},this.ships=[]}var t,s,i;return t=e,(s=[{key:"createPlayers",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"ship_classic";this.ships=[];var s=null;return 1===e?(s=this.createShip({x:.5,y:.5,id:0,type:t}))&&this.ships.push(s):((s=this.createShip({x:.4,y:.5,id:0,type:t}))&&this.ships.push(s),(s=this.createShip({x:.6,y:.5,id:1,type:t}))&&this.ships.push(s)),this.ships}},{key:"createShip",value:function(e){this.options=function(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?ce(s,!0).forEach(function(t){pe(e,t,s[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):ce(s).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))})}return e}({},{x:0,y:0,type:"ship_classic",id:0},{},e);var t=this.scene.shipsGroup.get();if(t){var s=this.options.x;s<=1&&s>0&&(s=Math.round(this.scene.game.config.width*s));var i=this.options.y;return i<=1&&i>0&&(i=Math.round(this.scene.game.config.height*i)),t.resetPosition(s,i),t.resetShip(),t.firstInvulnerability(),t.type=this.options.type,t.readConfigByType(t.type),t.applyPowerups(),t.set_id(this.options.id),t.setDepth(10),t}return!1}},{key:"resetPosition",value:function(e){this.scene.shipsGroup.getChildren().forEach(function(e){e.resetPosition()})}},{key:"rechargeShield",value:function(e){this.scene.shipsGroup.getChildren().forEach(function(e){e.rechargeShield()})}},{key:"resetMoveKeys",value:function(){this.scene.shipsGroup.getChildren().forEach(function(e){e.resetMoveKeys()})}},{key:"resetThrusters",value:function(){this.scene.shipsGroup.getChildren().forEach(function(e){e.soundThrust.stop()})}},{key:"startPowerupsRemain",value:function(){this.scene.shipsGroup.getChildren().forEach(function(e){e.is_powerups_remain=!1,e.active&&(e.is_powerups_remain=!0)})}},{key:"pausePowerupsRemain",value:function(){this.scene.shipsGroup.getChildren().forEach(function(e){e.is_powerups_remain=!1})}},{key:"reset",value:function(){this.scene.shipsGroup.getChildren().forEach(function(e){e.timerBlink&&e.timerBlink.remove(),e.isBlink=!1,e.hide(!0),e.timerShipExplode&&e.timerShipExplode.remove()})}}])&&de(t.prototype,s),i&&de(t,i),e}();function ye(e){return(ye="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function me(e,t){for(var s=0;s<t.length;s++){var i=t[s];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function ve(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _e(e,t,s){return(_e="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,s){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=ge(e)););return e}(e,t);if(i){var n=Object.getOwnPropertyDescriptor(i,t);return n.get?n.get.call(s):n.value}})(e,t,s||e)}function ge(e){return(ge=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function be(e,t){return(be=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var we=function(e){function t(e,s,i){var n,r,a;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),r=this,(n=!(a=ge(t).call(this,e,s,i))||"object"!==ye(a)&&"function"!=typeof a?ve(r):a).scene=e,n.scene.add.existing(ve(n)),n.ship=null,n.type="",n.origin={x:.5,y:.5},n.enable=!1,n.is_blink=!1,n.lifetime=0,n.blinktime=0,n.deadTime=0,n.timeRemain=0,n.blink_state=!1,n.blinkOnTime=100,n.blinkOffTime=100,n.timerStertBlink=null,n.blink=new E(n.scene,ve(n)),n.skin="ship_triple_shot_guns",n.scene.anims.create({key:n.skin,frames:[{key:"atlas_objects",frame:"powerups/ship_triple_shot_guns.png"}],frameRate:0,repeat:0}),n.scene.anims.create({key:"blast_radius",frames:[{key:"atlas_objects",frame:"powerups/ship_blast_radius_triple_shot_guns.png"}],frameRate:0,repeat:0}),n.set_origin(),n}var s,i,n;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&be(e,t)}(t,Phaser.GameObjects.Sprite),s=t,(i=[{key:"start",value:function(){this.blink.stop(),this.play(this.skin),this.ship.setDoubleShot(!0,this.scene.powerupManager.doubleShot.double_shot_dist),this.show()}},{key:"stop",value:function(){this.blink.stop(),this.ship.setDoubleShot(!1),this.hide()}},{key:"show",value:function(){this.is_blink=!1,this.enable=!0,this.setActive(!0),this.setVisible(!0),this.setAlpha(1)}},{key:"hide",value:function(){this.is_blink=!1,this.enable=!1,this.setActive(!1),this.setVisible(!1)}},{key:"preUpdate",value:function(e,s){_e(ge(t.prototype),"preUpdate",this).call(this,e,s),this.enable&&(this.timeRemain-=s*this.scene.time.timeScale)}},{key:"set_collider",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.collider,t=e.shape;if("string"==typeof t)if("circle"===t){var s=e.radius;this.body.setCircle(s,this.displayOriginX-s,this.displayOriginY-s)}else"rectangle"===t&&(this.body.setSize(e.width,e.height),this.body.setOffset(e.offset_x,e.offset_y))}},{key:"set_origin",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.origin;return this.origin=e,this.setOrigin(this.origin.x,this.origin.y),this}}])&&me(s.prototype,i),n&&me(s,n),t}();function ke(e,t){for(var s=0;s<t.length;s++){var i=t[s];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var Oe=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.scene=t,this.category="powerups",this.type="double_shot",this.units=Phaser.GLOBALS.units_waves[this.category].units,this.double_shot_dist=20,this.lifetime=3e4,this.blinktime=1e4,this.addCount=1,this.spriteGroup=this.scene.add.group({classType:we,maxSize:2,runChildUpdate:!0,active:!1,visible:!1}),this.readConfigByType(this.type),b.addEditorEmmiter.call(this,function(e){})}var t,s,i;return t=e,(s=[{key:"apply",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{add:null,lifetime:null,blinktime:null};if(e){var s=null===t.add||void 0===t.add?this.addCount:t.add,i=null;e.powerups.hasOwnProperty(this.type)||(e.powerups[this.type]={}),e.powerups[this.type].hasOwnProperty("count")||(e.powerups[this.type].count=0),s&&(e.powerups[this.type].count+=s),e.powerups[this.type].hasOwnProperty("go")||(e.powerups[this.type].go=null),null===e.powerups[this.type].go?(i=this.spriteGroup.get(),e.powerups[this.type].go=i,e.add(i),i.setZ(0),e.sort("z"),e.gunGO&&e.gunGO.setVisible(!1)):i=e.powerups[this.type].go,i.type=this.type,i.ship=e,i.start()}}},{key:"reset",value:function(){this.spriteGroup.getChildren().forEach(function(e){e.stop()})}},{key:"set_double_shot_dist",value:function(e){var t=this;return this.double_shot_dist=e,this.scene.ships.forEach(function(e){e.doubleShotDist=t.double_shot_dist}),e}},{key:"readConfig",value:function(e){return this.set_double_shot_dist(g(e,"double_shot_dist",this.double_shot_dist).value),this}},{key:"readConfigByType",value:function(e){var t=this.units.hasOwnProperty(e)?this.units[e]:{};this.readConfig(t)}}])&&ke(t.prototype,s),i&&ke(t,i),e}();function Se(e){return(Se="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Pe(e,t){for(var s=0;s<t.length;s++){var i=t[s];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function Me(e){return(Me=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function xe(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Te(e,t){return(Te=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Ce=function(e){function t(e,s,i){var n,r,a;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),r=this,(n=!(a=Me(t).call(this,e,s,i))||"object"!==Se(a)&&"function"!=typeof a?xe(r):a).scene=e,n.scene.add.existing(xe(n)),n.ship=null,n.type="",n.origin={x:.5,y:.5},n.enable=!1,n.is_blink=!1,n.lifetime=0,n.blinktime=0,n.deadTime=0,n.timeRemain=0,n.blink_state=!1,n.blinkOnTime=100,n.blinkOffTime=100,n.timerStertBlink=null,n.blink=new E(n.scene,xe(n)),n.skin="ship_triple_shot_guns",n.scene.anims.create({key:n.skin,frames:[{key:"atlas_objects",frame:"powerups/ship_triple_shot_guns.png"}],frameRate:0,repeat:0}),n.scene.anims.create({key:"blast_radius",frames:[{key:"atlas_objects",frame:"powerups/ship_blast_radius_triple_shot_guns.png"}],frameRate:0,repeat:0}),n.set_origin(),n}var s,i,n;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Te(e,t)}(t,Phaser.GameObjects.Sprite),s=t,(i=[{key:"start",value:function(){this.blink.stop(),this.play(this.skin),this.ship.setTripleShot(!0,this.scene.powerupManager.tripleShot.triple_shot_angle),this.show()}},{key:"stop",value:function(){this.blink.stop(),this.ship.setTripleShot(!1),this.hide()}},{key:"show",value:function(){this.is_blink=!1,this.enable=!0,this.setActive(!0),this.setVisible(!0),this.setAlpha(1)}},{key:"hide",value:function(){this.is_blink=!1,this.enable=!1,this.setActive(!1),this.setVisible(!1)}},{key:"set_collider",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.collider,t=e.shape;if("string"==typeof t)if("circle"===t){var s=e.radius;this.body.setCircle(s,this.displayOriginX-s,this.displayOriginY-s)}else"rectangle"===t&&(this.body.setSize(e.width,e.height),this.body.setOffset(e.offset_x,e.offset_y))}},{key:"set_origin",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.origin;return this.origin=e,this.setOrigin(this.origin.x,this.origin.y),this}}])&&Pe(s.prototype,i),n&&Pe(s,n),t}();function Ee(e,t){for(var s=0;s<t.length;s++){var i=t[s];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var Ae=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.scene=t,this.category="powerups",this.type="triple_shot",this.units=Phaser.GLOBALS.units_waves[this.category].units,this.triple_shot_angle=15,this.lifetime=3e4,this.blinktime=1e4,this.addCount=1,this.spriteGroup=this.scene.add.group({classType:Ce,maxSize:2,runChildUpdate:!0,active:!1,visible:!1}),this.readConfigByType(this.type),b.addEditorEmmiter.call(this,function(e){})}var t,s,i;return t=e,(s=[{key:"apply",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{add:null,lifetime:null,blinktime:null};if(e){var s=null===t.add||void 0===t.add?this.addCount:t.add,i=null;e.powerups.hasOwnProperty(this.type)||(e.powerups[this.type]={}),e.powerups[this.type].hasOwnProperty("count")||(e.powerups[this.type].count=0),s&&(e.powerups[this.type].count+=s),e.powerups[this.type].hasOwnProperty("go")||(e.powerups[this.type].go=null),null===e.powerups[this.type].go?(i=this.spriteGroup.get(),e.powerups[this.type].go=i,e.add(i),i.setZ(0),e.sort("z"),e.gunGO&&e.gunGO.setVisible(!0)):i=e.powerups[this.type].go,i.type=this.type,i.ship=e,i.start()}}},{key:"reset",value:function(){this.spriteGroup.getChildren().forEach(function(e){e.stop()})}},{key:"set_triple_shot_angle",value:function(e){var t=this;return this.triple_shot_angle=e,this.scene.ships.forEach(function(e){e.tripleShotRot=Phaser.Math.DegToRad(t.triple_shot_angle)}),e}},{key:"readConfig",value:function(e){return this.set_triple_shot_angle(g(e,"triple_shot_angle",this.triple_shot_angle).value),this}},{key:"readConfigByType",value:function(e){var t=this.units.hasOwnProperty(e)?this.units[e]:{};this.readConfig(t)}}])&&Ee(t.prototype,s),i&&Ee(t,i),e}();function je(e){return(je="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Be(e,t){for(var s=0;s<t.length;s++){var i=t[s];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function De(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Re(e,t,s){return(Re="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,s){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Ge(e)););return e}(e,t);if(i){var n=Object.getOwnPropertyDescriptor(i,t);return n.get?n.get.call(s):n.value}})(e,t,s||e)}function Ge(e){return(Ge=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Ie(e,t){return(Ie=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Le=function(e){function t(e,s,i){var n,r,a;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),r=this,(n=!(a=Ge(t).call(this,e,s,i))||"object"!==je(a)&&"function"!=typeof a?De(r):a).scene=e,n.scene.add.existing(De(n)),n.ship=null,n.type="",n.origin={x:.5,y:.5},n.enable=!1,n.is_blink=!1,n.lifetime=0,n.blinktime=0,n.deadTime=0,n.timeRemain=0,n.blink_state=!1,n.blinkOnTime=100,n.blinkOffTime=100,n.timerStertBlink=null,n.blink=new E(n.scene,De(n)),n.skin="ship_quadruple_gun",n.skin2="ship_triple_shot_guns",n.scene.anims.create({key:n.skin,frames:[{key:"atlas_objects",frame:"powerups/ship_quadruple_gun.png"}],frameRate:0,repeat:0}),n.scene.anims.create({key:n.skin2,frames:[{key:"atlas_objects",frame:"powerups/ship_triple_shot_guns.png"}],frameRate:0,repeat:0}),n.scene.anims.create({key:"blast_radius",frames:[{key:"atlas_objects",frame:"powerups/ship_blast_radius_quadruple_gun.png"}],frameRate:0,repeat:0}),n.scene.anims.create({key:"blast_radius2",frames:[{key:"atlas_objects",frame:"powerups/ship_blast_radius_triple_shot_guns.png"}],frameRate:0,repeat:0}),n.set_origin(),n}var s,i,n;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Ie(e,t)}(t,Phaser.GameObjects.Sprite),s=t,(i=[{key:"start",value:function(){this.blink.stop(),this.play(this.skin),this.ship.setQuadrupleShot(!0),this.show()}},{key:"stop",value:function(){this.blink.stop(),this.ship.setQuadrupleShot(!1),this.hide()}},{key:"show",value:function(){this.is_blink=!1,this.enable=!0,this.setActive(!0),this.setVisible(!0),this.setAlpha(1)}},{key:"hide",value:function(){this.is_blink=!1,this.enable=!1,this.setActive(!1),this.setVisible(!1)}},{key:"preUpdate",value:function(e,s){Re(Ge(t.prototype),"preUpdate",this).call(this,e,s),this.enable&&(this.timeRemain-=s*this.scene.time.timeScale)}},{key:"set_collider",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.collider,t=e.shape;if("string"==typeof t)if("circle"===t){var s=e.radius;this.body.setCircle(s,this.displayOriginX-s,this.displayOriginY-s)}else"rectangle"===t&&(this.body.setSize(e.width,e.height),this.body.setOffset(e.offset_x,e.offset_y))}},{key:"set_origin",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.origin;return this.origin=e,this.setOrigin(this.origin.x,this.origin.y),this}}])&&Be(s.prototype,i),n&&Be(s,n),t}();function ze(e,t){for(var s=0;s<t.length;s++){var i=t[s];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var Ve=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.scene=t,this.category="powerups",this.type="quadruple_shot",this.units=Phaser.GLOBALS.units_waves[this.category].units,this.lifetime=3e4,this.blinktime=1e4,this.addCount=1,this.spriteGroup=this.scene.add.group({classType:Le,maxSize:4,runChildUpdate:!0,active:!1,visible:!1}),b.addEditorEmmiter.call(this,function(e){})}var t,s,i;return t=e,(s=[{key:"apply",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{add:null,lifetime:null,blinktime:null};if(e){var s=null===t.add||void 0===t.add?this.addCount:t.add,i=null,n=null;e.powerups.hasOwnProperty(this.type)||(e.powerups[this.type]={}),e.powerups[this.type].hasOwnProperty("count")||(e.powerups[this.type].count=0),s&&(e.powerups[this.type].count+=s),e.powerups[this.type].hasOwnProperty("go")||(e.powerups[this.type].go=null),e.powerups[this.type].hasOwnProperty("go2")||(e.powerups[this.type].go2=null),null===e.powerups[this.type].go?(i=this.spriteGroup.get(),e.powerups[this.type].go=i,e.add(i),i.setZ(2),e.sort("z"),e.gunGO&&e.gunGO.setVisible(!0)):i=e.powerups[this.type].go,i.type=this.type,i.ship=e,null===e.powerups[this.type].go2?(n=this.spriteGroup.get(),e.powerups[this.type].go2=n,e.add(n),n.setZ(0),e.sort("z"),e.gunGO&&e.gunGO.setVisible(!0)):n=e.powerups[this.type].go2,n.type=this.type,n.ship=e,i.start(),n.show()}}},{key:"reset",value:function(){this.spriteGroup.getChildren().forEach(function(e){e.stop()})}}])&&ze(t.prototype,s),i&&ze(t,i),e}();function Ue(e){return(Ue="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Fe(e,t){for(var s=0;s<t.length;s++){var i=t[s];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function He(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Ne(e,t,s){return(Ne="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,s){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=We(e)););return e}(e,t);if(i){var n=Object.getOwnPropertyDescriptor(i,t);return n.get?n.get.call(s):n.value}})(e,t,s||e)}function We(e){return(We=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Ke(e,t){return(Ke=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Qe=function(e){function t(e,s,i){var n,r,a;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),r=this,(n=!(a=We(t).call(this,e,s,i))||"object"!==Ue(a)&&"function"!=typeof a?He(r):a).scene=e,n.scene.add.existing(He(n)),n.ship=null,n.type="",n.origin={x:.5,y:.5},n.enable=!1,n.is_blink=!1,n.lifetime=0,n.blinktime=0,n.deadTime=0,n.timeRemain=0,n.blink_state=!1,n.blinkOnTime=100,n.blinkOffTime=100,n.timerStertBlink=null,n.blink=new E(n.scene,He(n)),n.skin="ship_quadruple_gun",n.scene.anims.create({key:n.skin,frames:[{key:"atlas_objects",frame:"powerups/ship_quadruple_gun.png"}],frameRate:0,repeat:0}),n.scene.anims.create({key:"blast_radius",frames:[{key:"atlas_objects",frame:"powerups/ship_blast_radius_quadruple_gun.png"}],frameRate:0,repeat:0}),n.set_origin(),n}var s,i,n;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Ke(e,t)}(t,Phaser.GameObjects.Sprite),s=t,(i=[{key:"start",value:function(){this.blink.stop(),this.play(this.skin),this.ship.setBackShot(!0),this.show()}},{key:"stop",value:function(){this.blink.stop(),this.ship.setBackShot(!1),this.hide()}},{key:"show",value:function(){this.is_blink=!1,this.enable=!0,this.setActive(!0),this.setVisible(!0),this.setAlpha(1)}},{key:"hide",value:function(){this.is_blink=!1,this.enable=!1,this.setActive(!1),this.setVisible(!1)}},{key:"preUpdate",value:function(e,s){Ne(We(t.prototype),"preUpdate",this).call(this,e,s),this.enable&&(this.timeRemain-=s*this.scene.time.timeScale)}},{key:"set_collider",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.collider,t=e.shape;if("string"==typeof t)if("circle"===t){var s=e.radius;this.body.setCircle(s,this.displayOriginX-s,this.displayOriginY-s)}else"rectangle"===t&&(this.body.setSize(e.width,e.height),this.body.setOffset(e.offset_x,e.offset_y))}},{key:"set_origin",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.origin;return this.origin=e,this.setOrigin(this.origin.x,this.origin.y),this}}])&&Fe(s.prototype,i),n&&Fe(s,n),t}();function Ye(e,t){for(var s=0;s<t.length;s++){var i=t[s];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var Xe=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.scene=t,this.category="powerups",this.type="back_shot",this.units=Phaser.GLOBALS.units_waves[this.category].units,this.lifetime=3e4,this.blinktime=1e4,this.addCount=1,this.spriteGroup=this.scene.add.group({classType:Qe,maxSize:4,runChildUpdate:!0,active:!1,visible:!1}),b.addEditorEmmiter.call(this,function(e){})}var t,s,i;return t=e,(s=[{key:"apply",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{add:null,lifetime:null,blinktime:null};if(e){var s=null===t.add||void 0===t.add?this.addCount:t.add,i=null;e.powerups.hasOwnProperty(this.type)||(e.powerups[this.type]={}),e.powerups[this.type].hasOwnProperty("count")||(e.powerups[this.type].count=0),s&&(e.powerups[this.type].count+=s),e.powerups[this.type].hasOwnProperty("go")||(e.powerups[this.type].go=null),null===e.powerups[this.type].go?(i=this.spriteGroup.get(),e.powerups[this.type].go=i,e.add(i),i.setZ(2),e.sort("z"),e.gunGO&&e.gunGO.setVisible(!0)):i=e.powerups[this.type].go,i.type=this.type,i.ship=e,i.start()}}},{key:"reset",value:function(){this.spriteGroup.getChildren().forEach(function(e){e.stop()})}}])&&Ye(t.prototype,s),i&&Ye(t,i),e}();function Je(e){return(Je="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Ze(e,t){for(var s=0;s<t.length;s++){var i=t[s];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function qe(e){return(qe=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function $e(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function et(e,t){return(et=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var tt=function(e){function t(e,s,i){var n,r,a;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),r=this,(n=!(a=qe(t).call(this,e,s,i))||"object"!==Je(a)&&"function"!=typeof a?$e(r):a).scene=e,n.scene.add.existing($e(n)),n.ship=null,n.type="",n.origin={x:.5,y:.5},n.lvl=0,n}var s,i,n;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&et(e,t)}(t,Phaser.GameObjects.Image),s=t,(i=[{key:"start",value:function(){this.ship.setThrusters(this.lvl),this.show()}},{key:"stop",value:function(){this.lvl=0,this.ship.setThrusters(this.lvl),this.hide()}},{key:"show",value:function(){this.setActive(!0),this.setVisible(!0),this.setAlpha(1)}},{key:"hide",value:function(){this.setActive(!1),this.setVisible(!1)}}])&&Ze(s.prototype,i),n&&Ze(s,n),t}();function st(e,t){for(var s=0;s<t.length;s++){var i=t[s];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var it=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.scene=t,this.category="powerups",this.type="thrusters",this.units=Phaser.GLOBALS.units_waves[this.category].units,this.acceleration_percent=20,this.spriteGroup=this.scene.add.group({classType:tt,maxSize:2,runChildUpdate:!1,active:!1,visible:!1}),this.readConfigByType(this.type),b.addEditorEmmiter.call(this,function(e){})}var t,s,i;return t=e,(s=[{key:"apply",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{add:null,lvl:0};if(e){var s=null===t.add||void 0===t.add?1:t.add,i=null;e.powerups.hasOwnProperty(this.type)||(e.powerups[this.type]={}),e.powerups[this.type].hasOwnProperty("count")||(e.powerups[this.type].count=0),s&&(e.powerups[this.type].count+=s),e.powerups[this.type].hasOwnProperty("go")||(e.powerups[this.type].go=null),e.powerups[this.type].hasOwnProperty("lvl")||(e.powerups[this.type].lvl=0),e.powerups[this.type].lvl=t.lvl,null===e.powerups[this.type].go?(i=this.spriteGroup.get(),e.powerups[this.type].go=i,e.add(i)):i=e.powerups[this.type].go,i.lvl=e.powerups[this.type].lvl,i.type=this.type,i.ship=e,i.start()}}},{key:"reset",value:function(){this.spriteGroup.getChildren().forEach(function(e){e.stop()})}},{key:"set_acceleration_percent",value:function(e){return this.acceleration_percent=e,this.scene.ships.forEach(function(e){e.setThrusters()}),e}},{key:"readConfig",value:function(e){return this.set_acceleration_percent(g(e,"acceleration_percent",this.acceleration_percent).value),this}},{key:"readConfigByType",value:function(e){var t=this.units.hasOwnProperty(e)?this.units[e]:{};this.readConfig(t)}}])&&st(t.prototype,s),i&&st(t,i),e}();function nt(e){return(nt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function rt(e,t){for(var s=0;s<t.length;s++){var i=t[s];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function at(e){return(at=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function ot(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function ht(e,t){return(ht=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var lt=function(e){function t(e,s,i){var n,r,a;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),r=this,(n=!(a=at(t).call(this,e,s,i))||"object"!==nt(a)&&"function"!=typeof a?ot(r):a).scene=e,n.scene.add.existing(ot(n)),n.ship=null,n.type="",n.origin={x:.5,y:.5},n.lvl=0,n}var s,i,n;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ht(e,t)}(t,Phaser.GameObjects.Image),s=t,(i=[{key:"start",value:function(){this.ship.setReverseThrusters(this.lvl),this.show()}},{key:"stop",value:function(){this.lvl=0,this.ship.setReverseThrusters(this.lvl),this.hide()}},{key:"show",value:function(){this.setActive(!0),this.setVisible(!0),this.setAlpha(1)}},{key:"hide",value:function(){this.setActive(!1),this.setVisible(!1)}}])&&rt(s.prototype,i),n&&rt(s,n),t}();function ut(e,t){for(var s=0;s<t.length;s++){var i=t[s];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var ct=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.scene=t,this.category="powerups",this.type="reverse_thrusters",this.units=Phaser.GLOBALS.units_waves[this.category].units,this.acceleration=200,this.acceleration_percent=10,this.spriteGroup=this.scene.add.group({classType:lt,maxSize:2,runChildUpdate:!1,active:!1,visible:!1}),this.readConfigByType(this.type),b.addEditorEmmiter.call(this,function(e){})}var t,s,i;return t=e,(s=[{key:"apply",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{add:null,lvl:0};if(e){var s=null===t.add||void 0===t.add?1:t.add,i=null;e.powerups.hasOwnProperty(this.type)||(e.powerups[this.type]={}),e.powerups[this.type].hasOwnProperty("count")||(e.powerups[this.type].count=0),s&&(e.powerups[this.type].count+=s),e.powerups[this.type].hasOwnProperty("go")||(e.powerups[this.type].go=null),e.powerups[this.type].hasOwnProperty("lvl")||(e.powerups[this.type].lvl=0),e.powerups[this.type].lvl=t.lvl,null===e.powerups[this.type].go?(i=this.spriteGroup.get(),e.powerups[this.type].go=i,e.add(i)):i=e.powerups[this.type].go,i.lvl=e.powerups[this.type].lvl,i.type=this.type,i.ship=e,i.start(),this.scene.mobileJoystick&&this.scene.mobileJoystick.setReverseEnabled(!0)}}},{key:"reset",value:function(){this.spriteGroup.getChildren().forEach(function(e){e.stop()}),this.scene.mobileJoystick&&this.scene.mobileJoystick.setReverseEnabled(!1)}},{key:"set_acceleration",value:function(e){return this.acceleration=e,this.scene.ships.forEach(function(e){e.setReverseThrusters()}),e}},{key:"set_acceleration_percent",value:function(e){return this.acceleration_percent=e,this.scene.ships.forEach(function(e){e.setReverseThrusters()}),e}},{key:"readConfig",value:function(e){return this.set_acceleration(g(e,"acceleration",this.acceleration).value),this.set_acceleration_percent(g(e,"acceleration_percent",this.acceleration_percent).value),this}},{key:"readConfigByType",value:function(e){var t=this.units.hasOwnProperty(e)?this.units[e]:{};this.readConfig(t)}}])&&ut(t.prototype,s),i&&ut(t,i),e}();function pt(e){return(pt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function dt(e,t){for(var s=0;s<t.length;s++){var i=t[s];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function ft(e){return(ft=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function yt(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function mt(e,t){return(mt=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var vt=function(e){function t(e,s,i){var n,r,a;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),r=this,(n=!(a=ft(t).call(this,e,s,i))||"object"!==pt(a)&&"function"!=typeof a?yt(r):a).scene=e,n.scene.add.existing(yt(n)),n.ship=null,n.type="",n.origin={x:.5,y:.5},n.lvl=0,n}var s,i,n;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&mt(e,t)}(t,Phaser.GameObjects.Image),s=t,(i=[{key:"start",value:function(){this.ship.setBrakes(this.lvl),this.show()}},{key:"stop",value:function(){this.lvl=0,this.ship.setBrakes(this.lvl),this.hide()}},{key:"show",value:function(){this.setActive(!0),this.setVisible(!0),this.setAlpha(1)}},{key:"hide",value:function(){this.setActive(!1),this.setVisible(!1)}}])&&dt(s.prototype,i),n&&dt(s,n),t}();function _t(e,t){for(var s=0;s<t.length;s++){var i=t[s];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var gt=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.scene=t,this.category="powerups",this.type="brakes",this.units=Phaser.GLOBALS.units_waves[this.category].units,this.slowdown_percent=20,this.spriteGroup=this.scene.add.group({classType:vt,maxSize:2,runChildUpdate:!1,active:!1,visible:!1}),this.readConfigByType(this.type),b.addEditorEmmiter.call(this,function(e){})}var t,s,i;return t=e,(s=[{key:"apply",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{add:null,lvl:0};if(e){var s=null===t.add||void 0===t.add?1:t.add,i=null;e.powerups.hasOwnProperty(this.type)||(e.powerups[this.type]={}),e.powerups[this.type].hasOwnProperty("count")||(e.powerups[this.type].count=0),s&&(e.powerups[this.type].count+=s),e.powerups[this.type].hasOwnProperty("go")||(e.powerups[this.type].go=null),e.powerups[this.type].hasOwnProperty("lvl")||(e.powerups[this.type].lvl=0),e.powerups[this.type].lvl=t.lvl,null===e.powerups[this.type].go?(i=this.spriteGroup.get(),e.powerups[this.type].go=i,e.add(i)):i=e.powerups[this.type].go,i.lvl=e.powerups[this.type].lvl,i.type=this.type,i.ship=e,i.start()}}},{key:"reset",value:function(){this.spriteGroup.getChildren().forEach(function(e){e.stop()})}},{key:"set_slowdown_percent",value:function(e){return this.slowdown_percent=e,this.scene.ships.forEach(function(e){e.setBrakes()}),e}},{key:"readConfig",value:function(e){return this.set_slowdown_percent(g(e,"slowdown_percent",this.slowdown_percent).value),this}},{key:"readConfigByType",value:function(e){var t=this.units.hasOwnProperty(e)?this.units[e]:{};this.readConfig(t)}}])&&_t(t.prototype,s),i&&_t(t,i),e}();function bt(e){return(bt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function wt(e,t){for(var s=0;s<t.length;s++){var i=t[s];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function kt(e){return(kt=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Ot(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function St(e,t){return(St=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Pt=function(e){function t(e,s,i){var n,r,a;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),r=this,(n=!(a=kt(t).call(this,e,s,i))||"object"!==bt(a)&&"function"!=typeof a?Ot(r):a).scene=e,n.scene.add.existing(Ot(n)),n.ship=null,n.type="",n.origin={x:.5,y:.5},n.lvl=0,n}var s,i,n;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&St(e,t)}(t,Phaser.GameObjects.Image),s=t,(i=[{key:"start",value:function(){this.ship.setFireRate(this.lvl),this.show()}},{key:"stop",value:function(){this.lvl=0,this.ship.setFireRate(this.lvl),this.hide()}},{key:"show",value:function(){this.setActive(!0),this.setVisible(!0),this.setAlpha(1)}},{key:"hide",value:function(){this.setActive(!1),this.setVisible(!1)}}])&&wt(s.prototype,i),n&&wt(s,n),t}();function Mt(e,t){for(var s=0;s<t.length;s++){var i=t[s];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var xt=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.scene=t,this.category="powerups",this.type="fire_rate",this.units=Phaser.GLOBALS.units_waves[this.category].units,this.shot_delay_percent=20,this.spriteGroup=this.scene.add.group({classType:Pt,maxSize:2,runChildUpdate:!1,active:!1,visible:!1}),this.readConfigByType(this.type),b.addEditorEmmiter.call(this,function(e){})}var t,s,i;return t=e,(s=[{key:"apply",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{add:null,lvl:0};if(e){var s=null===t.add||void 0===t.add?1:t.add,i=null;e.powerups.hasOwnProperty(this.type)||(e.powerups[this.type]={}),e.powerups[this.type].hasOwnProperty("count")||(e.powerups[this.type].count=0),s&&(e.powerups[this.type].count+=s),e.powerups[this.type].hasOwnProperty("go")||(e.powerups[this.type].go=null),e.powerups[this.type].hasOwnProperty("lvl")||(e.powerups[this.type].lvl=0),e.powerups[this.type].lvl=t.lvl,null===e.powerups[this.type].go?(i=this.spriteGroup.get(),e.powerups[this.type].go=i,e.add(i)):i=e.powerups[this.type].go,i.lvl=e.powerups[this.type].lvl,i.type=this.type,i.ship=e,i.start()}}},{key:"reset",value:function(){this.spriteGroup.getChildren().forEach(function(e){e.stop()})}},{key:"set_shot_delay_percent",value:function(e){return this.shot_delay_percent=e,this.scene.ships.forEach(function(e){e.setFireRate()}),e}},{key:"readConfig",value:function(e){return this.set_shot_delay_percent(g(e,"shot_delay_percent",this.shot_delay_percent).value),this}},{key:"readConfigByType",value:function(e){var t=this.units.hasOwnProperty(e)?this.units[e]:{};this.readConfig(t)}}])&&Mt(t.prototype,s),i&&Mt(t,i),e}();function Tt(e){return(Tt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Ct(e,t){for(var s=0;s<t.length;s++){var i=t[s];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function Et(e){return(Et=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function At(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function jt(e,t){return(jt=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Bt=function(e){function t(e,s,i){var n,r,a;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),r=this,(n=!(a=Et(t).call(this,e,s,i))||"object"!==Tt(a)&&"function"!=typeof a?At(r):a).scene=e,n.scene.add.existing(At(n)),n.ship=null,n.type="",n.origin={x:.5,y:.5},n.lvl=0,n}var s,i,n;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&jt(e,t)}(t,Phaser.GameObjects.Image),s=t,(i=[{key:"start",value:function(){this.ship.setShotDistance(this.lvl),this.show()}},{key:"stop",value:function(){this.lvl=0,this.ship.setShotDistance(this.lvl),this.hide()}},{key:"show",value:function(){this.setActive(!0),this.setVisible(!0),this.setAlpha(1)}},{key:"hide",value:function(){this.setActive(!1),this.setVisible(!1)}}])&&Ct(s.prototype,i),n&&Ct(s,n),t}();function Dt(e,t){for(var s=0;s<t.length;s++){var i=t[s];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var Rt=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.scene=t,this.category="powerups",this.type="shot_distance",this.units=Phaser.GLOBALS.units_waves[this.category].units,this.shot_delay_percent=20,this.spriteGroup=this.scene.add.group({classType:Bt,maxSize:2,runChildUpdate:!1,active:!1,visible:!1}),this.readConfigByType(this.type),b.addEditorEmmiter.call(this,function(e){})}var t,s,i;return t=e,(s=[{key:"apply",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{add:null,lvl:0};if(e){var s=null===t.add||void 0===t.add?1:t.add,i=null;e.powerups.hasOwnProperty(this.type)||(e.powerups[this.type]={}),e.powerups[this.type].hasOwnProperty("count")||(e.powerups[this.type].count=0),s&&(e.powerups[this.type].count+=s),e.powerups[this.type].hasOwnProperty("go")||(e.powerups[this.type].go=null),e.powerups[this.type].hasOwnProperty("lvl")||(e.powerups[this.type].lvl=0),e.powerups[this.type].lvl=t.lvl,null===e.powerups[this.type].go?(i=this.spriteGroup.get(),e.powerups[this.type].go=i,e.add(i)):i=e.powerups[this.type].go,i.lvl=e.powerups[this.type].lvl,i.type=this.type,i.ship=e,i.start()}}},{key:"reset",value:function(){this.spriteGroup.getChildren().forEach(function(e){e.stop()})}},{key:"set_shot_delay_percent",value:function(e){return this.shot_delay_percent=e,this.scene.ships.forEach(function(e){e.setFireRate()}),e}},{key:"readConfig",value:function(e){return this.set_shot_delay_percent(g(e,"shot_delay_percent",this.shot_delay_percent).value),this}},{key:"readConfigByType",value:function(e){var t=this.units.hasOwnProperty(e)?this.units[e]:{};this.readConfig(t)}}])&&Dt(t.prototype,s),i&&Dt(t,i),e}();function Gt(e){return(Gt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function It(e,t){for(var s=0;s<t.length;s++){var i=t[s];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function Lt(e){return(Lt=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function zt(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Vt(e,t){return(Vt=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Ut=function(e){function t(e,s,i){var n,r,a;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),r=this,(n=!(a=Lt(t).call(this,e,s,i))||"object"!==Gt(a)&&"function"!=typeof a?zt(r):a).scene=e,n.scene.add.existing(zt(n)),n.ship=null,n.type="",n.origin={x:.5,y:.5},n.lvl=0,n}var s,i,n;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Vt(e,t)}(t,Phaser.GameObjects.Image),s=t,(i=[{key:"start",value:function(){this.ship.setBulletSize(this.lvl),this.show()}},{key:"stop",value:function(){this.lvl=0,this.ship.setBulletSize(this.lvl),this.hide()}},{key:"show",value:function(){this.setActive(!0),this.setVisible(!0),this.setAlpha(1)}},{key:"hide",value:function(){this.setActive(!1),this.setVisible(!1)}}])&&It(s.prototype,i),n&&It(s,n),t}();function Ft(e,t){for(var s=0;s<t.length;s++){var i=t[s];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var Ht=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.scene=t,this.category="powerups",this.type="bullet_size",this.units=Phaser.GLOBALS.units_waves[this.category].units,this.size_percent=20,this.spriteGroup=this.scene.add.group({classType:Ut,maxSize:2,runChildUpdate:!1,active:!1,visible:!1}),this.readConfigByType(this.type),b.addEditorEmmiter.call(this,function(e){})}var t,s,i;return t=e,(s=[{key:"apply",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{add:null,lvl:0};if(e){var s=null===t.add||void 0===t.add?1:t.add,i=null;e.powerups.hasOwnProperty(this.type)||(e.powerups[this.type]={}),e.powerups[this.type].hasOwnProperty("count")||(e.powerups[this.type].count=0),s&&(e.powerups[this.type].count+=s),e.powerups[this.type].hasOwnProperty("go")||(e.powerups[this.type].go=null),e.powerups[this.type].hasOwnProperty("lvl")||(e.powerups[this.type].lvl=0),e.powerups[this.type].lvl=t.lvl,null===e.powerups[this.type].go?(i=this.spriteGroup.get(),e.powerups[this.type].go=i,e.add(i)):i=e.powerups[this.type].go,i.lvl=e.powerups[this.type].lvl,i.type=this.type,i.ship=e,i.start()}}},{key:"reset",value:function(){this.spriteGroup.getChildren().forEach(function(e){e.stop()})}},{key:"set_size_percent",value:function(e){return this.size_percent=e,this.scene.ships.forEach(function(e){e.setFireRate()}),e}},{key:"readConfig",value:function(e){return this.set_size_percent(g(e,"size_percent",this.size_percent).value),this}},{key:"readConfigByType",value:function(e){var t=this.units.hasOwnProperty(e)?this.units[e]:{};this.readConfig(t)}}])&&Ft(t.prototype,s),i&&Ft(t,i),e}();function Nt(e){return(Nt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Wt(e,t){for(var s=0;s<t.length;s++){var i=t[s];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function Kt(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Qt(e,t,s){return(Qt="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,s){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Yt(e)););return e}(e,t);if(i){var n=Object.getOwnPropertyDescriptor(i,t);return n.get?n.get.call(s):n.value}})(e,t,s||e)}function Yt(e){return(Yt=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Xt(e,t){return(Xt=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Jt=function(e){function t(e,s,i){var n,r,a;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),r=this,(n=!(a=Yt(t).call(this,e,s,i))||"object"!==Nt(a)&&"function"!=typeof a?Kt(r):a).scene=e,n.scene.add.existing(Kt(n)),n.ship=null,n.type="",n.origin={x:.5,y:.5},n.enable=!1,n.is_blink=!1,n.lifetime=0,n.blinktime=0,n.deadTime=0,n.timeRemain=0,n.blink_state=!1,n.blinkOnTime=100,n.blinkOffTime=100,n.timerStertBlink=null,n.blink=new E(n.scene,Kt(n)),n}var s,i,n;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Xt(e,t)}(t,Phaser.GameObjects.Sprite),s=t,(i=[{key:"start",value:function(){this.blink.stop(),this.ship.setFastAccelerate(!0,this.scene.powerupManager.fastAcceleration.acceleration_mult,this.scene.powerupManager.fastAcceleration.rotation_mult,this.scene.powerupManager.fastAcceleration.slowdown),this.show()}},{key:"stop",value:function(){this.blink.stop(),this.ship.setFastAccelerate(!1),this.hide()}},{key:"setTimeRemain",value:function(e){this.blink.flashFromTimeRemain(e,this.blinktime)}},{key:"show",value:function(){this.is_blink=!1,this.enable=!0,this.setActive(!0),this.setVisible(!0),this.setAlpha(1)}},{key:"hide",value:function(){this.is_blink=!1,this.enable=!1,this.setActive(!1),this.setVisible(!1)}},{key:"preUpdate",value:function(e,s){Qt(Yt(t.prototype),"preUpdate",this).call(this,e,s)}}])&&Wt(s.prototype,i),n&&Wt(s,n),t}();function Zt(e,t){for(var s=0;s<t.length;s++){var i=t[s];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var qt=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.scene=t,this.category="powerups",this.type="fast_acceleration",this.units=Phaser.GLOBALS.units_waves[this.category].units,this.acceleration_mult=3,this.rotation_mult=1.2,this.slowdown=.9,this.lifetime=3e4,this.blinktime=1e4,this.addCount=1,this.spriteGroup=this.scene.add.group({classType:Jt,maxSize:2,runChildUpdate:!0,active:!1,visible:!1}),this.readConfigByType(this.type),b.addEditorEmmiter.call(this,function(e){})}var t,s,i;return t=e,(s=[{key:"apply",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{add:null,lifetime:null,blinktime:null};if(e){var s=null===t.add||void 0===t.add?this.addCount:t.add;this.lifetime=t.lifetime||this.scene.powerupManager.powerup_lifetime,this.blinktime=t.blinktime||this.scene.powerupManager.powerup_blinktime;var i=null;e.powerups.hasOwnProperty(this.type)||(e.powerups[this.type]={}),e.powerups[this.type].hasOwnProperty("count")||(e.powerups[this.type].count=0),s&&(e.powerups[this.type].count+=s),e.powerups[this.type].hasOwnProperty("go")||(e.powerups[this.type].go=null),e.powerups[this.type].hasOwnProperty("uigo")||(e.powerups[this.type].uigo=null),e.powerups[this.type].hasOwnProperty("time_remain")||(e.powerups[this.type].time_remain=this.lifetime);var n=e.powerups[this.type].time_remain;if(null===e.powerups[this.type].go?(i=this.spriteGroup.get(),e.powerups[this.type].go=i,e.add(i)):i=e.powerups[this.type].go,i.timeRemain=n,i.lifetime=this.lifetime,i.blinktime=this.blinktime,i.deadTime=this.scene.time.now+i.timeRemain,i.type=this.type,i.ship=e,null===e.powerups[this.type].uigo)e.powerups[this.type].uigo=this.scene.powerupManager.addPowerupUI({player_id:e.playerID,type:this.type,count:e.powerups[this.type].count,lifetime:this.lifetime,time_remain:n});else{var r=e.powerups[this.type].uigo;r.setCount(e.powerups[this.type].count),r.setTimeRemain()}i.start()}}},{key:"reset",value:function(){this.spriteGroup.getChildren().forEach(function(e){e.stop()})}},{key:"set_acceleration_mult",value:function(e){var t=this;return this.acceleration_mult=e,this.scene.ships.forEach(function(e){e.fastAccelerationMult=t.acceleration_mult}),e}},{key:"set_rotation_mult",value:function(e){var t=this;return this.rotation_mult=e,this.scene.ships.forEach(function(e){e.fastAccelerationRotationMult=t.rotation_mult}),e}},{key:"set_slowdown",value:function(e){var t=this;return this.slowdown=e,this.scene.ships.forEach(function(e){e.fastAccelerationSlowdown=t.slowdown,e.set_slowdown(t.slowdown)}),e}},{key:"readConfig",value:function(e){return this.set_acceleration_mult(g(e,"acceleration_mult",this.acceleration_mult).value),this.set_rotation_mult(g(e,"rotation_mult",this.rotation_mult).value),this.set_slowdown(g(e,"slowdown",this.slowdown).value),this}},{key:"readConfigByType",value:function(e){var t=this.units.hasOwnProperty(e)?this.units[e]:{};this.readConfig(t)}}])&&Zt(t.prototype,s),i&&Zt(t,i),e}();function $t(e){return($t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function es(e,t){for(var s=0;s<t.length;s++){var i=t[s];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function ts(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function ss(e,t,s){return(ss="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,s){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=is(e)););return e}(e,t);if(i){var n=Object.getOwnPropertyDescriptor(i,t);return n.get?n.get.call(s):n.value}})(e,t,s||e)}function is(e){return(is=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function ns(e,t){return(ns=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var rs=function(e){function t(e,s,i){var n,r,a;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),r=this,(n=!(a=is(t).call(this,e,s,i))||"object"!==$t(a)&&"function"!=typeof a?ts(r):a).scene=e,n.scene.add.existing(ts(n)),n.ship=null,n.type="",n.origin={x:.5,y:.5},n.enable=!1,n.is_blink=!1,n.lifetime=0,n.blinktime=0,n.deadTime=0,n.timeRemain=0,n.blink_state=!1,n.blinkOnTime=100,n.blinkOffTime=100,n.timerStertBlink=null,n.blink=new E(n.scene,ts(n)),n}var s,i,n;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ns(e,t)}(t,Phaser.GameObjects.Sprite),s=t,(i=[{key:"start",value:function(){this.blink.stop(),this.ship.setFastShot(!0,this.scene.powerupManager.fastShot.shot_delay_mult),this.show()}},{key:"stop",value:function(){this.blink.stop(),this.ship.setFastShot(!1),this.hide()}},{key:"setTimeRemain",value:function(e){this.blink.flashFromTimeRemain(e,this.blinktime)}},{key:"show",value:function(){this.is_blink=!1,this.enable=!0,this.setActive(!0),this.setVisible(!0),this.setAlpha(1)}},{key:"hide",value:function(){this.is_blink=!1,this.enable=!1,this.setActive(!1),this.setVisible(!1)}},{key:"preUpdate",value:function(e,s){ss(is(t.prototype),"preUpdate",this).call(this,e,s)}}])&&es(s.prototype,i),n&&es(s,n),t}();function as(e,t){for(var s=0;s<t.length;s++){var i=t[s];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var os=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.scene=t,this.category="powerups",this.type="fast_shot",this.units=Phaser.GLOBALS.units_waves[this.category].units,this.shot_delay_mult=.7,this.lifetime=3e4,this.blinktime=1e4,this.addCount=1,this.spriteGroup=this.scene.add.group({classType:rs,maxSize:2,runChildUpdate:!0,active:!1,visible:!1}),this.readConfigByType(this.type),b.addEditorEmmiter.call(this,function(e){})}var t,s,i;return t=e,(s=[{key:"apply",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{add:null,lifetime:null,blinktime:null};if(e){var s=null===t.add||void 0===t.add?this.addCount:t.add;this.lifetime=t.lifetime||this.scene.powerupManager.powerup_lifetime,this.blinktime=t.blinktime||this.scene.powerupManager.powerup_blinktime;var i=null;e.powerups.hasOwnProperty(this.type)||(e.powerups[this.type]={}),e.powerups[this.type].hasOwnProperty("count")||(e.powerups[this.type].count=0),s&&(e.powerups[this.type].count+=s),e.powerups[this.type].hasOwnProperty("go")||(e.powerups[this.type].go=null),e.powerups[this.type].hasOwnProperty("uigo")||(e.powerups[this.type].uigo=null),e.powerups[this.type].hasOwnProperty("time_remain")||(e.powerups[this.type].time_remain=this.lifetime);var n=e.powerups[this.type].time_remain;if(null===e.powerups[this.type].go?(i=this.spriteGroup.get(),e.powerups[this.type].go=i,e.add(i)):i=e.powerups[this.type].go,i.timeRemain=n,i.lifetime=this.lifetime,i.blinktime=this.blinktime,i.deadTime=this.scene.time.now+i.timeRemain,i.type=this.type,i.ship=e,null===e.powerups[this.type].uigo)e.powerups[this.type].uigo=this.scene.powerupManager.addPowerupUI({player_id:e.playerID,type:this.type,count:e.powerups[this.type].count,lifetime:this.lifetime,time_remain:n});else{var r=e.powerups[this.type].uigo;r.setCount(e.powerups[this.type].count),r.setTimeRemain()}i.start()}}},{key:"reset",value:function(){this.spriteGroup.getChildren().forEach(function(e){e.stop()})}},{key:"set_shot_delay_mult",value:function(e){var t=this;return this.shot_delay_mult=e,this.scene.ships.forEach(function(e){e.fastShotDelayMult=t.shot_delay_mult}),e}},{key:"readConfig",value:function(e){return this.set_shot_delay_mult(g(e,"shot_delay_mult",this.shot_delay_mult).value),this}},{key:"readConfigByType",value:function(e){var t=this.units.hasOwnProperty(e)?this.units[e]:{};this.readConfig(t)}}])&&as(t.prototype,s),i&&as(t,i),e}();function hs(e){return(hs="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ls(e,t){for(var s=0;s<t.length;s++){var i=t[s];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function us(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function cs(e,t,s){return(cs="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,s){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=ps(e)););return e}(e,t);if(i){var n=Object.getOwnPropertyDescriptor(i,t);return n.get?n.get.call(s):n.value}})(e,t,s||e)}function ps(e){return(ps=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function ds(e,t){return(ds=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var fs=function(e){function t(e,s,i){var n,r,a;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),r=this,(n=!(a=ps(t).call(this,e,s,i))||"object"!==hs(a)&&"function"!=typeof a?us(r):a).scene=e,n.scene.add.existing(us(n)),n.scene.physics.add.existing(us(n)),n.ship=null,n.init_alpha=.4,n.collider={shape:"circle",radius:66,offset_x:0,offset_y:0},n.type="",n.origin={x:.5,y:.5},n.radius=1e3,n.is_explode_all=!0,n.power=1,n.enable=!1,n.is_blink=!1,n.lifetime=0,n.blinktime=0,n.deadTime=0,n.timeRemain=0,n.blink_state=!1,n.blink=new E(n.scene,us(n)),n.skin="bomb_explode",n.scene.anims.create({key:n.skin,frames:[{key:"atlas_objects",frame:"powerups/bomb_explode.png"}],frameRate:0,repeat:0}),n.play(n.skin),n.set_origin(),n.set_collider(),n}var s,i,n;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ds(e,t)}(t,Phaser.Physics.Arcade.Sprite),s=t,(i=[{key:"start",value:function(e,s){var i=this,n=2*this.radius;this.is_explode_all&&(n=Math.sqrt(Math.pow(this.scene.cameras.main.worldView.width,2)+Math.pow(this.scene.cameras.main.worldView.height,2)),e=this.scene.game.config.width/2,s=this.scene.game.config.height/2),this.setDisplaySize(n,n),this.collider.radius=n/2/this.scale,this.set_collider(),this.body.reset(e,s),this.show(),this.setAlpha(this.init_alpha),this.setDepth(2),this.scene.physics.world.overlap(this,this.scene.asteroidsGroup,function(e,s){var n,r;e instanceof t?(n=e,r=s):(n=s,r=e);var a=Math.round(r.curScore*i.scene.scoreIncreaseMult);i.scene.addScores(a),i.scene.effectsManager.spawnEffect(r.x,r.y,"scores_asteroid_1",{scores:a,ast_size:r.curDestr}),r.shooter=n.ship,r.subDestruction(n.power)}),this.scene.physics.world.overlap(this,this.scene.enemiesGroup,function(e,s){var n,r;e instanceof t?(n=e,r=s):(n=s,r=e);var a=Math.round(r.score*i.scene.scoreIncreaseMult);i.scene.addScores(a),i.scene.effectsManager.spawnEffect(r.x,r.y,"scores_enemy_1",{scores:a,enemy_type:r.type}),r.shooter=n.ship,r.subDestruction(n.power)}),this.body.setEnable(!1),this.scene.tweens.add({targets:this,props:{scale:{value:"+=0.1",duration:300,ease:"Quad.easeOut",repeat:0},alpha:{value:0,duration:300,ease:"Linear",repeat:0}},onComplete:function(e){i.hide()}},this),this.scene.cameras.main.shake(150,.007)}},{key:"stop",value:function(){this.hide()}},{key:"setTimeRemain",value:function(e){}},{key:"show",value:function(){this.enable=!0,this.setActive(!0),this.setVisible(!0),this.body.setEnable(!0),this.setAlpha(1)}},{key:"hide",value:function(){this.enable=!1,this.setActive(!1),this.setVisible(!1),this.body.setEnable(!1)}},{key:"preUpdate",value:function(e,s){cs(ps(t.prototype),"preUpdate",this).call(this,e,s),this.enable&&(this.timeRemain-=s*this.scene.time.timeScale)}},{key:"set_collider",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.collider,t=e.shape;if("string"==typeof t&&"circle"===t){var s=e.radius;this.body.setCircle(s,this.displayOriginX-s,this.displayOriginY-s)}}},{key:"set_origin",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.origin;return this.origin=e,this.setOrigin(this.origin.x,this.origin.y),this}}])&&ls(s.prototype,i),n&&ls(s,n),t}();function ys(e,t){for(var s=0;s<t.length;s++){var i=t[s];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var ms=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.scene=t,this.category="powerups",this.type="bomb",this.units=Phaser.GLOBALS.units_waves[this.category].units,this.lifetime=3e4,this.blinktime=1e4,this.addCount=1,this.radius=400,this.is_explode_all=!0,this.power=1,this.immediately_explode=!0,this.init_alpha=.4,this.spriteGroup=this.scene.add.group({classType:fs,maxSize:10,runChildUpdate:!0,active:!1,visible:!1}),this.readConfigByType(this.type),b.addEditorEmmiter.call(this,function(e){})}var t,s,i;return t=e,(s=[{key:"apply",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{add:null,lifetime:null,blinktime:null};if(e)if(this.immediately_explode)this.run(e.x,e.y,e);else{var s=null===t.add||void 0===t.add?this.addCount:t.add;this.lifetime=t.lifetime||this.scene.powerupManager.powerup_lifetime,this.blinktime=t.blinktime||this.scene.powerupManager.powerup_blinktime,e.powerups.hasOwnProperty(this.type)||(e.powerups[this.type]={}),e.powerups[this.type].hasOwnProperty("count")||(e.powerups[this.type].count=0),s&&(e.powerups[this.type].count+=s),e.powerups[this.type].hasOwnProperty("uigo")||(e.powerups[this.type].uigo=null),e.powerups[this.type].hasOwnProperty("time_remain")||(e.powerups[this.type].time_remain=this.lifetime);var i=e.powerups[this.type].time_remain;if(null===e.powerups[this.type].uigo)e.powerups[this.type].uigo=this.scene.powerupManager.addPowerupUI({player_id:e.playerID,type:this.type,count:e.powerups[this.type].count,lifetime:this.lifetime,time_remain:i});else{var n=e.powerups[this.type].uigo;n.setCount(e.powerups[this.type].count),n.setTimeRemain()}this.scene.mobileJoystick&&(this.scene.mobileJoystick.bombBtn.setTexture("atlas_objects","panels/btn_joystick_bomb.png"),this.scene.mobileJoystick.bombBtn.setActive(!0),this.scene.mobileJoystick.bombBtn.setVisible(!0))}}},{key:"run",value:function(e,t){var s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.scene.ships[0],i=null;(i=this.spriteGroup.get())&&(i.radius=this.radius,i.is_explode_all=this.is_explode_all,i.power=this.power,i.init_alpha=this.init_alpha,s&&(i.ship=s),i.start(e,t))}},{key:"reset",value:function(){this.spriteGroup.getChildren().forEach(function(e){e.stop()})}},{key:"set_is_explode_all",value:function(e){return this.is_explode_all=e,e}},{key:"set_radius",value:function(e){return this.radius=e,e}},{key:"set_power",value:function(e){return this.power=e,e}},{key:"set_immediately_explode",value:function(e){return this.immediately_explode=e,e}},{key:"readConfig",value:function(e){return this.set_is_explode_all(g(e,"is_explode_all",this.is_explode_all).value),this.set_radius(g(e,"radius",this.radius).value),this.set_power(g(e,"power",this.power).value),this.set_immediately_explode(g(e,"immediately_explode",this.immediately_explode).value),this}},{key:"readConfigByType",value:function(e){var t=this.units.hasOwnProperty(e)?this.units[e]:{};this.readConfig(t)}}])&&ys(t.prototype,s),i&&ys(t,i),e}();function vs(e,t){for(var s=0;s<t.length;s++){var i=t[s];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var _s=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.scene=t,this.category="powerups",this.type="extra_life",this.units=Phaser.GLOBALS.units_waves[this.category].units,this.acceleration_mult=3,this.rotation_mult=1.2,this.slowdown=.9,this.lifetime=3e4,this.blinktime=1e4,this.addCount=1}var t,s,i;return t=e,(s=[{key:"apply",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{add:null,lifetime:null,blinktime:null};if(e){var s=null===t.add||void 0===t.add?this.addCount:t.add;e.powerups.hasOwnProperty(this.type)||(e.powerups[this.type]={}),e.powerups[this.type].hasOwnProperty("count")||(e.powerups[this.type].count=0),s&&(e.powerups[this.type].count+=s),this.scene.addLife(e.powerups[this.type].count),e.powerups[this.type].count=0,this.scene.powerupManager.setPowerupCount(this.type,e.powerups[this.type].count,e)}}},{key:"reset",value:function(){}}])&&vs(t.prototype,s),i&&vs(t,i),e}();function gs(e,t){for(var s=0;s<t.length;s++){var i=t[s];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var bs=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.scene=t,this.category="powerups",this.type="life_refill",this.units=Phaser.GLOBALS.units_waves[this.category].units,this.lifetime=3e4,this.blinktime=1e4,this.addCount=1}var t,s,i;return t=e,(s=[{key:"apply",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{add:null,lifetime:null,blinktime:null};if(e){var s=null===t.add||void 0===t.add?this.addCount:t.add;e.powerups.hasOwnProperty(this.type)||(e.powerups[this.type]={}),e.powerups[this.type].hasOwnProperty("count")||(e.powerups[this.type].count=0),s&&(e.powerups[this.type].count+=s),this.scene.refillLifes(),e.powerups[this.type].count=0,this.scene.powerupManager.setPowerupCount(this.type,e.powerups[this.type].count,e)}}},{key:"reset",value:function(){}}])&&gs(t.prototype,s),i&&gs(t,i),e}();function ws(e,t){for(var s=0;s<t.length;s++){var i=t[s];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var ks=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.scene=t,this.category="powerups",this.type="increase_score",this.units=Phaser.GLOBALS.units_waves[this.category].units,this.multiply=1.25,this.lifetime=3e4,this.blinktime=1e4,this.addCount=1}var t,s,i;return t=e,(s=[{key:"apply",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{add:null,lifetime:null,blinktime:null};if(e){var s=null===t.add||void 0===t.add?this.addCount:t.add;if(e.powerups.hasOwnProperty(this.type)||(e.powerups[this.type]={}),e.powerups[this.type].hasOwnProperty("count")||(e.powerups[this.type].count=0),s&&(e.powerups[this.type].count+=s),this.scene.setScoreIncrease(this.multiply),e.powerups[this.type].hasOwnProperty("uigo")||(e.powerups[this.type].uigo=null),e.powerups[this.type].hasOwnProperty("is_permanent")||(e.powerups[this.type].is_permanent=!0),null===e.powerups[this.type].uigo)e.powerups[this.type].uigo=this.scene.powerupManager.addPowerupUI({player_id:e.playerID,type:this.type,count:1,lifetime:this.lifetime,time_remain:this.lifetime});else{var i=e.powerups[this.type].uigo;i.setCount(e.powerups[this.type].count),i.setTimeRemain(this.lifetime)}}}},{key:"reset",value:function(){}},{key:"set_multiply",value:function(e){return this.multiply=e,e}},{key:"readConfig",value:function(e){return this.set_multiply(g(e,"multiply",this.multiply).value),this}},{key:"readConfigByType",value:function(e){var t=this.units.hasOwnProperty(e)?this.units[e]:{};this.readConfig(t)}}])&&ws(t.prototype,s),i&&ws(t,i),e}();function Os(e){return(Os="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Ss(e,t){for(var s=0;s<t.length;s++){var i=t[s];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function Ps(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Ms(e,t,s){return(Ms="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,s){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=xs(e)););return e}(e,t);if(i){var n=Object.getOwnPropertyDescriptor(i,t);return n.get?n.get.call(s):n.value}})(e,t,s||e)}function xs(e){return(xs=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Ts(e,t){return(Ts=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Cs=function(e){function t(e,s,i){var n,r,a;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),r=this,(n=!(a=xs(t).call(this,e,s,i))||"object"!==Os(a)&&"function"!=typeof a?Ps(r):a).scene=e,n.scene.add.existing(Ps(n)),n.ship=null,n.type="",n.origin={x:.5,y:.5},n.enable=!1,n.is_blink=!1,n.lifetime=0,n.blinktime=0,n.deadTime=0,n.timeRemain=0,n.blink_state=!1,n.blinkOnTime=100,n.blinkOffTime=100,n.timerStertBlink=null,n.blink=new E(n.scene,Ps(n)),n.skin="ship_blast_radius_gun",n.scene.anims.create({key:n.skin,frames:[{key:"atlas_objects",frame:"powerups/ship_blast_radius_gun.png"}],frameRate:0,repeat:0}),n.play(n.skin),n.set_origin(),n}var s,i,n;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Ts(e,t)}(t,Phaser.GameObjects.Sprite),s=t,(i=[{key:"start",value:function(){this.show(),this.blink.stop();var e=this.scene.powerupManager.blastRadius;this.ship.setBlastRadius(!0,e.shot_delay),e.overlapdAsteroids.active=!0,e.overlapdEnemies.active=!0}},{key:"stop",value:function(){this.blink.stop(),this.ship.setBlastRadius(!1);for(var e=!1,t=0;t<this.scene.ships.length;t++)if(this.scene.ships[t].powerups.hasOwnProperty("blast_radius")){e=!0;break}if(!e){var s=this.scene.powerupManager.blastRadius;s.overlapdAsteroids.active=!1,s.overlapdEnemies.active=!1}this.hide()}},{key:"show",value:function(){this.is_blink=!1,this.enable=!0,this.setActive(!0),this.setVisible(!0),this.setAlpha(1)}},{key:"hide",value:function(){this.is_blink=!1,this.enable=!1,this.setActive(!1),this.setVisible(!1)}},{key:"preUpdate",value:function(e,s){Ms(xs(t.prototype),"preUpdate",this).call(this,e,s),this.enable&&(this.timeRemain-=s*this.scene.time.timeScale)}},{key:"set_collider",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.collider,t=e.shape;if("string"==typeof t)if("circle"===t){var s=e.radius;this.body.setCircle(s,this.displayOriginX-s,this.displayOriginY-s)}else"rectangle"===t&&(this.body.setSize(e.width,e.height),this.body.setOffset(e.offset_x,e.offset_y))}},{key:"set_origin",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.origin;return this.origin=e,this.setOrigin(this.origin.x,this.origin.y),this}}])&&Ss(s.prototype,i),n&&Ss(s,n),t}();function Es(e){return(Es="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function As(e,t){for(var s=0;s<t.length;s++){var i=t[s];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function js(e){return(js=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Bs(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Ds(e,t){return(Ds=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Rs=function(e){function t(e,s,i){var n,r,a;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),r=this,(n=!(a=js(t).call(this,e,s,i))||"object"!==Es(a)&&"function"!=typeof a?Bs(r):a).scene=e,n.scene.add.existing(Bs(n)),n.scene.physics.add.existing(Bs(n)),n.speed=n.scene.powerupManager.blastRadius.bullet_speed,n.lifetime=n.scene.powerupManager.blastRadius.bullet_lifetime,n.power=n.scene.powerupManager.blastRadius.bullet_power,n.size=1,n.collider={shape:"circle",radius:4,offset_x:-2,offset_y:-2},n.origin={x:.5,y:.5},n.deadTime=0,n.shooter=null,n.set_skin(),n.set_origin(),n.set_collider(),n.soundFire=n.scene.sound.add("fire",{mute:!1,volume:.5,loop:!1}),n}var s,i,n;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Ds(e,t)}(t,Phaser.Physics.Arcade.Image),s=t,(i=[{key:"fire",value:function(e,t,s){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{velocity:null,lifetime_mult:null,size_mult:null},n=i.velocity||{x:0,y:0},r=i.lifetime_mult||1,a=i.size_mult||1;1!==a&&this.setScale(this.size*a),this.setRotation(s);var o=n.x,h=n.y,l=.001*this.scene.game.loop.delta;this.body.reset(e+o*l,t+h*l);var u=this.rotation,c=Math.cos(u)*this.speed+o,p=Math.sin(u)*this.speed+h;this.setVelocity(c,p),this.deadTime=this.scene.time.now+this.lifetime*r,this.show(),"game"===this.scene.layoutState&&this.soundFire.play()}},{key:"show",value:function(){this.setActive(!0),this.setVisible(!0),this.body.setEnable(!0)}},{key:"hide",value:function(){this.shooter&&this.shooter.use_num_shots&&this.shooter.bulletsAlive--,this.setActive(!1),this.setVisible(!1),this.body.setEnable(!1)}},{key:"preUpdate",value:function(e,t){this.active&&e>this.deadTime&&this.hide(),this.body.world.wrap(this,0)}},{key:"set_skin",value:function(){this.setTexture("atlas_objects","blast_radius_bullet.png")}},{key:"set_collider",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.collider,t=e.shape;if("string"==typeof t)if("circle"===t){var s=e.radius;this.body.setCircle(s,this.displayOriginX-s,this.displayOriginY-s)}else"rectangle"===t&&(this.body.setSize(e.width,e.height),this.body.setOffset(e.offset_x,e.offset_y))}},{key:"set_speed",value:function(e){return this.speed=e,this}},{key:"set_lifetime",value:function(e){return this.lifetime=e,this}},{key:"set_power",value:function(e){return this.power=e,this}},{key:"set_origin",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.origin;return this.origin=e,this.setOrigin(this.origin.x,this.origin.y),this.set_collider(),this}}])&&As(s.prototype,i),n&&As(s,n),t}();function Gs(e){return(Gs="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Is(e,t){for(var s=0;s<t.length;s++){var i=t[s];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function Ls(e){return(Ls=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function zs(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Vs(e,t){return(Vs=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Us=function(e){function t(e,s,i){var n,r,a;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),r=this,(n=!(a=Ls(t).call(this,e,s,i))||"object"!==Gs(a)&&"function"!=typeof a?zs(r):a).scene=e,n.scene.add.existing(zs(n)),n.scene.physics.add.existing(zs(n)),n.power=1,n.radius=64,n.init_alpha=.6,n.collider={shape:"circle",radius:32},n.shooter=null,n.set_skin(),n.set_collider(),n.soundExplode=n.scene.sound.add("fire",{mute:!1,volume:.5,loop:!1}),n}var s,i,n;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Vs(e,t)}(t,Phaser.Physics.Arcade.Image),s=t,(i=[{key:"explode",value:function(e,s){var i=this,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{power:1,radius:null};this.radius=n.radius||this.radius;var r=2*this.radius;this.setDisplaySize(r,r),this.collider.radius=r/2/this.scale,this.set_collider(),this.body.reset(e,s),this.show(),this.setAlpha(this.init_alpha),this.setDepth(10),this.scene.physics.world.overlap(this.scene.powerupManager.blastRadius.explodeGroup,this.scene.asteroidsGroup,function(e,s){var i,n;e instanceof t?(i=e,n=s):(i=s,n=e),n.shipBulletHitAsteroid(i)}),this.scene.physics.world.overlap(this.scene.powerupManager.blastRadius.explodeGroup,this.scene.enemiesGroup,function(e,s){var i,n;e instanceof t?(i=e,n=s):(i=s,n=e),n.shipBulletHitEnemy(i)}),this.scene.tweens.add({targets:this,props:{scale:{value:"+=0.1",duration:300,ease:"Quad.easeOut",repeat:0},alpha:{value:0,delay:0,duration:300,ease:"Linear",repeat:0}},onComplete:function(e){i.hide()}},this),this.scene.cameras.main.shake(80,.007)}},{key:"show",value:function(){this.setAlpha(1),this.setActive(!0),this.setVisible(!0),this.body.setEnable(!0)}},{key:"hide",value:function(){this.setActive(!1),this.setVisible(!1),this.body.setEnable(!1)}},{key:"set_skin",value:function(){this.setTexture("atlas_objects","powerups/blast_radius_explode.png")}},{key:"set_collider",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.collider,t=e.shape;if("string"==typeof t&&"circle"===t){var s=e.radius;this.body.setCircle(s,this.displayOriginX-s,this.displayOriginY-s)}}},{key:"set_power",value:function(e){return this.power=e,this}}])&&Is(s.prototype,i),n&&Is(s,n),t}();function Fs(e,t){for(var s=0;s<t.length;s++){var i=t[s];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var Hs=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.scene=t,this.category="powerups",this.type="blast_radius",this.units=Phaser.GLOBALS.units_waves[this.category].units,this.bullet="blast_radius",this.bullet_power=1,this.bullet_speed=40,this.bullet_lifetime=6e3,this.explode_radius=100,this.shot_delay=500,this.lifetime=3e4,this.blinktime=1e4,this.addCount=1,this.spriteGroup=this.scene.add.group({classType:Cs,maxSize:2,runChildUpdate:!0,active:!1,visible:!1}),this.bulletGroup=this.scene.add.group({classType:Rs,maxSize:100,runChildUpdate:!0,active:!1,visible:!1}),this.explodeGroup=this.scene.add.group({classType:Us,maxSize:100,runChildUpdate:!0,active:!1,visible:!1}),this.overlapdAsteroids=null,this.overlapdEnemies=null,this.addOverlapAsteroids(),this.addOverlapEnemies(),this.readConfigByType(this.type),b.addEditorEmmiter.call(this,function(e){})}var t,s,i;return t=e,(s=[{key:"apply",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{add:null,lifetime:null,blinktime:null};if(e){var s=null===t.add||void 0===t.add?this.addCount:t.add,i=null;e.powerups.hasOwnProperty(this.type)||(e.powerups[this.type]={}),e.powerups[this.type].hasOwnProperty("count")||(e.powerups[this.type].count=0),s&&(e.powerups[this.type].count+=s),e.powerups[this.type].hasOwnProperty("go")||(e.powerups[this.type].go=null),null===e.powerups[this.type].go?(i=this.spriteGroup.get(),e.powerups[this.type].go=i,e.add(i),e.gunGO&&e.gunGO.setVisible(!1)):i=e.powerups[this.type].go,i.type=this.type,i.ship=e,i.start()}}},{key:"reset",value:function(){this.spriteGroup.getChildren().forEach(function(e){e.stop()})}},{key:"createExplode",value:function(e){var t=this.explodeGroup.getFirstDead(!0);t&&(t.shooter=e.shooter,t.explode(e.x,e.y,{radius:this.explode_radius,power:e.power}))}},{key:"addOverlapAsteroids",value:function(){var e=this;return this.overlapdAsteroids=this.scene.physics.add.overlap(this.bulletGroup,this.scene.asteroidsGroup,function(t,s){var i;i=t instanceof Rs?t:s,e.createExplode(i),i.hide()}),this.overlapdAsteroids}},{key:"addOverlapEnemies",value:function(){var e=this;return this.overlapdEnemies=this.scene.physics.add.overlap(this.bulletGroup,this.scene.enemiesGroup,function(t,s){var i;i=t instanceof Rs?t:s,e.createExplode(i),i.hide()}),this.overlapdEnemies}},{key:"set_explode_radius",value:function(e){return this.explode_radius=e,e}},{key:"set_bullet",value:function(e){return this.bullet=e,e}},{key:"set_bullet_power",value:function(e){return this.bullet_power=e,e}},{key:"set_bullet_speed",value:function(e){return this.bullet_speed=e,e}},{key:"set_bullet_lifetime",value:function(e){return this.bullet_lifetime=e,e}},{key:"set_shot_delay",value:function(e){return this.shot_delay=e,e}},{key:"readConfig",value:function(e){return this.set_bullet(g(e,"bullet",this.bullet).value),this.set_bullet_power(g(e,"bullet_power",this.bullet_power).value),this.set_bullet_speed(g(e,"bullet_speed",this.bullet_speed).value),this.set_bullet_lifetime(g(e,"bullet_lifetime",this.bullet_lifetime).value),this.set_explode_radius(g(e,"explode_radius",this.explode_radius).value),this.set_shot_delay(g(e,"shot_delay",this.shot_delay).value),this}},{key:"readConfigByType",value:function(e){var t=this.units.hasOwnProperty(e)?this.units[e]:{};this.readConfig(t)}}])&&Fs(t.prototype,s),i&&Fs(t,i),e}();function Ns(e){return(Ns="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Ws(e,t){for(var s=0;s<t.length;s++){var i=t[s];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function Ks(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Qs(e,t,s){return(Qs="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,s){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Ys(e)););return e}(e,t);if(i){var n=Object.getOwnPropertyDescriptor(i,t);return n.get?n.get.call(s):n.value}})(e,t,s||e)}function Ys(e){return(Ys=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Xs(e,t){return(Xs=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Js=function(e){function t(e,s,i){var n,r,a;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),r=this,(n=!(a=Ys(t).call(this,e,s,i))||"object"!==Ns(a)&&"function"!=typeof a?Ks(r):a).scene=e,n.scene.add.existing(Ks(n)),n.scene.physics.add.existing(Ks(n)),n.ship=null,n.power=1,n.collider={shape:"circle",radius:9,offset_x:20,offset_y:0},n.type="",n.origin={x:.5,y:.5},n.lifetime=0,n.blinktime=0,n.deadTime=0,n.timeRemain=0,n.blink_state=!1,n.blinkOnTime=100,n.blinkOffTime=100,n.blinkPrevTime=0,n.blinkStep=0,n.timerStartBlink=null,n.blink=new E(n.scene,Ks(n)),n.skin="drill_bit";var o=n.scene.anims.generateFrameNames("atlas_objects",{start:1,end:20,zeroPad:4,prefix:"powerups/ship_drill_bit",suffix:".png",frames:!0});return n.scene.anims.create({key:n.skin,frames:o,frameRate:15,repeat:-1,yoyo:!1}),n.play(n.skin),n.set_collider(),n.overlapdAsteroids=null,n.overlapdEnemies=null,n.overlapdEnemyBullets=null,n.overlapdMines=null,n.addOverlapAsteroids(),n.addOverlapEnemies(),n.addOverlapEnemyBullets(),n.addOverlapMines(),n}var s,i,n;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Xs(e,t)}(t,Phaser.Physics.Arcade.Sprite),s=t,(i=[{key:"start",value:function(){this.timerStartBlink&&this.timerStartBlink.remove(),this.blink.stop(),this.show()}},{key:"stop",value:function(){this.timerStartBlink&&this.timerStartBlink.remove(),this.blink.stop(),this.hide()}},{key:"addOverlapAsteroids",value:function(){return this.overlapdAsteroids=this.scene.physics.add.overlap(this,this.scene.asteroidsGroup,function(e,s){var i,n;e instanceof t?(i=e,n=s):(i=s,n=e),i.shooter=i.ship,n.shipBulletHitAsteroid(i)}),this.overlapdAsteroids}},{key:"addOverlapEnemies",value:function(){return this.overlapdEnemies=this.scene.physics.add.overlap(this,this.scene.enemiesGroup,function(e,s){var i,n;e instanceof t?(i=e,n=s):(i=s,n=e),i.shooter=i.ship,n.shipBulletHitEnemy(i)}),this.overlapdEnemies}},{key:"addOverlapEnemyBullets",value:function(){var e=this;return this.overlapdEnemyBullets=this.scene.physics.add.overlap(this,this.scene.enemiesBulletsGroup,function(s,i){var n;n=s instanceof t?i:s,e.scene.effectsManager.spawnEffect(n.x,n.y,"bullet_explode"),n.hide()}),this.overlapdEnemyBullets}},{key:"addOverlapMines",value:function(){return this.overlapdMines=this.scene.physics.add.overlap(this,this.scene.wavesManager.minesManager.mineGroup,function(e,s){(e instanceof t?s:e).explode()}),this.overlapdMines}},{key:"show",value:function(){this.setActive(!0),this.setVisible(!0),this.body.setEnable(!0),this.setAlpha(1)}},{key:"hide",value:function(){this.setActive(!1),this.setVisible(!1),this.body.setEnable(!1)}},{key:"setEnabled",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.setVisible(e),this.overlapdAsteroids&&(this.overlapdAsteroids.active=e),this.overlapdEnemies&&(this.overlapdEnemies.active=e),this.overlapdEnemyBullets&&(this.overlapdEnemyBullets.active=e),this.overlapdMines&&(this.overlapdMines.active=e)}},{key:"preUpdate",value:function(e,s){Qs(Ys(t.prototype),"preUpdate",this).call(this,e,s)}},{key:"set_collider",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.collider,t=e.shape;if("string"==typeof t)if("circle"===t){var s=e.radius;this.body.setCircle(s,this.displayOriginX-s,this.displayOriginY-s)}else"rectangle"===t&&(this.body.setSize(e.width,e.height),this.body.setOffset(e.offset_x,e.offset_y))}}])&&Ws(s.prototype,i),n&&Ws(s,n),t}();function Zs(e,t){for(var s=0;s<t.length;s++){var i=t[s];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var qs=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.scene=t,this.category="powerups",this.type="drill_bit",this.units=Phaser.GLOBALS.units_waves[this.category].units,this.offset={x:26,y:0},this.lifetime=3e4,this.blinktime=1e4,this.addCount=1,this.spriteGroup=this.scene.add.group({classType:Js,maxSize:2,runChildUpdate:!0,active:!1,visible:!1}),b.addEditorEmmiter.call(this,function(e){})}var t,s,i;return t=e,(s=[{key:"apply",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{add:null,lifetime:null,blinktime:null};if(e){var s=null,i=null===t.add||void 0===t.add?this.addCount:t.add;e.powerups.hasOwnProperty(this.type)||(e.powerups[this.type]={}),e.powerups[this.type].hasOwnProperty("count")||(e.powerups[this.type].count=0),i&&(e.powerups[this.type].count+=i),e.powerups[this.type].hasOwnProperty("go")||(e.powerups[this.type].go=null),null===e.powerups[this.type].go?((s=this.spriteGroup.get()).x=this.offset.x,e.powerups[this.type].go=s,e.add(s)):s=e.powerups[this.type].go,s.deadTime=this.scene.time.now+s.timeRemain,s.type=this.type,s.ship=e,s.start()}}},{key:"reset",value:function(){this.spriteGroup.getChildren().forEach(function(e){e.stop()})}},{key:"readConfig",value:function(e){return this}},{key:"readConfigByType",value:function(e){var t=this.units.hasOwnProperty(e)?this.units[e]:{};this.readConfig(t)}}])&&Zs(t.prototype,s),i&&Zs(t,i),e}();function $s(e){return($s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ei(e,t){for(var s=0;s<t.length;s++){var i=t[s];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function ti(e){return(ti=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function si(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function ii(e,t){return(ii=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var ni=function(e){function t(e,s,i){var n,r,a;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),r=this,(n=!(a=ti(t).call(this,e,s,i))||"object"!==$s(a)&&"function"!=typeof a?si(r):a).scene=e,n.scene.add.existing(si(n)),n.scene.physics.add.existing(si(n)),n.ship=null,n.init_alpha=.4,n.collider={shape:"circle",radius:66,offset_x:0,offset_y:0},n.radius=1e3,n.skin="freeze_explode",n.scene.anims.create({key:n.skin,frames:[{key:"atlas_objects",frame:"powerups/freeze_explode.png"}],frameRate:0,repeat:0}),n.play(n.skin),n.set_collider(),n.soundFreese=n.scene.sound.add("freeze",{mute:!1,volume:1,loop:!1}),n}var s,i,n;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ii(e,t)}(t,Phaser.Physics.Arcade.Sprite),s=t,(i=[{key:"start",value:function(e,s){var i=this,n=Math.sqrt(Math.pow(this.scene.cameras.main.worldView.width,2)+Math.pow(this.scene.cameras.main.worldView.height,2));e=this.scene.game.config.width/2,s=this.scene.game.config.height/2,this.setDisplaySize(n,n),this.collider.radius=n/2/this.scale,this.set_collider(),this.body.reset(e,s),this.show(),this.setAlpha(this.init_alpha),this.setDepth(2);var r=this.scene.cameras.main.worldView;this.scene.physics.world.overlap(this,this.scene.asteroidsGroup,function(e,s){var i,n=0*(i=e instanceof t?s:e).padding;i.x>r.left-n&&i.x<r.right+n&&i.y>r.top-n&&i.y<r.bottom+n&&i.setFreeze(!0)}),this.scene.physics.world.overlap(this,this.scene.enemiesGroup,function(e,s){var i,n=0*(i=e instanceof t?s:e).padding;i.x>r.left-n&&i.x<r.right+n&&i.y>r.top-n&&i.y<r.bottom+n&&i.setFreeze(!0)}),this.body.setEnable(!1),this.scene.tweens.add({targets:this,props:{scale:{value:"+=0.1",duration:300,ease:"Quad.easeOut",repeat:0},alpha:{value:0,duration:300,ease:"Linear",repeat:0}},onComplete:function(e){i.hide()}},this),"game"===this.scene.layoutState&&this.soundFreese.play()}},{key:"stop",value:function(){this.hide()}},{key:"setTimeRemain",value:function(e){}},{key:"show",value:function(){this.setActive(!0),this.setVisible(!0),this.body.setEnable(!0),this.setAlpha(1)}},{key:"hide",value:function(){this.setActive(!1),this.setVisible(!1),this.body.setEnable(!1)}},{key:"set_collider",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.collider,t=e.shape;if("string"==typeof t&&"circle"===t){var s=e.radius;this.body.setCircle(s,this.displayOriginX-s,this.displayOriginY-s)}}}])&&ei(s.prototype,i),n&&ei(s,n),t}();function ri(e){return(ri="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ai(e,t){for(var s=0;s<t.length;s++){var i=t[s];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function oi(e){return(oi=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function hi(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function li(e,t){return(li=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var ui=function(e){function t(e,s,i){var n,r,a;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),r=this,(n=!(a=oi(t).call(this,e,s,i))||"object"!==ri(a)&&"function"!=typeof a?hi(r):a).scene=e,n.scene.add.existing(hi(n)),n.freezedObject=null,n.init_alpha=1,n.is_freeze_time=n.scene.powerupManager.freeze.is_freeze_time,n.timeRemain=0,n.fade_time=n.scene.powerupManager.freeze.fade_time,n.blink=new E(n.scene,hi(n)),n}var s,i,n;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&li(e,t)}(t,Phaser.GameObjects.Image),s=t,(i=[{key:"start",value:function(e,t,s){this.timeRemain=this.scene.powerupManager.freeze.freeze_time,this.blink.stop(),this.setPosition(e,t),this.setType(s),this.setAlpha(this.init_alpha),this.rotation=Phaser.Math.RND.rotation(),this.show()}},{key:"stop",value:function(){this.freezedObject=null,this.hide()}},{key:"setType",value:function(e){switch(e){case"asteroid_0":this.setTexture("atlas_objects","powerups/asteroid_ice_0.png");break;case"asteroid_1":this.setTexture("atlas_objects","powerups/asteroid_ice_1.png");break;case"asteroid_2":this.setTexture("atlas_objects","powerups/asteroid_ice_2.png");break;case"asteroid_0_2":this.setTexture("atlas_objects","powerups/asteroid_ice_0_2.png");break;case"asteroid_1_2":this.setTexture("atlas_objects","powerups/asteroid_ice_1_2.png");break;case"asteroid_2_2":this.setTexture("atlas_objects","powerups/asteroid_ice_2_2.png");break;case"ufo_1":this.setTexture("atlas_objects","powerups/ufo_ice_1.png");break;case"ufo_2":this.setTexture("atlas_objects","powerups/ufo_ice_2.png")}}},{key:"setTimeRemain",value:function(e){}},{key:"show",value:function(){this.setActive(!0),this.setVisible(!0),this.setAlpha(1)}},{key:"hide",value:function(){this.setActive(!1),this.setVisible(!1)}},{key:"preUpdate",value:function(e,t){this.is_freeze_time&&(this.blink.alphaFromTimeRemain(this.timeRemain,this.fade_time),this.timeRemain-=t,this.timeRemain<0&&(this.freezedObject?this.freezedObject.setFreeze(!1):this.stop()))}}])&&ai(s.prototype,i),n&&ai(s,n),t}();function ci(e,t){for(var s=0;s<t.length;s++){var i=t[s];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var pi=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.scene=t,this.category="powerups",this.type="freeze",this.units=Phaser.GLOBALS.units_waves[this.category].units,this.lifetime=3e4,this.blinktime=1e4,this.addCount=1,this.is_freeze_time=!1,this.freeze_time=8e3,this.fade_time=6e3,this.init_alpha=.4,this.spriteGroup=this.scene.add.group({classType:ni,maxSize:10,runChildUpdate:!0,active:!1,visible:!1}),this.iceGroup=this.scene.add.group({classType:ui,maxSize:100,runChildUpdate:!0,active:!1,visible:!1}),this.readConfigByType(this.type),b.addEditorEmmiter.call(this,function(e){})}var t,s,i;return t=e,(s=[{key:"apply",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{add:null,lifetime:null,blinktime:null};if(e){var s=null===t.add||void 0===t.add?this.addCount:t.add;this.lifetime=t.lifetime||this.scene.powerupManager.powerup_lifetime,this.blinktime=t.blinktime||this.scene.powerupManager.powerup_blinktime,e.powerups.hasOwnProperty(this.type)||(e.powerups[this.type]={}),e.powerups[this.type].hasOwnProperty("count")||(e.powerups[this.type].count=0),s&&(e.powerups[this.type].count+=s),e.powerups[this.type].hasOwnProperty("uigo")||(e.powerups[this.type].uigo=null),e.powerups[this.type].hasOwnProperty("time_remain")||(e.powerups[this.type].time_remain=this.lifetime);var i=e.powerups[this.type].time_remain;if(null===e.powerups[this.type].uigo)e.powerups[this.type].uigo=this.scene.powerupManager.addPowerupUI({player_id:e.playerID,type:this.type,count:e.powerups[this.type].count,lifetime:this.lifetime,time_remain:i});else{var n=e.powerups[this.type].uigo;n.setCount(e.powerups[this.type].count),n.setTimeRemain()}this.scene.mobileJoystick&&(this.scene.mobileJoystick.bombBtn.setTexture("atlas_objects","panels/btn_joystick_freeze.png"),this.scene.mobileJoystick.bombBtn.setActive(!0),this.scene.mobileJoystick.bombBtn.setVisible(!0))}}},{key:"run",value:function(e,t){var s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.scene.ships[0],i=this.spriteGroup.get();i&&(i.init_alpha=this.init_alpha,s&&(i.ship=s),i.start(e,t))}},{key:"reset",value:function(){this.spriteGroup.getChildren().forEach(function(e){e.stop()}),this.iceGroup.getChildren().forEach(function(e){e.stop()})}},{key:"set_freeze_time",value:function(e){return this.freeze_time=e,e}},{key:"readConfig",value:function(e){return this.set_freeze_time(g(e,"freeze_time",this.freeze_time).value),this}},{key:"readConfigByType",value:function(e){var t=this.units.hasOwnProperty(e)?this.units[e]:{};this.readConfig(t)}}])&&ci(t.prototype,s),i&&ci(t,i),e}();function di(e){return(di="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function fi(e,t){for(var s=0;s<t.length;s++){var i=t[s];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function yi(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function mi(e,t,s){return(mi="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,s){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=vi(e)););return e}(e,t);if(i){var n=Object.getOwnPropertyDescriptor(i,t);return n.get?n.get.call(s):n.value}})(e,t,s||e)}function vi(e){return(vi=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _i(e,t){return(_i=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var gi=function(e){function t(e,s,i,n){var r,a,o;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),a=this,(r=!(o=vi(t).call(this,e,s,i))||"object"!==di(o)&&"function"!=typeof o?yi(a):o).scene=e,r.scene.add.existing(yi(r)),r.scene.physics.add.existing(yi(r)),r.setOrigin(.5),r.category="powerups",r.type="shield",r.units=Phaser.GLOBALS.units_waves[r.category].units,r.config=n||r.units[r.type],r.skin="powerup_shield",r.size=1,r.collider={shape:"rectangle",cwidth:30},r.is_slowdown=!0,r.slowdown=.99,r.skinGO=null,r.isMagneted=!1,r.magnetedShip=null,r.colliderMagneto={shape:"circle",radius:r.scene.powerupManager.magnet_radius},r.curSpeed=0,r.uid=0,r.padding=0,r.lifetime=r.scene.powerupManager.dropped_lifetime,r.blinktime=r.scene.powerupManager.dropped_blinktime,r.blink=new E(r.scene,yi(r)),r.readConfigByType(r.type),b.addEditorEmmiter.call(yi(r),function(e){}),r}var s,i,n;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&_i(e,t)}(t,Phaser.GameObjects.Sprite),s=t,(i=[{key:"spawn",value:function(e,t,s){var i=this,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{parentVelocity:null,uid:null,debug:!1},r=n.hasOwnProperty("parentVelocity")?n.parentVelocity:{x:0,y:0};n.hasOwnProperty("debug")&&n.debug,this.uid=n.hasOwnProperty("uid")?n.uid:0,this.scene.powerupManager.uidHash[this.uid]++,this.scene.powerupManager.aliveCount++,e!==this.type&&(this.type=e,this.readConfigByType(this.type)),this.isMagneted=!1,this.magnetedShip=null,this.curSpeed=0,this.scene.powerupManager.is_magnet?this.set_collider(this.colliderMagneto):this.set_collider();var a=r.x,o=r.y,h=.001*this.scene.game.loop.delta;this.body.reset(t+a*h,s+o*h);var l=r.x,u=r.y;this.body.setVelocity(l,u),this.body.useDamping=this.is_slowdown,this.body.setDrag(this.slowdown),this.show(),this.blink.start({wait:Math.max(0,this.lifetime-this.blinktime),duration:this.blinktime,time_remain:this.blinktime,type:"alpha"},function(){i.hide(!0)})}},{key:"pick",value:function(){this.hide(!0)}},{key:"resetCurVars",value:function(){}},{key:"show",value:function(){this.setActive(!0),this.setVisible(!0),this.body.setEnable(!0),this.setAlpha(1)}},{key:"hide",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(t)this.setActive(!1),this.setVisible(!1);else{var s=function(){var t=.001*e.scene.game.loop.delta;e.setPosition(e.x+e.body.velocity.x*t,e.y+e.body.velocity.y*t)};this.scene.tweens.add({targets:this,alpha:0,duration:50,ease:"Power0",onComplete:function(){e.setActive(!1),e.setVisible(!1)},onStart:function(){s()},onUpdate:function(e,t){s()}},this)}this.body.stop(),this.body.setEnable(!1),this.resetCurVars()}},{key:"preUpdate",value:function(e,s){if(mi(vi(t.prototype),"preUpdate",this).call(this,e,s),this.isMagneted){if(this.magnetedShip){s=.001*this.scene.game.loop.delta;var i=new Phaser.Math.Vector2(this.magnetedShip.x-this.x,this.magnetedShip.y-this.y);i.normalize(),this.curSpeed+=3*this.magnetedShip.max_speed*s,this.curSpeed=Math.min(2*this.magnetedShip.max_speed,this.curSpeed),this.body.setVelocity(i.x*this.curSpeed,i.y*this.curSpeed)}}else this.is_slowdown&&this.body.speed<1&&this.body.setVelocity(0,0);this.body.world.wrap(this,this.padding)}},{key:"set_skin",value:function(e){return this.skin=void 0!==e&&""!==e?e:"drop_"+this.type,this.play(this.skin),this}},{key:"set_collider",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.collider,t=e.shape;if("string"==typeof t)if("circle"===t){var s=e.radius;this.body.setCircle(s,this.displayOriginX-s,this.displayOriginY-s)}else if("rectangle"===t){var i=e.cwidth,n=e.hasOwnProperty("cheight")?e.cheight:i;this.body.setSize(i,n),this.body.setOffset(this.displayOriginX-i/2,this.displayOriginX-n/2)}return this}},{key:"set_size",value:function(e){return this.setScale(e),this.size=e,this}},{key:"readConfig",value:function(e){this.set_skin(g(e,"skin","").value),this.set_size(g(e,"size",this.size).value),this.set_collider(g(e,"collider",this.collider).value)}},{key:"readConfigByType",value:function(e){var t=this.units.hasOwnProperty(e)?this.units[e]:this.config;this.readConfig(t)}}])&&fi(s.prototype,i),n&&fi(s,n),t}();function bi(e){return(bi="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function wi(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),s.push.apply(s,i)}return s}function ki(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}function Oi(e,t){for(var s=0;s<t.length;s++){var i=t[s];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function Si(e){return(Si=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Pi(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Mi(e,t){return(Mi=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var xi=function(e){function t(e,s){var i,n,r;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),n=this,(i=!(r=Si(t).call(this,e,0,0,"white"))||"object"!==bi(r)&&"function"!=typeof r?Pi(n):r).scene=e,i.scene.add.existing(Pi(i));return i.options=function(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?wi(s,!0).forEach(function(t){ki(e,t,s[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):wi(s).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))})}return e}({},{init_x:0,init_y:0,font_key:"white",text:"",anchor_ltrd:"",anchor_weight:[1,1],name:"",size:[.9,1],origin:[.5],align_v:"center",align_h:"center",font_size:14},{},s),i.init_x=i.options.init_x,i.init_x<=1&&i.init_x>0&&(i.init_x=Math.round(i.scene.game.config.width*i.init_x)),i.init_y=i.options.init_y,i.init_y<=1&&i.init_y>0&&(i.init_y=Math.round(i.scene.game.config.height*i.init_y)),i.anchor_ltrd=i.options.anchor_ltrd,i.anchor_weight=i.options.anchor_weight,i.origin=i.options.origin,i.originX=i.origin[0],i.originY=i.origin.length>1?i.origin[1]:i.originX,i.font_key=i.options.font,i.font_size=i.options.font_size,i.text=i.options.text,i.letterSpacing=i.options.letterSpacing||0,i.align_h=i.options.align_h,i.name=i.options.name,i.create(),i}var s,i,n;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Mi(e,t)}(t,Phaser.GameObjects.BitmapText),s=t,(i=[{key:"create",value:function(){this.x=this.init_x,this.y=this.init_y,this.setFont(this.font_key),this.setText(this.text),"left"===this.align_h?this.setLeftAlign():"right"===this.align_h?this.setRightAlign():this.setCenterAlign(),this.setFontSize(this.font_size),this.setOrigin(this.originX,this.originY)}},{key:"setColoredText",value:function(e){}}])&&Oi(s.prototype,i),n&&Oi(s,n),t}();function Ti(e){return(Ti="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Ci(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),s.push.apply(s,i)}return s}function Ei(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?Ci(s,!0).forEach(function(t){Ai(e,t,s[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):Ci(s).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))})}return e}function Ai(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}function ji(e,t){for(var s=0;s<t.length;s++){var i=t[s];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function Bi(e){return(Bi=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Di(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Ri(e,t){return(Ri=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Gi=function(e){function t(e,s){var i,n,r;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),n=this,(i=!(r=Bi(t).call(this,e,0,0))||"object"!==Ti(r)&&"function"!=typeof r?Di(n):r).scene=e,i.scene.add.existing(Di(i));var a={init_x:0,init_y:0,anchor_ltrd:"",anchor_weight:[1,1],name:"",event_click:null,state:"on",is_toggle:!1,tween_on:{type:""},tween_over:{type:""},tween_down:{},bg:{on:[],off:[],over:[],down:[],origin:[.5],size:[1]},sound:{on:"",off:"",over:"",down:"default"},collider:{shape:"rectangle",size:[1,1]},text:{text:"",text_on:"",text_off:"",text_over:"",text_down:"",pos:[.5],size:[.9,1],origin:[.5],align_v:"center",align_h:"center",font_size:14,weight:"",italic:!1,color_on:"white",color_off:"white",color_over:"white",color_down:"white",is_bitmap:!1,font:"",font_on:"",font_off:"",font_over:"",font_down:""},icon:{on:[],off:[],over:[],down:[],pos:[.8,.5],origin:[.5]}};if(s.hasOwnProperty("bg")||(s.bg={}),s.hasOwnProperty("sound")||(s.sound={}),s.hasOwnProperty("collider")||(s.collider={}),s.hasOwnProperty("text")||(s.text={}),s.hasOwnProperty("icon")||(s.icon={}),s.bg=Ei({},a.bg,{},s.bg),s.sound=Ei({},a.sound,{},s.sound),s.tween_on=Ei({},a.tween_on,{},s.tween_on),s.tween_over=Ei({},a.tween_over,{},s.tween_over),s.tween_down=Ei({},a.tween_down,{},s.tween_down),s.collider=Ei({},a.collider,{},s.collider),s.text=Ei({},a.text,{},s.text),s.icon=Ei({},a.icon,{},s.icon),s=Ei({},a,{},s),i.options=s,i.mainCont=null,i.childCont=null,i.state=i.options.state,i.pointerState=i.state,i.init_x=i.options.init_x,i.init_x<=1&&i.init_x>0&&(i.init_x=Math.round(i.scene.game.config.width*i.init_x)),i.init_y=i.options.init_y,i.init_y<=1&&i.init_y>0&&(i.init_y=Math.round(i.scene.game.config.height*i.init_y)),i.name=i.options.name,i.anchor_ltrd=i.options.anchor_ltrd,i.anchor_weight=i.options.anchor_weight,i.event_click=i.options.event_click,i.tween_on=i.options.tween_on,i.tween_over=i.options.tween_over,i.tween_down=i.options.tween_down,i.is_toggle=i.options.is_toggle,i.bg_on=null,i.bg_off=null,i.bg_over=null,i.bg_down=null,i.collider=null,i.text=null,i.text_on=null,i.text_off=null,i.text_over=null,i.text_down=null,i.text_current=null,i.options.sound.down){var o="default"===i.options.sound.down?"player_clicks_any_ui_button":i.options.sound.down;i.soundDown=i.scene.sound.add(o,{mute:!1,volume:1,loop:!1})}else i.soundDown=null;return i.create(),i}var s,i,n;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Ri(e,t)}(t,Phaser.GameObjects.Container),s=t,(i=[{key:"create",value:function(){var e=this;this.x=this.init_x,this.y=this.init_y,this.scene.screenResizer.addAnchorObject(this),this.childCont=this.scene.add.container(),this.add(this.childCont);var t,s,i,n,r=this.options.collider,a=r.shape,o=r.size[0],h=r.size.length>1?r.size[1]:o,l=this.options.bg;if(l.on.length>0){var u=function(t){var s="",i="",n=null,r=l.size[0],a=l.size.length>1?l.size[1]:r;return l[t].length>1?(s=l[t][0],i=l[t][1],n=e.scene.add.image(0,0,s,i)):(i=l[t][0],n=e.scene.add.image(0,0,i)),r<=3?n.scaleX=r:n.displayWidth=r,a<=3?n.scaleY=a:n.displayHeight=a,n.setVisible(!1),e.childCont.add(n),n};this.bg_on=u("on"),0===l.off.length?this.bg_off=this.bg_on:this.bg_off=u("off"),0===l.over.length||(this.bg_over=u("over")),0===l.down.length?this.bg_down=this.bg_on:this.bg_down=u("down");var c=this["bg_"+this.state];o<=3&&(o=c.displayWidth*o),i=-(t=o/2),h<=3&&(h=c.displayHeight*h),n=-(s=h/2)}this.collider="circle"===a?new Phaser.Geom.Circle(-t,-s,t):new Phaser.Geom.Rectangle(this.childCont.x-t,this.childCont.y-s,o,h),this.childCont.setInteractive({hitArea:this.collider,hitAreaCallback:Phaser.Geom.Rectangle.Contains,cursor:"pointer"});var p=this.options.text;if(""!==p.text&&""===p.text_on&&(p.text_on=p.text),""!==p.text_on){var d=function(t){var s=null;if(p.is_bitmap){var r=""!==p["font_"+t]?p["font_"+t]:p.font;s=e.scene.add.bitmapText(0,0,r)}else{s=e.scene.add.text(0,0,""),""!==p.weight&&s.setStyle({fontStyle:p.weight});var a=p.size[0],l=p.size.length>1?p.size[1]:a;s.width=a<=3?o*a:a,s.height=l<=3?h*l:l,s.setColor(p["color_"+t])}s.setText(p["text_"+t]),s.setFontSize(p.font_size),p.is_bitmap?"left"===p.align_h?s.setLeftAlign():"right"===p.align_h?s.setRightAlign():s.setCenterAlign():s.setAlign(p.align_h);var u=p.origin[0],c=p.origin.length>1?p.origin[1]:u;s.setOrigin(u,c);var d=p.pos[0],f=p.pos.length>1?p.pos[1]:d;return s.x=d<=1?i+o*d:d,s.y=f<=1?n+h*f:f,s.setVisible(!1),e.childCont.add(s),s};this.text_on=d("on"),""===p.text_off?this.text_off=this.text_on:this.text_off=d("off"),""===p.text_over?this.text_over=this.text_on:this.text_over=d("over"),""===p.text_down?this.text_down=this.text_on:this.text_down=d("down")}this.setState(this.options.state),this.setTweenOn(),this.childCont.on("pointerdown",function(t){e.setTweenDown(),e.is_toggle?"on"===e.state?e.setState("off"):e.setState("on"):e.setPointerState("down"),e.tween_down.type?setTimeout(function(){e.emit("down",e)},150):e.emit("down",e),e.soundDown&&e.soundDown.play()}),this.childCont.on("pointerup",function(){e.emit("up",e),e.is_toggle}),this.childCont.on("pointerover",function(t){e.setTweenOver()}),this.childCont.on("pointerout",function(t){e.setTweenOut()}),this.scene.scale.refresh()}},{key:"setState",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"on";this.state=e,this.setPointerState(this.state)}},{key:"setPointerState",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"on";this.pointerState=e,this.childCont.iterate(function(e){e.setVisible(!1)}),this["bg_"+this.state]&&this["bg_"+this.state].setVisible(!0),this["text_"+this.state]&&(this["text_"+this.state].setColor&&this["text_"+this.state].setColor(this.options.text["color_"+e]),this["text_"+this.state].setVisible(!0))}},{key:"setDisabled",value:function(){}},{key:"setTweenOn",value:function(){if(""!==this.tween_on.type)switch(this.tween_on.type){case"sine_v":var e=this.tween_on.hasOwnProperty("magnitude")?this.tween_on.magnitude:3;this.tweenOn1=this.scene.tweens.timeline({targets:this.childCont,loop:-1,yoyo:!1,tweens:[{y:-e,ease:"Sine.easeOut",duration:300},{y:e,ease:"Sine.easeInOut",duration:600},{y:0,ease:"Sine.easeIn",duration:300}]})}}},{key:"setTweenDown",value:function(){if(""!==this.tween_down.type)switch(this.tween_down.type){case"scale_down":this.childCont.scale=.92,this.tweenDown1=this.scene.tweens.timeline({targets:this.childCont,tweens:[{scale:.92,ease:"Linear",duration:30},{scale:.92,ease:"Linear",duration:50},{scale:1,ease:"Linear",duration:30}]})}}},{key:"setTweenOver",value:function(){if(""!==this.tween_over.type)switch(this.tween_over.type){case"jelly":if(this.tweenOver1&&this.tweenOver1.progress<.1)return;this.tweenOver1=this.scene.tweens.timeline({targets:this.childCont,tweens:[{scaleY:1.1,ease:"Quad.easeOut",duration:60},{scaleY:1,ease:"Elastic",duration:1500}]}),this.tweenOver2=this.scene.tweens.timeline({targets:this.childCont,tweens:[{scaleX:.9,ease:"Quad.easeOut",duration:60},{scaleX:1,ease:"Elastic",duration:1500}]}),this.tweenOver3=this.scene.tweens.timeline({targets:this.childCont,tweens:[{angle:Phaser.Math.RND.pick([-4,4]),ease:"Quad.easeOut",duration:50},{angle:0,ease:"Quad.easeIn",duration:60}]});break;case"scale":this.tweenOver1=this.scene.tweens.timeline({targets:this.childCont,tweens:[{scale:1.1,ease:"Quad.easeOut",duration:100}]})}}},{key:"setTweenOut",value:function(){if(""!==this.tween_over.type)switch(this.tween_over.type){case"jelly":break;case"scale":this.tweenOver1=this.scene.tweens.timeline({targets:this.childCont,tweens:[{scale:1,ease:"Quad.easeOut",duration:100}]})}}},{key:"resume",value:function(){this.tweenOn1&&this.tweenOn1.resume()}}])&&ji(s.prototype,i),n&&ji(s,n),t}();function Ii(e){return(Ii="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Li(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),s.push.apply(s,i)}return s}function zi(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}function Vi(e,t){for(var s=0;s<t.length;s++){var i=t[s];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function Ui(e){return(Ui=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Fi(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Hi(e,t){return(Hi=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Ni=function(e){function t(e,s){var i,n,r;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),n=this,(i=!(r=Ui(t).call(this,e,0,0))||"object"!==Ii(r)&&"function"!=typeof r?Fi(n):r).scene=e,i.scene.add.existing(Fi(i));return i.options=function(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?Li(s,!0).forEach(function(t){zi(e,t,s[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):Li(s).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))})}return e}({},{init_x:0,init_y:0,anchor_ltrd:"",anchor_weight:[1,1],name:"",children:[],tweens:[]},{},s),i.init_x=i.options.init_x,i.init_x<=1&&i.init_x>0&&(i.init_x=Math.round(i.scene.game.config.width*i.init_x)),i.init_y=i.options.init_y,i.init_y<=1&&i.init_y>0&&(i.init_y=Math.round(i.scene.game.config.height*i.init_y)),i.anchor_ltrd=i.options.anchor_ltrd,i.anchor_weight=i.options.anchor_weight,i.children=i.options.children,i.name=i.options.name,i.create(),i}var s,i,n;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Hi(e,t)}(t,Phaser.GameObjects.Container),s=t,(i=[{key:"create",value:function(){this.x=this.init_x,this.y=this.init_y;for(var e=0;e<this.children.length;e++){var t=this.children[e];this.add(t)}this.scene.scale.refresh()}},{key:"setInitX",value:function(e){this.x=e,this.scene.scale.refresh()}},{key:"setInitY",value:function(e){this.y=e,this.scene.scale.refresh()}}])&&Vi(s.prototype,i),n&&Vi(s,n),t}();function Wi(e){return(Wi="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Ki(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),s.push.apply(s,i)}return s}function Qi(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}function Yi(e,t){for(var s=0;s<t.length;s++){var i=t[s];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function Xi(e){return(Xi=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Ji(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Zi(e,t){return(Zi=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var qi=function(e){function t(e,s){var i,n,r;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),n=this,(i=!(r=Xi(t).call(this,e,0,0))||"object"!==Wi(r)&&"function"!=typeof r?Ji(n):r).scene=e,i.scene.add.existing(Ji(i));return i.options=function(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?Ki(s,!0).forEach(function(t){Qi(e,t,s[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):Ki(s).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))})}return e}({},{init_x:0,init_y:0,key:[],anchor_ltrd:"",anchor_weight:[1,1],name:"",origin:[.5],tweens:[]},{},s),i.init_x=i.options.init_x,i.init_x<=1&&i.init_x>0&&(i.init_x=Math.round(i.scene.game.config.width*i.init_x)),i.init_y=i.options.init_y,i.init_y<=1&&i.init_y>0&&(i.init_y=Math.round(i.scene.game.config.height*i.init_y)),i.anchor_ltrd=i.options.anchor_ltrd,i.anchor_weight=i.options.anchor_weight,i.key="",i.name=i.options.name,i.create(),i}var s,i,n;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Zi(e,t)}(t,Phaser.GameObjects.Sprite),s=t,(i=[{key:"create",value:function(){this.x=this.init_x,this.y=this.init_y;var e=this.options.origin[0],t=this.options.origin.length>1?this.options.origin[1]:e;this.setOrigin(e,t);var s=[1,1];this.options.scale&&(Array.isArray(this.options.scale)||(s=[this.options.scale,this.options.scale]),this.setScale(s[0],s[1])),this.options.rotation&&this.setRotation(this.options.rotation);var i=null,n=[];this.options.key.length>1&&(i=this.options.key[0],this.key=this.options.key[1]),n=i?[{key:i,frame:this.key}]:[{key:this.key}],this.scene.anims.create({key:this.key,frames:n,frameRate:0,repeat:0}),this.play(this.key)}}])&&Yi(s.prototype,i),n&&Yi(s,n),t}();function $i(e){return($i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function en(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),s.push.apply(s,i)}return s}function tn(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}function sn(e,t){for(var s=0;s<t.length;s++){var i=t[s];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function nn(e){return(nn=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function rn(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function an(e,t){return(an=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var on=function(e){function t(e,s){var i,n,r;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),n=this,(i=!(r=nn(t).call(this,e,0,0))||"object"!==$i(r)&&"function"!=typeof r?rn(n):r).scene=e,i.scene.add.existing(rn(i));return i.options=function(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?en(s,!0).forEach(function(t){tn(e,t,s[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):en(s).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))})}return e}({},{init_x:0,init_y:0,key:[],anchor_ltrd:"",anchor_weight:[1,1],name:"",origin:[.5],tweens:[]},{},s),i.key="",i.init_x=i.options.init_x,i.init_x<=1&&i.init_x>0&&(i.init_x=Math.round(i.scene.game.config.width*i.init_x)),i.init_y=i.options.init_y,i.init_y<=1&&i.init_y>0&&(i.init_y=Math.round(i.scene.game.config.height*i.init_y)),i.anchor_ltrd=i.options.anchor_ltrd,i.anchor_weight=i.options.anchor_weight,i.name=i.options.name,i.create(),i}var s,i,n;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&an(e,t)}(t,Phaser.GameObjects.Image),s=t,(i=[{key:"create",value:function(){this.x=this.init_x,this.y=this.init_y;var e=this.options.origin[0],t=this.options.origin.length>1?this.options.origin[1]:e;this.setOrigin(e,t);var s=null;this.options.key.length>1&&(s=this.options.key[0],this.key=this.options.key[1]),s?this.setTexture(s,this.key):this.setTexture(this.key)}}])&&sn(s.prototype,i),n&&sn(s,n),t}();function hn(e){return(hn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ln(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),s.push.apply(s,i)}return s}function un(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}function cn(e,t){for(var s=0;s<t.length;s++){var i=t[s];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function pn(e){return(pn=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function dn(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function fn(e,t){return(fn=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var yn=function(e){function t(e,s){var i,n,r;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),n=this,(i=!(r=pn(t).call(this,e,0,0,"",{}))||"object"!==hn(r)&&"function"!=typeof r?dn(n):r).scene=e,i.scene.add.existing(dn(i));return i.options=function(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?ln(s,!0).forEach(function(t){un(e,t,s[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):ln(s).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))})}return e}({},{init_x:0,init_y:0,text:"",anchor_ltrd:"",anchor_weight:[1,1],name:"",size:[.9,1],origin:[.5],align_v:"center",align_h:"center",font_size:14,weight:"",italic:!1,color:"white"},{},s),i.init_x=i.options.init_x,i.init_x<=1&&i.init_x>0&&(i.init_x=Math.round(i.scene.game.config.width*i.init_x)),i.init_y=i.options.init_y,i.init_y<=1&&i.init_y>0&&(i.init_y=Math.round(i.scene.game.config.height*i.init_y)),i.anchor_ltrd=i.options.anchor_ltrd,i.anchor_weight=i.options.anchor_weight,i.name=i.options.name,i.create(),i}var s,i,n;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&fn(e,t)}(t,Phaser.GameObjects.Text),s=t,(i=[{key:"create",value:function(){this.x=this.init_x,this.y=this.init_y,this.setText(this.options.text);var e=this.options.origin[0],t=this.options.origin.length>1?this.options.origin[1]:e;this.setOrigin(e,t);var s=this.options.size[0],i=this.options.size.length>1?this.options.size[1]:s;this.width=s,this.height=i,this.setAlign(this.options.align_h),this.setFontSize(this.options.font_size),this.setFontStyle(this.options.weight),this.setColor(this.options.color)}}])&&cn(s.prototype,i),n&&cn(s,n),t}();function mn(e){return(mn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function vn(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),s.push.apply(s,i)}return s}function _n(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}function gn(e,t){for(var s=0;s<t.length;s++){var i=t[s];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function bn(e){return(bn=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function wn(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function kn(e,t){return(kn=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var On=function(e){function t(e,s){var i,n,r;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),n=this,(i=!(r=bn(t).call(this,e,0,0))||"object"!==mn(r)&&"function"!=typeof r?wn(n):r).scene=e,i.scene.add.existing(wn(i));return i.options=function(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?vn(s,!0).forEach(function(t){_n(e,t,s[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):vn(s).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))})}return e}({},{init_x:0,init_y:0,font:"white",text:'Destroy all <font="white" size=60>RED</>\n and <font="yellow" size=50>GREEN</>',anchor_ltrd:"",anchor_weight:[1,1],name:"",size:[.9,1],origin:[.5],align_v:"center",align_h:"center",font_size:16,line_height:40},{},s),i.init_x=i.options.init_x,i.init_x<=1&&i.init_x>0&&(i.init_x=Math.round(i.scene.game.config.width*i.init_x)),i.init_y=i.options.init_y,i.init_y<=1&&i.init_y>0&&(i.init_y=Math.round(i.scene.game.config.height*i.init_y)),i.anchor_ltrd=i.options.anchor_ltrd,i.anchor_weight=i.options.anchor_weight,i.origin=i.options.origin,i.originX_=i.origin[0],i.originY_=i.origin.length>1?i.origin[1]:i.originX_,i.font=i.options.font,i.font_size=i.options.font_size,i.text=i.options.text,i.align_h=i.options.align_h,i.line_height=i.options.line_height,i.name=i.options.name,i.lines=new Map,i.boundingBox={left:0,right:0,top:0,bottom:0,width:0,height:0},i.create(i.text),i}var s,i,n;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&kn(e,t)}(t,Phaser.GameObjects.Container),s=t,(i=[{key:"create",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.text;this.removeAll(!0),this.x=this.init_x,this.y=this.init_y;for(var t=null==e?"":String(e),s=t.split(/</gi),i=[],n=0;n<s.length;n++){var r=s[n].replace(/\/>/gi,""),a={text:r,font:this.font,size:this.font_size,alpha:1,line:0},o=r.split(/>/i);if(o.length){o=o[0],a.text=o;var h=r.match(/font\s*=\s*\"[^\"]+\"/gi);h&&(h=h[0].match(/"(.*?)"/gi))&&(h=(h=h[0].replace(/"/gi,"")).replace(/^\s*|\s*$/gi,""),a.font=h);var l=r.match(/size\s*=\s*[\"\'\d]+/gi);l&&(l=l[0].match(/\d+/gi))&&(a.size=Number(l[0]));var u=r.match(/alpha\s*=\s*[\"\'\d\.]+/gi);u&&(u=u[0].match(/[\d\.]+/gi))&&(a.alpha=Number(u[0]))}""!==r&&i.push(a)}for(var c=0,p=[],d=0;d<i.length;d++){var f=i[d];f.line=c;var y=f.text,m=y.split(/[\n]/);if(m.length>1){for(var v=0;v<m.length;v++)if(v>0&&(c+=1),""!==m[v]){var _={text:m[v].replace(/^\s/i,""),font:f.font,size:f.size,alpha:f.alpha,line:c};p.push(_)}}else p.push(f)}c=0;var g=0,b=0,w=0,k=0,O=0,S=0;this.lines.clear();for(var P=[],M=0;M<p.length;M++){var x=p[M],T=x.text,C=x.line;c!==C&&(0===c&&(S=O/2),this.lines.set(c,{line_width:g,line_height:O,parts:P}),w=Math.max(w,g),k+=O/2+this.line_height,O=0,P=[],c=C,b+=this.line_height,g=0);var E=this.scene.add.bitmapText(g,b,x.font,T,x.size);E.setAlpha(x.alpha),E.setOrigin(0,.5);var A=E.getTextBounds();g+=A.local.width,O=Math.max(O,A.local.height),P.push(E),this.add(E)}this.lines.set(c,{line_width:g,line_height:O,parts:P}),c>0?k+=O/2:(S=O/2,k=O);var j=!0,B=!1,D=void 0;try{for(var R,G=this.lines.values()[Symbol.iterator]();!(j=(R=G.next()).done);j=!0){var I=R.value,L=-w*this.originX_,z=-k*this.originY_;this.boundingBox={left:L,right:L+w,top:z,bottom:z+k,width:w,height:k};var V=0;"center"===this.align_h?V=(w-I.line_width)/2:"right"===this.align_h&&(V=w-I.line_width);for(var U=0;U<I.parts.length;U++){var F=I.parts[U];F.x+=L+V,F.y+=z+S}}}catch(e){B=!0,D=e}finally{try{j||null==G.return||G.return()}finally{if(B)throw D}}}},{key:"setText",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.text;this.text=e,this.create(this.text)}},{key:"setInitX",value:function(e){this.x=e,this.scene.scale.refresh()}},{key:"setInitY",value:function(e){this.y=e,this.scene.scale.refresh()}},{key:"getTextBounds",value:function(){}}])&&gn(s.prototype,i),n&&gn(s,n),t}();function Sn(e,t){for(var s=0;s<t.length;s++){var i=t[s];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var Pn=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.scene=t}var t,s,i;return t=e,(s=[{key:"addContainer",value:function(e){return new Ni(this.scene,e)}},{key:"addButton",value:function(e){return new Gi(this.scene,e)}},{key:"addSprite",value:function(e){return new qi(this.scene,e)}},{key:"addImage",value:function(e){return new on(this.scene,e)}},{key:"addText",value:function(e){return new yn(this.scene,e)}},{key:"addBitmapText",value:function(e){return new xi(this.scene,e)}},{key:"addColoredBitmapText",value:function(e){return new On(this.scene,e)}}])&&Sn(t.prototype,s),i&&Sn(t,i),e}();function Mn(e){return(Mn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function xn(e,t){for(var s=0;s<t.length;s++){var i=t[s];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function Tn(e){return(Tn=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Cn(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function En(e,t){return(En=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var An=function(e){function t(e,s,i){var n,r,a;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),r=this,(n=!(a=Tn(t).call(this,e,s,i))||"object"!==Mn(a)&&"function"!=typeof a?Cn(r):a).scene=e,n.scene.add.existing(Cn(n)),n.iconHeight=32,n.playerID=0,n.count=0,n.lifetime=0,n.blinktime=0,n.timeRemain=0,n.is_permanent=!1,n.enable=!1,n.countTextMarginLR=10,n.panelsManager=new Pn(n.scene),n.iconOff=null,n.icon=null,n.countText=null,n.blink=new E(n.scene,Cn(n)),n.create(),n}var s,i,n;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&En(e,t)}(t,Phaser.GameObjects.Container),s=t,(i=[{key:"create",value:function(){this.iconOff=this.scene.add.image(0,0),this.icon=this.scene.add.image(0,0),this.countText=this.panelsManager.addBitmapText({text:"",init_x:0,init_y:0,font_size:36,font:"white",origin:[.5]}),this.countText.setVisible(!1),this.add(this.iconOff),this.add(this.icon),this.add(this.countText)}},{key:"setIcon",value:function(e,t,s){this.iconOff.setTexture("atlas_objects","powerups/ui_"+t+"_off.png"),this.icon.setTexture("atlas_objects","powerups/ui_"+t+".png"),this.iconHeight=this.icon.height,this.setCrop(),this.setPlayerID(e),this.setCount(s)}},{key:"setPlayerID",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.playerID;this.playerID=e,this.iconOff.setOrigin(0===e?0:1,0),this.icon.setOrigin(0===e?0:1,0),this.countText.init_x=(this.icon.width+this.countTextMarginLR)*(0===e?1:-1),this.countText.x=this.countText.init_x,this.countText.init_y=Math.round(.9*this.icon.height),this.countText.y=this.countText.init_y,this.countText.setOrigin(0===e?0:1,.5)}},{key:"setCount",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.count;this.count=e,this.countText.setVisible(!1),this.count>1&&(this.countText.text=0===this.playerID?"x"+this.count:this.count+"x",this.countText.setVisible(!0))}},{key:"setLifetime",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.lifetime;this.lifetime=e}},{key:"setBlinktime",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.blinktime;this.blinktime=e}},{key:"setTimeRemain",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.timeRemain;this.timeRemain=e;var t=Phaser.Math.Clamp(1,0,Math.unlerp(this.lifetime,0,this.timeRemain));this.setCrop(t),this.blinktime&&this.blink.flashFromTimeRemain(this.timeRemain,this.blinktime)}},{key:"setCrop",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;this.icon.setCrop(0,Math.round(e*this.icon.height),this.icon.width,this.icon.height)}},{key:"start",value:function(){this.enable=!0}},{key:"pause",value:function(){this.enable=!1}},{key:"show",value:function(){this.setActive(!0),this.setVisible(!0),this.setAlpha(1)}},{key:"hide",value:function(){this.enable=!1,this.setActive(!1),this.setVisible(!1)}}])&&xn(s.prototype,i),n&&xn(s,n),t}();function jn(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),s.push.apply(s,i)}return s}function Bn(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?jn(s,!0).forEach(function(t){Dn(e,t,s[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):jn(s).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))})}return e}function Dn(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}function Rn(e,t){for(var s=0;s<t.length;s++){var i=t[s];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var Gn=function(){function e(t,s){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.scene=t;this.options=Bn({},{},{},s),this.panelsManager=new Pn(this.scene),this.blink=new E(this.scene),this.powerupsCont=[],this.containerOffsetY=106,this.childContMarginLR=15,this.childContMarginTB=10,this.playersCount=1,this.iconHeight=32,this.iconGroup=this.scene.add.group({classType:An,maxSize:20,runChildUpdate:!0,active:!1,visible:!1}),this.create()}var t,s,i;return t=e,(s=[{key:"create",value:function(){for(var e=0;e<this.playersCount;e++){var t=e;this.powerupsCont[t]={container:null,powerups:[]},this.powerupsCont[t].container=this.panelsManager.addContainer({init_x:0===t?0:1,init_y:this.containerOffsetY,anchor_ltrd:0===t?"lt":"rt",anchor_weight:[1,1],name:"",children:[]})}}},{key:"setMode",value:function(){arguments.length>0&&void 0!==arguments[0]&&arguments[0]}},{key:"addPowerup",value:function(e){for(var t=(e=Bn({},{player_id:0,type:"",count:0,lifetime:null,time_remain:null,blinktime:0},{},e)).player_id,s=e.type,i=e.count,n=e.lifetime,r=e.time_remain,a=e.blinktime,o=this.powerupsCont[t].container,h=this.powerupsCont[t].powerups,l=null,u=0;u<h.length;u++)if(h[u].hasOwnProperty("type")&&h[u].type===s){l=h[u];break}var c=null;return l?c=l.go:(l={type:s,go:null,count:i},(c=this.iconGroup.get())&&(l.go=c,h.push(l),c.setIcon(t,s,l.count),this.iconHeight=c.iconHeight,c.x=this.childContMarginLR*(0===t?1:-1),c.y=this.getPosYFromInd(h.length-1,c.icon.height),o.add(c),c.show())),c.setLifetime(n),c.setBlinktime(a),c.setTimeRemain(r),c}},{key:"removePowerup",value:function(e){var t=(e=Bn({},{player_id:0,type:""},{},e)).player_id,s=e.type;if(""!==s&&!(t>=this.powerupsCont.length))for(var i=this.powerupsCont[t].container,n=this.powerupsCont[t].powerups,r=n.length-1;r>=0;r--){if(n[r].hasOwnProperty("type")&&n[r].type===s){i.remove(n[r].go),n[r].go.hide(),n.splice(r,1);break}n[r].hasOwnProperty("go")&&null!==n[r].go&&this.scene.tweens.timeline({targets:n[r].go,tweens:[{y:this.getPosYFromInd(r-1,n[r].go.icon.height),ease:"Quad.easeInOut",duration:300}]})}}},{key:"setPowerupCount",value:function(e,t,s){}},{key:"getPosYFromInd",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.iconHeight;return Math.max(0,e*(t+(e>0?this.childContMarginTB:0)))}},{key:"reset",value:function(){if(this.powerupsCont.length>0)for(var e=0;e<this.powerupsCont.length;e++)for(var t=this.powerupsCont[e].powerups,s=t.length-1;s>=0;s--)this.removePowerup({player_id:e,type:t[s].type})}}])&&Rn(t.prototype,s),i&&Rn(t,i),e}();function In(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),s.push.apply(s,i)}return s}function Ln(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?In(s,!0).forEach(function(t){zn(e,t,s[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):In(s).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))})}return e}function zn(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}function Vn(e,t){for(var s=0;s<t.length;s++){var i=t[s];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var Un=function(){function e(t){var s=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.scene=t,this.uid=0,this.uidDestroyed=0,this.uidDestroyedTypes={},this.uidHash={},this.aliveCount=0,this.destroyed=0,this.destroyedTypes={},this.category="powerups",this.type="common_options",this.powerup_lifetime=3e4,this.powerup_blinktime=1e4,this.dropped_lifetime=3e4,this.dropped_blinktime=1e4,this.is_drop_from_enemies=!0,this.is_drop_from_ast=!0,this.is_drop_each_ast_part=!0,this.is_magnet=!0,this.magnet_radius=60,this.ui=this.scene.ui,this.ingamePowerups=new Gn(this.ui),this.shield=new z(this.scene),this.doubleShot=new Oe(this.scene),this.tripleShot=new Ae(this.scene),this.quadrupleShot=new Ve(this.scene),this.backShot=new Xe(this.scene),this.thrusters=new it(this.scene),this.reverseThrusters=new ct(this.scene),this.brakes=new gt(this.scene),this.fireRate=new xt(this.scene),this.shotDistance=new Rt(this.scene),this.bulletSize=new Ht(this.scene),this.fastAcceleration=new qt(this.scene),this.fastShot=new os(this.scene),this.bomb=new ms(this.scene),this.extraLife=new _s(this.scene),this.lifeRefill=new bs(this.scene),this.increaseScore=new ks(this.scene),this.blastRadius=new Hs(this.scene),this.drillBit=new qs(this.scene),this.freeze=new pi(this.scene),this.powerupDropGroup=this.scene.physics.add.group({classType:gi,maxSize:50,runChildUpdate:!0,active:!1,visible:!1}),this.dropIconToShipOverlap=this.scene.physics.add.overlap(this.scene.shipsGroup,this.powerupDropGroup,function(e,t){var i,n;e instanceof gi?(n=e,i=t):(n=t,i=e),s.is_magnet?n.isMagneted?(s.applyPowerup(n.type,{ship:i}),n.hide()):(n.isMagneted=!0,n.set_collider(),n.magnetedShip=i):(s.applyPowerup(n.type,{ship:i}),n.hide())}),b.addEditorEmmiter.call(this,function(e){})}var t,s,i;return t=e,(s=[{key:"lootChooser",value:function(e){e=Ln({},{x:0,y:0,velocity:{x:0,y:0},from:"asteroid",type:"red",chance:1},{},e);var t=this.scene.wavesManager.prepared_powerups,s=Phaser.Math.Clamp(e.chance,0,1),i=s>0?t.comulative/s:-1,n="",r=Phaser.Math.Between(1,i);i>=0&&(n=function(e,t){var s="";for(var i in e)if(t>e[i].from&&t<=e[i].to){s=i;break}return s}(t.loot,r)),""!==n&&"nothing"!==n&&this.scene.powerupManager.dropPowerup(e.x,e.y,n,e.velocity)}},{key:"dropPowerup",value:function(e,t,s){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{x:0,y:0},n=this.powerupDropGroup.get();n&&(this.uid++,n.lifetime=this.dropped_lifetime,n.blinktime=this.dropped_blinktime,this.uidHash.hasOwnProperty(this.uid)||(this.uidHash[this.uid]=0),this.uidDestroyedTypes.hasOwnProperty(s)||(this.uidDestroyedTypes[s]=0),this.destroyedTypes.hasOwnProperty(s)||(this.destroyedTypes[s]=0),n.spawn(s,e,t,{parentVelocity:i,uid:this.uid}))}},{key:"applyPowerup",value:function(e,t){if(e){var s=(t=Ln({},{ship:null,add:null,lvl:0},{},t)).ship;if(s){var i=t.add,n=t.lvl;switch(e){case"shield":this.shield.apply(s,{add:i});break;case"double_shot":this.doubleShot.apply(s,{add:i});break;case"triple_shot":this.tripleShot.apply(s,{add:i});break;case"quadruple_shot":this.quadrupleShot.apply(s,{add:i});break;case"back_shot":this.backShot.apply(s,{add:i});break;case"thrusters":this.thrusters.apply(s,{add:i,lvl:n});break;case"reverse_thrusters":this.reverseThrusters.apply(s,{add:i,lvl:n});break;case"brakes":this.brakes.apply(s,{add:i,lvl:n});break;case"fire_rate":this.fireRate.apply(s,{add:i,lvl:n});break;case"shot_distance":this.shotDistance.apply(s,{add:i,lvl:n});break;case"bullet_size":this.bulletSize.apply(s,{add:i,lvl:n});break;case"fast_shot":this.fastShot.apply(s,{add:i});break;case"fast_acceleration":this.fastAcceleration.apply(s,{add:i});break;case"spawn_drone":break;case"drill_bit":this.drillBit.apply(s,{add:i});break;case"bomb":this.bomb.apply(s,{add:i});break;case"homing_missle":case"laser":break;case"freeze":this.freeze.apply(s,{add:i});break;case"increase_score":this.increaseScore.apply(s,{add:i});break;case"extra_life":this.extraLife.apply(s,{add:i});break;case"life_refill":this.lifeRefill.apply(s,{add:i});break;case"blast_radius":this.blastRadius.apply(s,{add:i})}}}}},{key:"reset",value:function(){this.powerupDropGroup.getChildren().forEach(function(e){e.setActive(!1),e.setVisible(!1),e.body.setEnable(!1)}),this.shield.reset(),this.doubleShot.reset(),this.tripleShot.reset(),this.quadrupleShot.reset(),this.backShot.reset(),this.thrusters.reset(),this.reverseThrusters.reset(),this.brakes.reset(),this.fireRate.reset(),this.shotDistance.reset(),this.bulletSize.reset(),this.fastAcceleration.reset(),this.fastShot.reset(),this.bomb.reset(),this.extraLife.reset(),this.lifeRefill.reset(),this.increaseScore.reset(),this.blastRadius.reset(),this.freeze.reset(),this.drillBit.reset(),this.scene.ships.forEach(function(e){e.powerups={}}),this.ingamePowerups.reset(),this.uid=0,this.uidDestroyed=0,this.uidDestroyedTypes={},this.uidHash={},this.aliveCount=0,this.destroyed=0,this.destroyedTypes={}}},{key:"addPowerupUI",value:function(e){return this.ingamePowerups.addPowerup(e)}},{key:"removePowerup",value:function(e,t){t.powerups.hasOwnProperty(e)&&(t.powerups[e].hasOwnProperty("go")&&t.powerups[e].go.stop(),t.powerups[e].hasOwnProperty("go2")&&t.powerups[e].go2.hide(),t.powerups[e].hasOwnProperty("uigo")&&this.ingamePowerups.removePowerup({player_id:t.playerID,type:e}),delete t.powerups[e],"bomb"!==e&&"freeze"!==e||this.scene.mobileJoystick&&(this.scene.mobileJoystick.bombBtn.setActive(!1),this.scene.mobileJoystick.bombBtn.setVisible(!1)))}},{key:"setPowerupCount",value:function(e,t,s){s.powerups.hasOwnProperty(e)&&(t<=0?this.removePowerup(e,s):s.powerups[e].hasOwnProperty("uigo")&&(s.powerups[e].uigo.setCount(t),s.powerups[e].time_remain=s.powerups[e].uigo.lifetime,this.applyPowerup(e,{ship:s,add:0})))}},{key:"set_dropped_lifetime",value:function(e){return this.dropped_lifetime=e,e}},{key:"set_dropped_blinktime",value:function(e){return this.dropped_blinktime=e,e}},{key:"set_powerup_lifetime",value:function(e){return this.powerup_lifetime=e,e}},{key:"set_powerup_blinktime",value:function(e){return this.powerup_blinktime=e,e}},{key:"set_is_drop_from_enemies",value:function(e){return this.is_drop_from_enemies=e,e}},{key:"set_is_drop_from_ast",value:function(e){return this.is_drop_from_ast=e,e}},{key:"set_is_drop_each_ast_part",value:function(e){return this.is_drop_each_ast_part=e,e}},{key:"set_is_magnet",value:function(e){return this.is_magnet=e,e}},{key:"set_magnet_radius",value:function(e){return this.magnet_radius=e,e}}])&&Vn(t.prototype,s),i&&Vn(t,i),e}();function Fn(e){return(Fn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Hn(e,t){for(var s=0;s<t.length;s++){var i=t[s];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function Nn(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Wn(e,t,s){return(Wn="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,s){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Kn(e)););return e}(e,t);if(i){var n=Object.getOwnPropertyDescriptor(i,t);return n.get?n.get.call(s):n.value}})(e,t,s||e)}function Kn(e){return(Kn=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Qn(e,t){return(Qn=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Yn=function(e){function t(e,s,i){var n,r,a;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),r=this,a=Kn(t).call(this,e,s,i),(n=!a||"object"!==Fn(a)&&"function"!=typeof a?Nn(r):a).scene=e,n.scene.add.existing(Nn(n)),n.velocity=null,n.slowdown=null,n.on("animationcomplete",function(){n.hide()},Nn(n)),n}var s,i,n;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Qn(e,t)}(t,Phaser.GameObjects.Sprite),s=t,(i=[{key:"show",value:function(){this.setActive(!0),this.setVisible(!0),this.setAlpha(1)}},{key:"hide",value:function(){this.setActive(!1),this.setVisible(!1),this.velocity=null,this.slowdown=null}},{key:"preUpdate",value:function(e,s){if(Wn(Kn(t.prototype),"preUpdate",this).call(this,e,s),null!==this.velocity&&null!==this.slowdown){var i=.001*s;this.velocity.x*=this.slowdown,this.velocity.y*=this.slowdown,this.x+=this.velocity.x*i,this.y+=this.velocity.y*i}}}])&&Hn(s.prototype,i),n&&Hn(s,n),t}();function Xn(e){return(Xn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Jn(e,t){for(var s=0;s<t.length;s++){var i=t[s];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function Zn(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function qn(e,t,s){return(qn="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,s){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=$n(e)););return e}(e,t);if(i){var n=Object.getOwnPropertyDescriptor(i,t);return n.get?n.get.call(s):n.value}})(e,t,s||e)}function $n(e){return($n=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function er(e,t){return(er=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var tr=function(e){function t(e,s,i){var n,r,a;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),r=this,a=$n(t).call(this,e,s,i),(n=!a||"object"!==Xn(a)&&"function"!=typeof a?Zn(r):a).scene=e,n.scene.add.existing(Zn(n)),n.speed=50,n.moveRot=0,n.shipVel={x:0,y:0},n.slowdown=.98,n.velocity={x:0,y:0},n.size=1,n.on("animationcomplete",function(){n.hide()},Zn(n)),n}var s,i,n;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&er(e,t)}(t,Phaser.GameObjects.Sprite),s=t,(i=[{key:"show",value:function(){this.setActive(!0),this.setVisible(!0),this.setAlpha(1),this.setScale(Phaser.Math.FloatBetween(.8,1.2)*this.size),this.velocity.x=-Math.cos(this.moveRot)*this.speed,this.velocity.y=-Math.sin(this.moveRot)*this.speed,this.velocity.x+=this.shipVel.x,this.velocity.y+=this.shipVel.y}},{key:"hide",value:function(){this.setActive(!1),this.setVisible(!1),this.moveRot=0,this.shipVel={x:0,y:0},this.velocity={x:0,y:0}}},{key:"preUpdate",value:function(e,s){qn($n(t.prototype),"preUpdate",this).call(this,e,s);var i=.001*s;this.velocity.x*=this.slowdown,this.velocity.y*=this.slowdown,this.x+=this.velocity.x*i,this.y+=this.velocity.y*i}}])&&Jn(s.prototype,i),n&&Jn(s,n),t}();function sr(e){return(sr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ir(e,t){for(var s=0;s<t.length;s++){var i=t[s];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function nr(e){return(nr=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function rr(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function ar(e,t){return(ar=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var or=function(e){function t(e,s,i){var n,r,a;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),r=this,(n=!(a=nr(t).call(this,e,s,i))||"object"!==sr(a)&&"function"!=typeof a?rr(r):a).scene=e,n.scene.add.existing(rr(n)),n.speed=0,n.scale2=0,n.unlerpPos=0,n.offsetX=0,n.offsetY=0,n.screenCenterX=0,n.screenCenterY=0,n.startUnlerpAlpha=0,n.endUnlerpAlpha=0,n}var s,i,n;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ar(e,t)}(t,Phaser.GameObjects.Image),s=t,(i=[{key:"spawn",value:function(e,t,s,i){}},{key:"show",value:function(){this.setActive(!0),this.setVisible(!0)}},{key:"hide",value:function(){this.setActive(!1),this.setVisible(!1),this.setScale(0)}},{key:"preUpdate",value:function(e,t){this.updateEffect(t)}},{key:"updateEffect",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:16.6666;this.unlerpPos=Math.unlerp(0,7.75,this.scale2);var t=Phaser.Math.Clamp(Math.unlerp(this.startUnlerpAlpha,this.endUnlerpAlpha,this.unlerpPos),0,1);this.setAlpha(t);var s=Math.lerp(.7,.8,this.scale2);this.setScale(s),this.x=Math.lerp(this.screenCenterX+.02*this.offsetX,this.screenCenterX+7.7*this.offsetX,this.unlerpPos),this.y=Math.lerp(this.screenCenterY+.02*this.offsetY,this.screenCenterY+7.7*this.offsetY,this.unlerpPos),this.scale2+=(.001+.05*Math.pow(this.scale2,2))*(.06*e)*this.speed,this.scale2>7&&this.hide()}}])&&ir(s.prototype,i),n&&ir(s,n),t}();function hr(e){return(hr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function lr(e,t){for(var s=0;s<t.length;s++){var i=t[s];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function ur(e){return(ur=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function cr(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function pr(e,t){return(pr=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var dr=function(e){function t(e,s,i){var n,r,a;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),r=this,(n=!(a=ur(t).call(this,e,s,i,"aller_yellow"))||"object"!==hr(a)&&"function"!=typeof a?cr(r):a).scene=e,n.scene.add.existing(cr(n)),n.tween=null,n.tween1=null,n.blink=new E(n.scene,cr(n)),n}var s,i,n;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&pr(e,t)}(t,Phaser.GameObjects.BitmapText),s=t,(i=[{key:"runTween",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"asteroid";this.blink.stop(),this.setAlpha(0),"asteroid"===t?this.tween1=this.scene.tweens.timeline({targets:this,tweens:[{delay:16,alpha:1,ease:"Linear",duration:0},{y:"-=50",ease:"Quintic.Out",duration:1e3},{alpha:0,ease:"Quintic.Out",duration:400,offset:"-=900"}],onComplete:function(t){e.hide()}}):(this.tween1=this.scene.tweens.timeline({targets:this,tweens:[{delay:16,alpha:{start:0,from:0,to:1},ease:"Linear",duration:300},{scale:{start:1.3,from:1.3,to:1},ease:"Quart.easeIn",duration:300,offset:"-=300"},{y:"-=50",ease:"Quart.easeIn",duration:1200},{alpha:0,ease:"Quintic.Out",duration:400,offset:"-=600"}],onComplete:function(t){e.hide()}}),this.blink.start({wait:400,duration:800,on_time:100,off_time:100,steps:[]},function(){e.setVisible(!0)}))}},{key:"show",value:function(){this.setActive(!0),this.setVisible(!0)}},{key:"hide",value:function(){this.setActive(!1),this.setVisible(!1),this.tween1&&this.tween1.stop()}},{key:"preUpdate",value:function(e,t){}}])&&lr(s.prototype,i),n&&lr(s,n),t}();function fr(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),s.push.apply(s,i)}return s}function yr(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?fr(s,!0).forEach(function(t){mr(e,t,s[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):fr(s).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))})}return e}function mr(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}function vr(e,t){for(var s=0;s<t.length;s++){var i=t[s];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var _r=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.scene=t,this.textEffectItems=[],this.tweensItems=[],this.timerBackgroundStars=null,this.backgroundStarsGroup=this.scene.add.group({classType:or,maxSize:100,runChildUpdate:!0,active:!1,visible:!1}),this.explodesGroup=this.scene.add.group({classType:Yn,maxSize:200,runChildUpdate:!0,active:!1,visible:!1});for(var s=0;s<20;s++)this.explodesGroup.get();this.explodesGroup.children.iterate(function(e){e.hide(!0)}),this.trackGroup=this.scene.add.group({classType:tr,maxSize:200,runChildUpdate:!0,active:!1,visible:!1}),this.scoresGroup=this.scene.add.group({classType:dr,maxSize:100,runChildUpdate:!0,active:!1,visible:!1});for(var i=0;i<20;i++)this.scoresGroup.get();this.scoresGroup.children.iterate(function(e){e.hide(!0)}),this.backgroundStarsEffect(!0)}var t,s,i;return t=e,(s=[{key:"spawnEffect",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,s=arguments.length>2?arguments[2]:void 0,i=arguments.length>3?arguments[3]:void 0,n={scale:1,velocity:null,slowdown:.9};switch(i=yr({},n,{},i),s){case"light_blue_explode_1":this.spawnSprite(e,t,"light_blue_explode_1",i);break;case"light_blue_explode_2":this.spawnSprite(e,t,"light_blue_explode_2",i);break;case"light_blue_explode_3":this.spawnSprite(e,t,"light_blue_explode_3",i);break;case"white_explode_1":this.spawnSprite(e,t,"white_explode_1",i);break;case"white_explode_2":this.spawnSprite(e,t,"white_explode_2",i);break;case"white_explode_3":this.spawnSprite(e,t,"white_explode_3",i);break;case"red_explode_1":this.spawnSprite(e,t,"red_explode_1",i);break;case"red_explode_2":this.spawnSprite(e,t,"red_explode_2",i);break;case"red_explode_3":this.spawnSprite(e,t,"red_explode_3",i);break;case"green_explode_1":this.spawnSprite(e,t,"green_explode_1",i);break;case"green_explode_2":this.spawnSprite(e,t,"green_explode_2",i);break;case"green_explode_3":this.spawnSprite(e,t,"green_explode_3",i);break;case"yellow_explode_1":this.spawnSprite(e,t,"yellow_explode_1",i);break;case"yellow_explode_2":this.spawnSprite(e,t,"yellow_explode_2",i);break;case"yellow_explode_3":this.spawnSprite(e,t,"yellow_explode_3",i);break;case"blue_explode_1":this.spawnSprite(e,t,"blue_explode_1",i);break;case"blue_explode_2":this.spawnSprite(e,t,"blue_explode_2",i);break;case"blue_explode_3":this.spawnSprite(e,t,"blue_explode_3",i);break;case"ship_1_explode":this.spawnSprite(e,t,"ship_1_explode",i);break;case"ufo_1_explode":this.spawnSprite(e,t,"ufo_1_explode",i);break;case"ufo_2_explode":this.spawnSprite(e,t,"ufo_2_explode",i);break;case"shield_explode":this.spawnSprite(e,t,"shield_explode",i);break;case"bullet_explode":this.spawnSprite(e,t,"bullet_explode",i);break;case"scores_asteroid_1":this.spawnScores(e,t,"asteroid",i);break;case"scores_enemy_1":this.spawnScores(e,t,"enemy",i);break;case"wrong_color":this.spawnWrongColor(e,t,i.text,i.font_size);break;case"powerup_picked":this.spawnPowerupPicked(e,t,i.powerup)}}},{key:"spawnSprite",value:function(e,t,s,i){i=yr({},{scale:1},{},i);var n=this.explodesGroup.get();n&&(n.x=Math.round(e),n.y=Math.round(t),n.rotation=i.hasOwnProperty("rotation")?i.rotation:Phaser.Math.RND.rotation(),n.setScale(i.scale),n.setDepth(20),n.play(s),n.show())}},{key:"spawnTrack",value:function(e,t,s,i){var n=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1,r=this.trackGroup.get();r&&(r.moveRot=s,r.shipVel=i,r.size=n,r.x=e,r.y=t,r.rotation=Phaser.Math.RND.rotation(),r.setDepth(8),r.play("ship_track"),r.show())}},{key:"spawnScores",value:function(e,t,s,i){i=yr({},{scores:1,ast_size:0},{},i);var n=this.scoresGroup.get();if(n){n.x=e,n.y=t,n.setText("+"+i.scores),n.setOrigin(.5),n.setDepth(20);var r=9;"asteroid"===s?r=[16,17,18][i.ast_size]:"enemy"===s&&(r=18,"ufo_2"===i.enemy_type&&(r=20)),n.setFontSize(r),n.show(),n.runTween(s)}}},{key:"spawnWrongColor",value:function(e,t){var s=this,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"WRONG COLOR",n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:22,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"aller_red",a=this.scene.add.bitmapText(0,0,r,"");a.setText(i),a.setFontSize(n),a.setOrigin(.5,0);var o=a.getTextBounds(),h=.6*o.local.width,l=3*o.local.height,u=Phaser.Math.Clamp(e,this.scene.cameras.main.worldView.left+h,this.scene.cameras.main.worldView.right-h),c=Phaser.Math.Clamp(t,this.scene.cameras.main.worldView.top+l,this.scene.cameras.main.worldView.bottom-l),p=this.scene.add.container(u,c);p.add(a),p.setDepth(20),p.setAlpha(0),p.uid=Phaser.Math.Between(0,1e4),this.textEffectItems.push(p),p.tweenAnim=this.scene.tweens.timeline({targets:p,tweens:[{delay:100,alpha:{start:0,from:0,to:1},ease:"Linear",duration:200},{scale:{start:1.2,from:1.2,to:1},ease:"Quart.easeIn",duration:300,offset:"-=200",onComplete:function(e){s.scene.tweens.addCounter({from:0,to:1,ease:"Linear",duration:30,loop:14,onStart:function(){a.setPosition(Phaser.Math.Between(-2,2),Phaser.Math.Between(-2,2))},onLoop:function(){a.setPosition(Phaser.Math.Between(-2,2),Phaser.Math.Between(-2,2))}},s)}},{scale:1,ease:"Linear",duration:600},{y:"-=50",ease:"Quart.easeIn",duration:1500},{alpha:0,ease:"Quintic.Out",duration:400,offset:"-=500"}],onComplete:function(e){p.destroy(),e.destroy(),s.removeTextFromArray(p.uid)}})}},{key:"spawnAddTime",value:function(e,t){var s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"+3 sec",i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,n=arguments.length>4&&void 0!==arguments[4]?arguments[4]:22,r=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"aller_green",a=this.scene.add.bitmapText(0,0,r,"");a.setText(s),a.setFontSize(n),a.setOrigin(.5,0);var o=a.getTextBounds(),h=.6*o.local.width,l=3*o.local.height,u=Phaser.Math.Clamp(e,this.scene.cameras.main.worldView.left+h,this.scene.cameras.main.worldView.right-h),c=Phaser.Math.Clamp(t,this.scene.cameras.main.worldView.top+l,this.scene.cameras.main.worldView.bottom-l),p=this.scene.add.container(u,c);p.add(a),p.setDepth(20),p.setAlpha(0),this.scene.tweens.timeline({targets:p,tweens:[{delay:50+i,alpha:{start:0,from:0,to:1},ease:"Linear",duration:100},{y:"-=3",ease:"Quart.easeIn",duration:500},{alpha:0,ease:"Quintic.Out",duration:200,offset:"-=200"}],onComplete:function(e){p.destroy()}})}},{key:"spawnLivesLeft",value:function(e,t){var s=this,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"2 Lives Left!",n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:22,a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"aller_white",o=this.scene.add.bitmapText(0,0,a,"");o.setText(i),o.setFontSize(r),o.setOrigin(.5,0);var h=o.getTextBounds(),l=.6*h.local.width,u=3*h.local.height,c=Phaser.Math.Clamp(e,this.scene.cameras.main.worldView.left+l,this.scene.cameras.main.worldView.right-l),p=Phaser.Math.Clamp(t,this.scene.cameras.main.worldView.top+u,this.scene.cameras.main.worldView.bottom-u),d=this.scene.add.container(c,p);d.add(o),d.setDepth(20),d.setAlpha(0),d.uid=Phaser.Math.Between(0,1e4),this.textEffectItems.push(d),d.tweenAnim=this.scene.tweens.timeline({targets:d,tweens:[{delay:100+n,alpha:{start:0,from:0,to:1},ease:"Linear",duration:200},{scale:{start:1.2,from:1.2,to:1},ease:"Quart.easeIn",duration:300,offset:"-=200",onComplete:function(e){s.scene.tweens.addCounter({from:0,to:1,ease:"Linear",duration:30,loop:14,onStart:function(){o.setPosition(Phaser.Math.Between(-2,2),Phaser.Math.Between(-2,2))},onLoop:function(){o.setPosition(Phaser.Math.Between(-2,2),Phaser.Math.Between(-2,2))}},s)}},{scale:1,ease:"Linear",duration:600},{y:"-=20",ease:"Quart.easeIn",duration:1500},{alpha:0,ease:"Quintic.Out",duration:400,offset:"-=500"}],onComplete:function(e){d.destroy(),e.destroy(),s.removeTextFromArray(d.uid)}})}},{key:"spawnBlasterDisabled",value:function(e,t){var s=this,i=this.scene.add.bitmapText(0,0,"aller_yellow","");i.setText("BLASTERS DISABLED"),i.setFontSize(16),i.setOrigin(.5,0);var n=i.getTextBounds(),r=.6*n.local.width,a=3*n.local.height,o=Phaser.Math.Clamp(e,this.scene.cameras.main.worldView.left+r,this.scene.cameras.main.worldView.right-r),h=Phaser.Math.Clamp(t,this.scene.cameras.main.worldView.top+a,this.scene.cameras.main.worldView.bottom-a),l=this.scene.add.bitmapText(0,0,"aller_white","");l.setText("Survive Without Shooting"),l.setFontSize(12),l.setOrigin(.5,0),l.y=i.y+18;var u=this.scene.add.container();u.add(i),u.add(l);var c=this.scene.add.container(o,h);c.add(u),c.setDepth(20),c.setAlpha(0),c.uid=Phaser.Math.Between(0,1e4),this.textEffectItems.push(c),c.tweenAnim=this.scene.tweens.timeline({targets:c,tweens:[{delay:100,alpha:{start:0,from:0,to:1},ease:"Linear",duration:200},{scale:{start:1.2,from:1.2,to:1},ease:"Quart.easeIn",duration:300,offset:"-=200",onComplete:function(e){s.scene.tweens.addCounter({from:0,to:1,ease:"Linear",duration:30,loop:14,onStart:function(){u.setPosition(Phaser.Math.Between(-2,2),Phaser.Math.Between(-2,2))},onLoop:function(){u.setPosition(Phaser.Math.Between(-2,2),Phaser.Math.Between(-2,2))}},s)}},{scale:1,ease:"Linear",duration:1100},{y:"-=20",ease:"Quart.easeIn",duration:1500},{alpha:0,ease:"Quintic.Out",duration:400,offset:"-=500"}],onComplete:function(e){c.destroy(),e.destroy(),s.removeTextFromArray(c.uid)}})}},{key:"spawnPowerupPicked",value:function(e,t){var s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",i={shield:"SHIELD",bomb:"BOMB",triple_shot:"TRIPLE SHOT",fast_shot:"FAST_SHOT",fast_acceleration:"FAST ACCELERATION",extra_life:"EXTRA LIFE",life_refill:"LIFE REFILL",increase_score:"INCREASE SCORES"},n=this.scene.add.bitmapText(0,0,"aller_yellow",""),r=i[s];n.setText(r),n.setFontSize(19),n.setOrigin(.5,.5);var a=this.scene.add.container(e,t);a.add(n),a.setDepth(10),a.setAlpha(0);var o=100;this.scene.tweens.timeline({targets:a,tweens:[{delay:o,alpha:{start:0,from:0,to:.6},ease:"Linear",duration:50}]}),this.scene.tweens.timeline({targets:a,tweens:[{delay:o,scaleY:{start:1.1,from:1.1,to:.95},ease:"Quad.easeInOut",duration:60},{scaleY:1.02,ease:"Quad.easeInOut",duration:100},{scaleY:1,ease:"Quad.easeInOut",duration:150}]}),this.scene.tweens.timeline({targets:a,tweens:[{delay:o,scaleX:{start:.9,from:.9,to:1.05},ease:"Quad.easeInOut",duration:60},{scaleX:.98,ease:"Quad.easeInOut",duration:100},{scaleX:1,ease:"Quad.easeInOut",duration:150}]}),this.scene.tweens.timeline({targets:a,tweens:[{delay:o,y:"-=10",ease:"Quart.easeIn",duration:1e3},{alpha:0,ease:"Quintic.Out",duration:400,offset:"-=500"}],onComplete:function(e){a.destroy()}})}},{key:"spawnMeow",value:function(e,t){var s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"meow",i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,n=arguments.length>4&&void 0!==arguments[4]?arguments[4]:16,r=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"aller_white",a=this.scene.add.bitmapText(0,0,r,"");a.setText(s),a.setFontSize(n),a.setOrigin(.5,0);var o=this.scene.add.container(e,t);o.add(a),o.setDepth(20),o.setAlpha(0),this.scene.tweens.timeline({targets:o,tweens:[{delay:i,alpha:{start:0,from:0,to:1},ease:"Linear",duration:100},{y:"-=10",ease:"Quart.easeIn",duration:800},{alpha:0,ease:"Quintic.Out",duration:400,offset:"-=500"}],onComplete:function(e){o.destroy()}})}},{key:"reset",value:function(){this.explodesGroup.children.iterate(function(e){e.hide(!0)}),this.trackGroup.children.iterate(function(e){e.hide(!0)}),this.scoresGroup.children.iterate(function(e){e.hide(!0)});for(var e=this.textEffectItems.length-1;e>=0;e--){var t=this.textEffectItems.pop();t.tweenAnim&&t.tweenAnim.destroy(),t.destroy()}}},{key:"removeTextFromArray",value:function(e){for(var t=0;t<this.textEffectItems.length;t++)if(this.textEffectItems[t].uid===e){this.textEffectItems.splice(t,1);break}}},{key:"backgroundStarsEffect",value:function(){for(var e=this,t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],s=t?10:Phaser.Math.RND.between(1,1),i=0;i<s;i++){var n=this.backgroundStarsGroup.get();if(n){var r=Phaser.Math.RND.between(200,1e3),a=Phaser.Math.RND.rotation();n.offsetX=r*Math.cos(a),n.offsetY=r*Math.sin(a),n.scale2=Phaser.Math.FloatBetween(.05,.8),n.unlerpPos=0*Math.unlerp(0,2,n.scale2),n.speed=.8*Phaser.Math.RND.pick([.2,.2,.3,.3,.4,.5,.5,.5,.6,.6,1.5,8]),n.startUnlerpAlpha=.001,n.endUnlerpAlpha=.1,n.screenCenterX=this.scene.game.config.width/2,n.screenCenterY=this.scene.game.config.height/2,n.x=n.screenCenterX,n.y=n.screenCenterY,n.setScale(1),n.setAlpha(0),n.setDepth(0),n.setTexture("atlas_objects","background_stars/background_star.png"),n.show(),n.updateEffect()}}this.timerBackgroundStars=this.scene.time.addEvent({delay:100,callback:function(){e.backgroundStarsEffect()},callbackScope:this})}},{key:"addStarsToBg",value:function(){var e=Math.round(this.scene.game.config.width/2),t=Math.round(this.scene.game.config.height/2);this.bgStars=this.scene.add.tileSprite(e,t,2e3,2e3,"bg1_stars1"),this.bgStars.setAlpha(.6),this.bgStars2=this.scene.add.tileSprite(e,t,2e3,2e3,"bg1_stars2"),this.bgStars2.setAlpha(.2),this.bgStars3=this.scene.add.tileSprite(e,t,2e3,2e3,"bg1_stars3"),this.bgStars3.setAlpha(.3)}}])&&vr(t.prototype,s),i&&vr(t,i),e}();function gr(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),s.push.apply(s,i)}return s}function br(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?gr(s,!0).forEach(function(t){wr(e,t,s[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):gr(s).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))})}return e}function wr(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}function kr(e,t){for(var s=0;s<t.length;s++){var i=t[s];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var Or=function(){function e(t){var s=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.scene=t,this.category="pcg",this.type="destroy_all",this.units=Phaser.GLOBALS.units_waves[this.category].units,this.finalConfig={},this.defaultBase=Math.cloneDeep(this.scene.cache.json.get("base_config").waves.bases.default),this.defaultBase.parts=[],this.partDefault=Math.cloneDeep(this.scene.cache.json.get("base_config").waves.bases.part),this.curMission=0,this.lvl_min=this.units.common_options.lvl_min,this.lvl_max=this.units.common_options.lvl_max,this.mode_chances=this.units.common_options.mode_chances,this.modeChancesArr=[],this.modesShuffledArr=[],this.curMissionProgressLine=-1,this.curMissionsComplexity=0,b.addEditorEmmiter.call(this,function(e){s.scene.wavesManager.restartWave()}),Phaser.hasOwnProperty("EDITOR")&&(this.editorEmmiter=Phaser.EDITOR.emitter.on("type_changed",function(e,t,i){if(s.category===t){"mission"===s.scene.wavesManager.mode&&(s.scene.wavesManager.curWave=0);var n=Number(e);n>=0&&(s.scene.wavesManager.curMission=n),s.scene.wavesManager.restartWave()}},this))}var t,s,i;return t=e,(s=[{key:"generateMissionType",value:function(){}},{key:"generateMission",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1?arguments[1]:void 0,s={type:"",complexity:void 0,parts:[]};t=br({},s,{},t),this.updateUnits(),this.curMission=e,Phaser.hasOwnProperty("EDITOR")&&(Phaser.EDITOR.part=""+this.curMission);var i=this.getRandomMission(),n=""===t.type||void 0===t.type||null===t.type?i.mission:t.type,r=void 0===t.complexity||null===t.complexity?this.curMission:t.complexity;if(this.type=n,this.enableTypeMissions(n),this.units.hasOwnProperty(n)&&this.units[n].hasOwnProperty("parts")){this.defaultBase.parts=[];var a=this.units[n].parts.length,o=Math.min(a-1,r);this.defaultBase.parts.push(Math.cloneDeep(this.generatePart(n,o))),"destroy_all"===n&&(this.defaultBase.destroy_all.destroy_all_time=this.units[n].parts[o].destroy_all_time),"timed_survival"===n&&(this.defaultBase.timed_survival.timed_survival_time=this.units[n].parts[o].survival_time),"ufo_attack"===n&&(this.defaultBase.ufo_attack.max_enemies_on_screen=this.units[n].parts[o].max_enemies_on_screen),"mines"===n&&(this.defaultBase.mines.mines_count=this.units[n].parts[o].mines_count),"black_hole"===n&&(this.defaultBase.black_hole.pull_power=this.units[n].parts[o].pull_power),this.defaultBase.bonus_score=this.units[n].bonus_score}Phaser.GLOBALS.units_waves.waves.units[0]=this.defaultBase,Phaser.hasOwnProperty("EDITOR")&&(Phaser.EDITOR.unitsFirst.pcg=n)}},{key:"generatePart",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"destroy_all",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"0",s=this.units[e].parts[t],i=this.partDefault,n="",r="",a="";return r="asteroids",a="start_count_",s.hasOwnProperty(r)&&s[r].hasOwnProperty(a)&&(n="big",i[r][a][n]=s[r][a][n],n="middle",i[r][a][n]=s[r][a][n],n="small",i[r][a][n]=s[r][a][n]),r="enemies",s.hasOwnProperty(r)&&s[r].hasOwnProperty(a)&&(a="start_count_",n="ufo_1",i[r][a][n]=s[r][a][n],a="spawn_rate",n="ufo_1",i[r][a][n]=s[r][a][n],n="chance_small_ufo",i[r][n]=s[r][n],n="count_",i[r][n]=s[r][n]),i}},{key:"enableTypeMissions",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";switch(this.defaultBase.destroy_all.is_destroy_all=!1,this.defaultBase.mines.is_mines=!1,this.defaultBase.timed_survival.is_timed_survival=!1,this.defaultBase.ufo_attack.is_ufo_attack=!1,this.defaultBase.black_hole.is_black_hole=!1,e){case"destroy_all":this.defaultBase.destroy_all.is_destroy_all=!0;break;case"mines":this.defaultBase.mines.is_mines=!0;break;case"timed_survival":this.defaultBase.timed_survival.is_timed_survival=!0;break;case"ufo_attack":this.defaultBase.ufo_attack.is_ufo_attack=!0;break;case"black_hole":this.defaultBase.black_hole.is_black_hole=!0}}},{key:"generateTasksTasks",value:function(e){var t=this.units[e],s={},i={};for(var n in t.tasks_chances){var r=this.getValue(t.tasks_chances[n],{val_type:"int"});i[n]=r}var a=[];for(var o in t.tasks)if(s[o]="0",0!==this.getValue(t.tasks[o],{val_type:"int"})&&0!==i[o])for(var h=0;h<i[o];h++)a.push(o);var l=Math.min(2,this.getValue(t.tasks_count,{val_type:"int"}));l=Math.min(a.length,l);for(var u=0;u<l;u++){for(var c=Phaser.Utils.Array.RemoveRandomElement(a),p=a.length-1;p>=0;p--)a[p]===c&&a.splice(p,1);s[c]=this.getValue(t.tasks[c])}return s}},{key:"getRandomMission",value:function(){if(Math.floor(this.curMission/this.scene.missionsPregeneratedCount)!==this.curMissionProgressLine){this.curMissionProgressLine=Math.floor(this.curMission/this.scene.missionsPregeneratedCount);for(var e=[],t=0;t<this.scene.missionsPregeneratedCount;t++)0===e.length&&(e=Phaser.Math.RND.shuffle(this.modeChancesArr.slice()),this.modesShuffledArr.length>0&&this.modesShuffledArr[this.modesShuffledArr.length-1].mission===e[e.length-1]&&(e=e.reverse()),this.curMissionsComplexity++,this.curMissionsComplexity=Math.min(10,this.curMissionsComplexity)),this.modesShuffledArr.push({mission:e.pop(),complexity:2*this.curMissionProgressLine+this.curMissionsComplexity-1});this.scene.missionUI.recreateProgressLine(this.modesShuffledArr,this.curMission)}return this.scene.missionUI.setProgressHeroPosition(this.curMission),this.modesShuffledArr[this.curMission%this.scene.missionsPregeneratedCount]}},{key:"reset",value:function(){this.modesShuffledArr.length=0,this.curMissionProgressLine=-1,this.curMissionsComplexity=0}},{key:"updateUnits",value:function(){for(var e in this.units=Phaser.GLOBALS.units_waves[this.category].units,this.mode_chances=this.units.common_options.mode_chances,this.modeChancesArr=[],this.mode_chances)for(var t=0;t<this.mode_chances[e];t++)this.modeChancesArr.push(e)}}])&&kr(t.prototype,s),i&&kr(t,i),e}();function Sr(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),s.push.apply(s,i)}return s}function Pr(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}function Mr(e,t){for(var s=0;s<t.length;s++){var i=t[s];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var xr=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.scene=t,this.uid=0,this.uidDestroyed=0,this.uidDestroyedTypes={},this.uidHash={},this.aliveCount=0,this.aliveLastDestrCount=0,this.destroyed=0,this.destroyedTypes={},this.timerSpawnAsteroids=null}var t,s,i;return t=e,(s=[{key:"spawnAsteroids",value:function(e,t,s,i){var n=this;i=function(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?Sr(s,!0).forEach(function(t){Pr(e,t,s[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):Sr(s).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))})}return e}({},{x:null,y:null,ang:null,angles:null,speed:null,destruction:null,predicted_parts:null},{},i);for(var r=0;r<e;r++)this.timerSpawnAstDelay=this.scene.time.addEvent({delay:50*r,callback:function(){var e=n.scene.asteroidsGroup.get();if(e){n.uid++,n.uidHash.hasOwnProperty(n.uid)||(n.uidHash[n.uid]=0);var r=Array.isArray(t)?Phaser.Math.RND.pick(t):t;n.uidDestroyedTypes.hasOwnProperty(r)||(n.uidDestroyedTypes[r]=0),n.destroyedTypes.hasOwnProperty(r)||(n.destroyedTypes[r]=0);var a=Array.isArray(s)?Phaser.Math.RND.pick(s):s,o=0,h=0,l=Phaser.Math.RND.sign()*Phaser.Math.RND.pick([Phaser.Math.RND.between(20,80),Phaser.Math.RND.between(100,160)]),u=n.scene.cameras.main.worldView,c=null!==i.destruction?i.destruction:0;switch(e.setDepth(12),e.padding=e.hasOwnProperty("collider")&&e.collider[c]&&e.collider[c].hasOwnProperty("radius")?e.collider[c].radius:20,e.predicted_parts=i.predicted_parts,a){case"l":o=u.left-.99*e.padding,h=Phaser.Math.RND.between(40,n.scene.cameras.main.height-40),l+=-90;break;case"r":o=u.right+.99*e.padding,h=Phaser.Math.RND.between(40,n.scene.cameras.main.height-40),l+=90;break;case"t":o=Phaser.Math.RND.between(40,n.scene.cameras.main.width-40),h=u.top-.99*e.padding,l+=0;break;case"d":o=Phaser.Math.RND.between(40,n.scene.cameras.main.width-40),h=u.bottom+.99*e.padding,l+=180}null!==i.ang&&(l=i.ang),null!==i.x&&(o=i.x),null!==i.y&&(h=i.y),e.spawn(r,o,h,{rotation:Phaser.Math.DegToRad(l),destruction:i.destruction,uid:n.uid,speed:i.speed})}},callbackScope:this})}},{key:"explodeAll",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{just_explode:!1,is_random_delay:!1};this.scene.asteroidsGroup.getChildren().forEach(function(t){t.active&&(e.is_random_delay?setTimeout(function(){t.subDestruction(99,e.just_explode)},Phaser.Math.Between(0,200)):t.subDestruction(99,e.just_explode))})}},{key:"reset",value:function(){this.scene.asteroidsGroup.getChildren().forEach(function(e){e.predicted_parts=null,e.setActive(!1),e.setVisible(!1),e.body.setEnable(!1)}),this.uid=0,this.uidDestroyed=0,this.uidDestroyedTypes={},this.uidHash={},this.aliveCount=0,this.aliveLastDestrCount=0,this.destroyed=0,this.destroyedTypes={},this.timerSpawnAstDelay&&this.timerSpawnAstDelay.remove()}}])&&Mr(t.prototype,s),i&&Mr(t,i),e}();function Tr(e,t){for(var s=0;s<t.length;s++){var i=t[s];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var Cr=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.scene=t,this.uid=0,this.uidDestroyed=0,this.uidHash={},this.aliveCount=0,this.aliveCountUfo1=0,this.aliveCountUfo2=0,this.destroyedByHero=0,this.destroyedByCollide=0,this.destroyedByBorder=0,this.ufoAttackSkins=["ufo_1","ufo_1_pink","ufo_1_purple","ufo_1_green"],this.curUfoAttackSkins=[],this.soundSaucerBig=this.scene.sound.add("saucer_big",{mute:!1,volume:.5,loop:!0}),this.soundSaucerSmall=this.scene.sound.add("saucer_small",{mute:!1,volume:.5,loop:!0})}var t,s,i;return t=e,(s=[{key:"spawnEnemies",value:function(e,t,s){for(var i=0;i<e;i++){var n=this.scene.enemiesGroup.getFirstDead(!0);if(n){this.uid++,this.uidHash.hasOwnProperty(this.uid)||(this.uidHash[this.uid]=0);var r=Array.isArray(t)?Phaser.Math.RND.pick(t):t,a=Array.isArray(s)?Phaser.Math.RND.pick(s):s,o=0,h=0,l=0,u="",c=this.scene.cameras.main.worldView;switch(n.setDepth(12),a){case"l":o=c.left-0*n.padding,h=Phaser.Math.RND.between(60,this.scene.cameras.main.height-60),l=0,u="r";break;case"r":o=c.right+0*n.padding,h=Phaser.Math.RND.between(60,this.scene.cameras.main.height-60),l=Phaser.Math.DegToRad(180),u="l";break;case"t":o=Phaser.Math.RND.between(60,this.scene.cameras.main.width-60),h=c.top-0*n.padding,l=Phaser.Math.DegToRad(90),u="d";break;case"d":o=Phaser.Math.RND.between(60,this.scene.cameras.main.width-60),h=c.bottom+0*n.padding,l=Phaser.Math.DegToRad(270),u="t"}var p="ufo_1";"ufo_1"===r&&this.scene.wavesManager.is_ufo_attack&&(0===this.curUfoAttackSkins.length&&(this.curUfoAttackSkins=this.ufoAttackSkins.slice()),p=this.curUfoAttackSkins.splice(Phaser.Math.Between(0,this.curUfoAttackSkins.length-1),1)),n.spawn(r,o,h,{rotation:l,spawn_side:a,dead_side:u,uid:this.uid,skin:p})}}}},{key:"controlEnemiesSound",value:function(){this.aliveCountUfo1>0&&!this.scene.isGameOver?this.soundSaucerBig.isPlaying||this.soundSaucerSmall.isPlaying||"game"===this.scene.layoutState&&this.soundSaucerBig.play():this.soundSaucerBig.isPlaying&&this.soundSaucerBig.stop(),this.aliveCountUfo2>0&&!this.scene.isGameOver?this.soundSaucerSmall.isPlaying||this.soundSaucerBig.isPlaying||"game"===this.scene.layoutState&&this.soundSaucerSmall.play():this.soundSaucerSmall.isPlaying&&this.soundSaucerSmall.stop()}},{key:"reset",value:function(){this.scene.enemiesGroup.getChildren().forEach(function(e){e.hide(!0)}),this.uid=0,this.uidDestroyed=0,this.uidHash={},this.aliveCount=0,this.aliveCountUfo1=0,this.aliveCountUfo2=0,this.destroyedByHero=0,this.destroyedByCollide=0,this.destroyedByBorder=0,this.curUfoAttackSkins=[],this.controlEnemiesSound()}}])&&Tr(t.prototype,s),i&&Tr(t,i),e}();function Er(e){return(Er="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Ar(e,t){for(var s=0;s<t.length;s++){var i=t[s];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function jr(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Br(e,t,s){return(Br="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,s){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Dr(e)););return e}(e,t);if(i){var n=Object.getOwnPropertyDescriptor(i,t);return n.get?n.get.call(s):n.value}})(e,t,s||e)}function Dr(e){return(Dr=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Rr(e,t){return(Rr=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Gr=function(e){function t(e,s,i,n){var r,a,o;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),a=this,(r=!(o=Dr(t).call(this,e,s,i))||"object"!==Er(o)&&"function"!=typeof o?jr(a):o).scene=e,r.scene.add.existing(jr(r)),r.scene.physics.add.existing(jr(r)),r.setOrigin(.5),r.body.setEnable(!1),r.category="waves",r.type="mines",r.units=Phaser.GLOBALS.units_waves[r.category].units,r.config=n||r.units[r.type],r.skin="mine/mine.png",r.size=r.scene.wavesManager.minesManager.mine_size,r.hp=1,r.move_speeds=0,r.scores=0,r.collider={shape:"circle",radius:20,offset_x:0,offset_y:0},r.loot_chances=[0],r.mass=[],r.curHP=r.hp,r.curScore=r.scores,r.velocity={x:0,y:0},r.padding=0,r.uid=0,r.shooter=null,r.isFreeze=!1,r.ice=null,r.idleInitX=0,r.idleInitY=0,r.idleAmplitude=0,r.idleSpeed=0,r.idleSpeedX=0,r.idleSpeedY=0,r.idlePeriodOffsetX=0,r.idlePeriodOffsetY=0,r.idleAngle=0,r.idleAngleX=0,r.idleAngleY=0,r.overlapMinesShipBullets=null,r.overlapMinesShips=null,r.addOverlapMinesShipBullets(),r.addOverlapMinesShips(),r.soundPlayerHitsKitty=r.scene.sound.add("player_hits_kitty",{mute:!1,volume:1,loop:!1}),r.readConfigByType(),r}var s,i,n;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Rr(e,t)}(t,Phaser.Physics.Arcade.Sprite),s=t,(i=[{key:"spawn",value:function(e,t){this.set_size(this.scene.wavesManager.minesManager.mine_size);var s={x:e,y:t};this.idleInitX=s.x,this.idleInitY=s.y,this.idleAmplitude=this.scene.wavesManager.minesManager.mine_idle_power,this.idleSpeed=this.scene.wavesManager.minesManager.mine_idle_speed,this.idleSpeedX=this.idleSpeed*Phaser.Math.RND.sign()*Phaser.Math.FloatBetween(.1,1),this.idleSpeedY=this.idleSpeed*Phaser.Math.RND.sign()*Phaser.Math.FloatBetween(.1,1),this.idleAngleX=0,this.idleAngleY=0,this.rotateSpeed=Phaser.Math.RND.sign()*(this.scene.wavesManager.minesManager.mine_rotate_speed+Phaser.Math.FloatBetween(-.2,.2)),s.x=this.idleInitX+Math.sin(this.idleAngleX+this.idlePeriodOffsetX)*this.idleAmplitude,s.y=this.idleInitY+Math.cos(this.idleAngleY+this.idlePeriodOffsetY)*this.idleAmplitude,this.body.reset(s.x,s.y),this.overlapMinesShipBullets.active=!0,this.overlapMinesShips.active=!0,this.play("mine",!1,0),this.anims.stop(),this.show(),this.body.preUpdate()}},{key:"show",value:function(){this.setActive(!0),this.setVisible(!0),this.body.setEnable(!0),this.setAlpha(1)}},{key:"hide",value:function(){arguments.length>0&&void 0!==arguments[0]&&arguments[0],this.setActive(!1),this.setVisible(!1),this.body.setEnable(!1)}},{key:"explode",value:function(){var e=this;this.body.setEnable(!1),this.scene.tweens.add({targets:this,props:{rotation:{value:2*Math.PI,duration:500,ease:"Quad.easeOut",repeat:0}},onComplete:function(t){e.play("mine",!1,1),e.on("animationcomplete",function(){e.active&&(e.hide(),e.scene.wavesManager.minesManager.checkNoMines())},e)}},this),this.scene.ships.forEach(function(e){e.shipDie({explode:!1})}),this.scene.effectsManager.spawnEffect(this.scene.ui.missionTimerCont.x,this.scene.ui.missionTimerCont.y+.12*this.scene.game.config.height,"wrong_color",{text:"-1 LIFE",font_size:25}),setTimeout(function(){e.scene.effectsManager.spawnMeow(e.x,e.y-50)},100),this.soundPlayerHitsKitty.play()}},{key:"addOverlapMinesShipBullets",value:function(){return this.overlapMinesShipBullets=this.scene.physics.add.overlap(this,this.scene.playerBulletsGroup,function(e,s){var i,n;e instanceof t?(i=e,n=s):(i=s,n=e),i.shooter=n.shooter,i.explode(),n.hide()}),this.overlapMinesShipBullets}},{key:"addOverlapMinesShips",value:function(){return this.overlapMinesShips=this.scene.physics.add.overlap(this,this.scene.shipsGroup,function(e,s){var i,n;e instanceof t?(i=e,n=s):(i=s,n=e),n.isBlink||(i.shooter=n,i.explode())}),this.overlapMinesShips}},{key:"preUpdate",value:function(e,s){if(Br(Dr(t.prototype),"preUpdate",this).call(this,e,s),this.idleAmplitude>0){var i=s/1e3;this.idleAngleX+=this.idleSpeedX*i,this.idleAngleY+=this.idleSpeedY*i;var n=this.idleInitX+Math.sin(this.idleAngleX+this.idlePeriodOffsetX)*this.idleAmplitude,r=this.idleInitY+Math.cos(this.idleAngleY+this.idlePeriodOffsetY)*this.idleAmplitude;this.rotation+=this.rotateSpeed*i,this.body.reset(n,r)}}},{key:"set_skin",value:function(){return arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.skin,this.play("mine",!1,0),this.anims.stop(),this.set_collider(),this}},{key:"set_size",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.size;return this.size=e,this.setScale(this.size),this}},{key:"set_collider",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.collider;this.collider=e;var t=this.collider.shape;if("string"==typeof t&&"circle"===t){var s=this.collider.radius;this.body.setCircle(s,this.displayOriginX-s,this.displayOriginY-s),this.padding=1*s}return this}},{key:"readConfig",value:function(e){return this.set_skin(),this.set_size(g(e,"mine_size",this.size).value),this}},{key:"readConfigByType",value:function(e){this.readConfig(this.config)}}])&&Ar(s.prototype,i),n&&Ar(s,n),t}();function Ir(e){return(Ir="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Lr(e,t){for(var s=0;s<t.length;s++){var i=t[s];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function zr(e){return(zr=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Vr(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Ur(e,t){return(Ur=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Fr=function(e){function t(e,s,i){var n,r,a;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),r=this,(n=!(a=zr(t).call(this,e,s,i))||"object"!==Ir(a)&&"function"!=typeof a?Vr(r):a).scene=e,n.scene.add.existing(Vr(n)),n.scene.physics.add.existing(Vr(n)),n.power=1,n.radius=n.scene.wavesManager.minesManager.mine_explode_radius,n.init_alpha=.6,n.collider={shape:"circle",radius:32},n.shooter=null,n.set_skin(),n.set_collider(),n.soundExplode=n.scene.sound.add("bang_large",{mute:!1,volume:.5,loop:!1}),n}var s,i,n;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Ur(e,t)}(t,Phaser.Physics.Arcade.Image),s=t,(i=[{key:"explode",value:function(e,s){var i=this;this.radius=this.scene.wavesManager.minesManager.mine_explode_radius;var n=2*this.radius;this.setDisplaySize(n,n),this.collider.radius=n/2/this.scale,this.set_collider(),this.body.reset(e,s),this.show(),this.setAlpha(this.init_alpha),this.setDepth(10),this.scene.physics.world.overlap(this,this.scene.asteroidsGroup,function(e,s){var i,n;e instanceof t?(i=e,n=s):(i=s,n=e),n.shooter=i.shooter,n.subDestruction(i.power)}),this.scene.physics.world.overlap(this,this.scene.enemiesGroup,function(e,s){var i,n;e instanceof t?(i=e,n=s):(i=s,n=e),n.shooter=i.shooter,n.subDestruction(i.power)});var r=!1;this.scene.physics.world.overlap(this,this.scene.shipsGroup,function(e,s){var i,n;e instanceof t?(i=e,n=s):(i=s,n=e),(r=i.shooter===n)||n.shipDie()}),this.shooter.shipDie({explode:r}),this.scene.tweens.add({targets:this,props:{scale:{value:"+=0.1",duration:300,ease:"Quad.easeOut",repeat:0},alpha:{value:0,delay:0,duration:300,ease:"Linear",repeat:0}},onComplete:function(e){i.hide()}},this),this.scene.cameras.main.shake(80,.007)}},{key:"show",value:function(){this.setAlpha(1),this.setActive(!0),this.setVisible(!0),this.body.setEnable(!0)}},{key:"hide",value:function(){this.setActive(!1),this.setVisible(!1),this.body.setEnable(!1)}},{key:"set_skin",value:function(){this.setTexture("atlas_objects","mine/mine_explode.png")}},{key:"set_collider",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.collider,t=e.shape;if("string"==typeof t&&"circle"===t){var s=e.radius;this.body.setCircle(s,this.displayOriginX-s,this.displayOriginY-s)}}},{key:"set_power",value:function(e){return this.power=e,this}}])&&Lr(s.prototype,i),n&&Lr(s,n),t}();function Hr(e,t){for(var s=0;s<t.length;s++){var i=t[s];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var Nr=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.scene=t,this.category="waves",this.type="0",this.units=Phaser.GLOBALS.units_waves[this.category].units,this.config=this.units.mines,this.mine_size=1,this.mine_explode_radius=300,this.mine_idle_power=20,this.mine_idle_speed=.8,this.mine_rotate_speed=.4,this.SPAWN_POSITIONS=[[[307,408],[464,367],[480,195],[372,103]],[[401,68],[470,205],[120,232],[205,105]],[[136,135],[443,139],[453,367],[135,374]]],this.mineGroup=this.scene.physics.add.group({classType:Gr,maxSize:50,runChildUpdate:!0,active:!1,visible:!1}),this.mineExlodeGroup=this.scene.physics.add.group({classType:Fr,maxSize:50,runChildUpdate:!1,active:!1,visible:!1});var s=this.scene.anims.generateFrameNames("atlas_objects",{start:1,end:5,zeroPad:4,prefix:"mine/mine",suffix:".png",frames:!0});this.scene.anims.create({key:"mine",frames:s,frameRate:15,repeat:0,yoyo:!1}),b.addEditorEmmiter.call(this,function(e){})}var t,s,i;return t=e,(s=[{key:"reset",value:function(){this.mineGroup.getChildren().forEach(function(e){e.hide(!0)}),this.timerNoMinesSpawn&&this.timerNoMinesSpawn.remove()}},{key:"generate",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.scene.wavesManager.mines_count;e=Math.min(e,4),this.scene.wavesManager.mines_count=e;var t=Phaser.Math.RND.pick(this.SPAWN_POSITIONS);t=Phaser.Math.RND.shuffle(t);for(var s=0;s<e;s++){var i=this.mineGroup.get(),n=t[s][0],r=t[s][1];i.spawn(n,r)}}},{key:"checkNoMines",value:function(){var e=this;this.mineGroup.getFirstAlive()||this.scene.isGameOver||(this.timerNoMinesSpawn&&this.timerNoMinesSpawn.remove(),this.timerNoMinesSpawn=this.scene.time.addEvent({delay:1e3,callback:function(){e.generate(1)},callbackScope:this}))}},{key:"fadeMines",value:function(){var e=this;this.mineGroup.getChildren().forEach(function(t){t.body.setEnable(!1),e.scene.tweens.add({targets:t,alpha:0,ease:"Linear",duration:500,onComplete:function(){t.hide()}},e)})}},{key:"setOverlapsActive",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.mineGroup.getChildren().forEach(function(t){t.overlapMinesShipBullets&&(t.overlapMinesShipBullets.active=e),t.overlapMinesShips&&(t.overlapMinesShips.active=e)})}},{key:"set_mine_size",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.mine_size;this.mine_size=e,this.mineGroup.getChildren().forEach(function(t){t.active&&t.set_size(e)})}},{key:"set_mine_explode_radius",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.mine_explode_radius;this.mine_explode_radius=e}},{key:"set_idle_power",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.mine_idle_power;this.mine_idle_power=e}},{key:"set_idle_speed",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.mine_idle_speed;this.mine_idle_speed=e}}])&&Hr(t.prototype,s),i&&Hr(t,i),e}();function Wr(e){return(Wr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Kr(e,t){for(var s=0;s<t.length;s++){var i=t[s];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function Qr(e){return(Qr=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Yr(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Xr(e,t){return(Xr=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Jr=function(e){function t(e,s,i){var n,r,a;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),r=this,(n=!(a=Qr(t).call(this,e,s,i))||"object"!==Wr(a)&&"function"!=typeof a?Yr(r):a).scene=e,n.scene.add.existing(Yr(n)),n.category="waves",n.units=Phaser.GLOBALS.units_waves[n.category].units,n.config=n.units.astronauts,n.skin="astronaut",n.astronaut_size=n.scene.wavesManager.astronautsManager.astronaut_size,n.round_size=n.scene.wavesManager.astronautsManager.astronaut_round_size,n.pull_time=n.scene.wavesManager.astronautsManager.pull_time,n.move_speeds=0,n.skinRotSpeed=0,n.scores=0,n.collider_round={shape:"circle",radius:54,offset_x:0,offset_y:0},n.collider_skin={shape:"circle",radius:12,offset_x:0,offset_y:0},n.curPullProgress=0,n.curScore=n.scores,n.velocity={x:0,y:0},n.padding=n.collider_round.radius,n.uid=0,n.shooter=null,n.isFreeze=!1,n.ice=null,n.isPull=!1,n.isTroggerPullOn=!1,n.isTroggerPullOff=!1,n.isAlreadyPicked=!1,n.wifiGO=null,n.skinGO=null,n.roundGO=null,n.progressGO=null,n.alreadyPickedGO=null,n.tweenAlreadyPicked=null,n.timerRespawnDelay=null,n.readConfigByType(),n.overlapAstronautShips=null,n.overlapAstronautShipBullets=null,n.overlapAstronautBlastRadiusBullets=null,n.overlapAstronautBlastRadiusExplode=null,n.addOverlapAstronautShips(),n.addOverlapAstronautShipBullets(),n.addOverlapAstronautBlastRadiusBullets(),n.addOverlapAstronautBlastRadiusExplode(),n}var s,i,n;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Xr(e,t)}(t,Phaser.GameObjects.Container),s=t,(i=[{key:"spawn",value:function(e,t,s){var i={x:e,y:t};this.setPosition(i.x,i.y),this.skinGO.rotation=s,this.skinRotSpeed=Phaser.Math.DegToRad(Phaser.Math.RND.pick([-8,-6,-5,5,6,8])),this.setDepth(8),this.show(),this.skinGO.body.preUpdate(),this.roundGO.body.preUpdate(),this.skinGO.setScale(.8),this.skinGO.setAlpha(0),this.scene.tweens.add({targets:this.skinGO,props:{scale:{value:this.scene.wavesManager.astronautsManager.astronaut_size,duration:1500,ease:"Elastic",repeat:0},alpha:{value:1,duration:200,ease:"Linear",repeat:0}},onComplete:function(e){}},this)}},{key:"show",value:function(){this.setActive(!0),this.setVisible(!0),this.roundGO.body.setEnable(!0),this.skinGO.body.setEnable(!0),this.setAlpha(1)}},{key:"hide",value:function(){arguments.length>0&&void 0!==arguments[0]&&arguments[0],this.setActive(!1),this.setVisible(!1),this.roundGO.body.setEnable(!1),this.skinGO.body.setEnable(!1)}},{key:"addOverlapAstronautShips",value:function(){}},{key:"addOverlapAstronautShipBullets",value:function(){return this.overlapAstronautShipBullets=this.scene.physics.add.overlap(this.skinGO,this.scene.playerBulletsGroup,function(e,t){var s,i;"astronaut"===e.category?(s=e.parentContainer,i=t):(s=t.parentContainer,i=e),s.shooter=i.shooter,s.die(),i.hide()}),this.overlapAstronautShipBullets}},{key:"addOverlapAstronautBlastRadiusBullets",value:function(){var e=this;return this.overlapAstronautBlastRadiusBullets=this.scene.physics.add.overlap(this.skinGO,this.scene.powerupManager.blastRadius.bulletGroup,function(t,s){var i,n;"astronaut"===t.category?(i=t.parentContainer,n=s):(i=s.parentContainer,n=t),i.shooter=n.shooter,i.die(),e.scene.powerupManager.blastRadius.createExplode(n),n.hide()}),this.overlapAstronautBlastRadiusBullets}},{key:"addOverlapAstronautBlastRadiusExplode",value:function(){return this.overlapAstronautBlastRadiusExplode=this.scene.physics.add.overlap(this.skinGO,this.scene.powerupManager.blastRadius.explodeGroup,function(e,t){var s,i;"astronaut"===e.category?(s=e.parentContainer,i=t):(s=t.parentContainer,i=e),s.shooter=i.shooter,s.die()}),this.overlapAstronautBlastRadiusExplode}},{key:"die",value:function(){var e=this;this.shooter.shipDie({explode:!1}),this.scene.effectsManager.spawnEffect(this.x,this.y,"wrong_color",{text:"WRONG"}),this.hide(),this.scene.cameras.main.shake(80,.007),this.timerRespawnDelay=this.scene.time.addEvent({delay:300,callback:function(){e.timerRespawnDelay.remove(),e.scene.wavesManager.astronautsManager.generateAstronauts(1)},callbackScope:this})}},{key:"preUpdate",value:function(e,s){var i=this;if(this.active){var n=.001*s;this.skinGO.rotation+=this.skinRotSpeed*n,this.isPull=!1,this.shooter=null;var r=null,a=null;if(this.scene.physics.world.overlap(this.roundGO,this.scene.shipsGroup,function(e,s){var n,o;if(e.parentContainer instanceof t?(n=e.parentContainer,o=s):(n=s.parentContainer,o=e),null===(r=o.astronautPicked))r=n,o.astronautPicked=r,o.astronautIsPull=!0;else if(o.astronautFull)Phaser.Math.Distance.Between(n.x,n.y,o.x,o.y)<2*i.collider_skin.radius?i.isAlreadyPicked||(i.isAlreadyPicked=!0,i.showAstronautAlreadyPicked()):i.isAlreadyPicked&&(i.isAlreadyPicked=!1,i.hideAstronautAlreadyPicked());else if(r!==n){var h=Phaser.Math.Distance.Between(r.x,r.y,o.x,o.y);Phaser.Math.Distance.Between(n.x,n.y,o.x,o.y)<=h&&(r.pullOff(),r.isTroggerPullOn=!1,r.isTroggerPullOff=!1,r=n,o.astronautPicked=r,o.astronautIsPull=!0)}a=o}),r&&r===this){if(this.isPull=a.astronautIsPull,this.shooter=a,this.isPull){this.isTroggerPullOff=!1,this.isTroggerPullOn||(this.isTroggerPullOn=!0,this.roundGO.setVisible(!0),this.wifiGO.setVisible(!0),this.progressGO.setVisible(!0),this.runOnCollideTween()),this.wifiGO.rotation=Phaser.Math.Angle.Between(this.shooter.x,this.shooter.y,this.x,this.y);var o=Phaser.Math.Distance.Between(this.x,this.y,this.shooter.x,this.shooter.y);o=this.wifiGO.width-o,o=Phaser.Math.Clamp(o,0,this.wifiGO.width),this.wifiGO.setCrop(o,0,this.wifiGO.width,this.wifiGO.height),this.curPullProgress+=s;var h=Phaser.Math.Clamp(this.curPullProgress/this.scene.wavesManager.astronautsManager.pull_time,0,1);this.progressGO.anims.setProgress(h),h>=1&&(a.astronautFull=!0,a.astronautIsPull=!1,this.pullOff(),this.hide(),this.scene.wavesManager.astronautsManager.putAstronautOnShip(a))}}else this.isTroggerPullOn=!1,this.isTroggerPullOff||(this.isTroggerPullOff=!0,this.pullOff())}}},{key:"showAstronautAlreadyPicked",value:function(){this.alreadyPickedGO.setAlpha(0),this.alreadyPickedGO.setVisible(!0),this.tweenAlreadyPicked=this.scene.tweens.timeline({targets:this.alreadyPickedGO,tweens:[{delay:50,alpha:{start:0,from:0,to:1},ease:"Linear",duration:100},{y:{start:-40,from:-40,to:-50},ease:"Back",duration:300,offset:"-=100"}],onComplete:function(e){}})}},{key:"hideAstronautAlreadyPicked",value:function(){var e=this;this.tweenAlreadyPicked=this.scene.tweens.timeline({targets:this.alreadyPickedGO,tweens:[{y:-40,ease:"Linear",duration:250},{alpha:0,ease:"Linear",duration:100,offset:"-=250"}],onComplete:function(t){e.alreadyPickedGO.setVisible(!1)}})}},{key:"pullOff",value:function(){this.roundGO.setVisible(!1),this.wifiGO.setVisible(!1),this.progressGO.setVisible(!1),this.curPullProgress=0,this.isPull=!1}},{key:"resetVars",value:function(){this.curPullProgress=0,this.shooter=null,this.isFreeze=!1,this.ice=null,this.isPull=!1,this.isTroggerPullOn=!1,this.isTroggerPullOff=!1,this.timerRespawnDelay&&this.timerRespawnDelay.remove()}},{key:"getNearest",value:function(e,t,s,i,n){var r,a=9999999;return e.getChildren().forEach(function(e){if(e.active&&e.body.enable){var o=Math.abs(e.x-t)+Math.abs(e.y-s);o<=a&&(a=o,r=e);var h=Math.abs(i-e.x+t)+Math.abs(n-e.y+s);h<=a&&(a=h,r=e)}}),r}},{key:"runOnCollideTween",value:function(){this.roundGO.rotation=Phaser.Math.RND.rotation(),this.roundGO.setAlpha(0),this.tweenOver3=this.scene.tweens.timeline({targets:this.roundGO,tweens:[{alpha:.1,ease:"Linear",duration:200}]})}},{key:"set_skin",value:function(){return arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.skin,null===this.roundGO&&(this.roundGO=this.scene.physics.add.image(0,0,""),this.roundGO.category="astronaut_round",this.roundGO.setTexture("atlas_objects","astronaut/astronaut_round.png"),this.roundGO.setOrigin(.5),this.add(this.roundGO),this.roundGO.setAlpha(.1),this.roundGO.setZ(1),this.set_round_collider()),this.roundGO.setVisible(!1),null===this.wifiGO&&(this.wifiGO=this.scene.add.sprite(0,0,""),this.wifiGO.play("astronaut_pull_line"),this.wifiGO.setOrigin(1,.5),this.add(this.wifiGO),this.wifiGO.setAlpha(1),this.wifiGO.setZ(2)),this.wifiGO.setVisible(!1),null===this.skinGO&&(this.skinGO=this.scene.physics.add.sprite(0,0,""),this.skinGO.category="astronaut",this.skinGO.setTexture("atlas_objects","astronaut/astronaut.png"),this.skinGO.setOrigin(.5),this.add(this.skinGO),this.skinGO.setZ(3),this.set_skin_collider()),null===this.progressGO&&(this.progressGO=this.scene.wavesManager.astronautsManager.astronautProgressGroup.get(),this.add(this.progressGO),this.progressGO.setZ(4)),this.progressGO.setVisible(!1),null===this.alreadyPickedGO&&(this.alreadyPickedGO=this.scene.add.bitmapText(0,0,"yellow",""),this.alreadyPickedGO.setText("You already picked\none Astronaut"),this.alreadyPickedGO.setFontSize(32),this.alreadyPickedGO.setOrigin(.5,.5),this.alreadyPickedGO.setCenterAlign(),this.add(this.alreadyPickedGO),this.alreadyPickedGO.setZ(5)),this.alreadyPickedGO.setVisible(!1),this}},{key:"set_astronaut_size",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.astronaut_size;return this.astronaut_size=e,this.skinGO.setScale(this.astronaut_size),this}},{key:"set_round_size",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.round_size;return this.round_size=e,this.roundGO.setScale(this.round_size),this}},{key:"set_round_collider",value:function(){var e=this.collider_round.shape;if("string"==typeof e&&"circle"===e){var t=this.roundGO.displayWidth/2;this.roundGO.body.setCircle(t,this.roundGO.displayOriginX-t,this.roundGO.displayOriginY-t)}return this}},{key:"set_skin_collider",value:function(){var e=this.collider_skin.shape;if("string"==typeof e&&"circle"===e){var t=this.collider_skin.radius;this.skinGO.body.setCircle(t,this.skinGO.displayOriginX-t,this.skinGO.displayOriginY-t)}return this}},{key:"readConfig",value:function(e){return this.set_skin(),this.set_astronaut_size(),this.set_round_size(),this}},{key:"readConfigByType",value:function(e){this.readConfig(this.config)}}])&&Kr(s.prototype,i),n&&Kr(s,n),t}();function Zr(e){return(Zr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function qr(e,t){for(var s=0;s<t.length;s++){var i=t[s];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function $r(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function ea(e,t,s){return(ea="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,s){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=ta(e)););return e}(e,t);if(i){var n=Object.getOwnPropertyDescriptor(i,t);return n.get?n.get.call(s):n.value}})(e,t,s||e)}function ta(e){return(ta=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function sa(e,t){return(sa=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var ia=function(e){function t(e,s,i,n){var r,a,o;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),a=this,(r=!(o=ta(t).call(this,e,s,i))||"object"!==Zr(o)&&"function"!=typeof o?$r(a):o).scene=e,r.scene.add.existing($r(r)),r.scene.physics.add.existing($r(r)),r.setOrigin(.5),r.body.setEnable(!1),r.category="waves",r.units=Phaser.GLOBALS.units_waves[r.category].units,r.config=r.units.astronauts,r.skin="station",r.size=r.scene.wavesManager.astronautsManager.station_size,r.move_speeds=0,r.collider={shape:"circle",radius:60,offset_x:0,offset_y:0},r.velocity={x:0,y:0},r.padding=0,r.shooter=null,r.isFreeze=!1,r.ice=null,r.isWaitAstronaut=!1,r.isPull=!1,r.curPullProgress=1,r.isTriggerPullOn=!1,r.isTriggerPullOff=!1,r.progressGO=null,r.isBlink=!1,r.timerBlink=null,r.isBillboard=!1,r.readConfigByType(),r}var s,i,n;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&sa(e,t)}(t,Phaser.Physics.Arcade.Sprite),s=t,(i=[{key:"spawn",value:function(e,t,s){this.set_size(this.scene.wavesManager.minesManager.mine_size),this.body.reset(e,t),this.rotation=s,this.show(),this.body.preUpdate()}},{key:"blink",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];e?this.runTimerBlink():(this.setVisible(!0),this.isBlink=!1,this.timerBlink&&this.timerBlink.remove())}},{key:"runTimerBlink",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:300;this.timerBlink&&this.timerBlink.remove(),this.setVisible(!1),this.isBlink=!0,this.timerBlink=this.scene.time.addEvent({delay:t,repeat:-1,callback:function(){e.setVisible(!e.visible),0===e.timerBlink.getRepeatCount()&&(e.setVisible(!0),e.isBlink=!1)},callbackScope:this})}},{key:"show",value:function(){this.setActive(!0),this.setVisible(!0),this.body.setEnable(!0),this.setAlpha(1)}},{key:"hide",value:function(){arguments.length>0&&void 0!==arguments[0]&&arguments[0],this.setActive(!1),this.setVisible(!1),this.body.setEnable(!1)}},{key:"preUpdate",value:function(e,s){if(ea(ta(t.prototype),"preUpdate",this).call(this,e,s),this.isPull=!1,this.shooter=null,this.scene.physics.world.overlap(this,this.scene.shipsGroup,function(e,s){var i,n;e instanceof t?(i=e,n=s):(i=s,n=e),i.isPull=!0,i.shooter=n}),this.isPull){if(this.progressGO.setPosition(this.shooter.x,this.shooter.y),this.isTriggerPullOff=!1,this.shooter.astronautFull&&this.shooter.astronautPicked){this.isTriggerPullOn||(this.isTriggerPullOn=!0,this.curPullProgress=this.scene.wavesManager.astronautsManager.pull_time,this.progressGO.anims.setProgress(1),this.progressGO.setVisible(!0),this.blink(!1)),this.curPullProgress-=s;var i=Phaser.Math.Clamp(this.curPullProgress/this.scene.wavesManager.astronautsManager.pull_time,0,1);if(this.progressGO.anims.setProgress(i),i<=0){this.isPull=!1,this.shooter.astronautFull=!1,this.shooter.astronautIsPull=!1,this.progressGO.setVisible(!1),this.scene.wavesManager.astronautsManager.removeAstronautFromShip(this.shooter),this.scene.wavesManager.astronauts_collected++,this.scene.wavesManager.checkEndOfWave();var n=Math.round(this.scene.wavesManager.astronautsManager.delivery_score*this.scene.scoreIncreaseMult);this.scene.addScores(n),this.scene.effectsManager.spawnEffect(this.shooter.x,this.shooter.y,"scores_enemy_1",{scores:n,enemy_type:"ufo_2"}),this.runPullSuccessTween()}}}else this.isTriggerPullOn=!1,this.isTriggerPullOff||(this.isTriggerPullOff=!0,this.progressGO.setVisible(!1),this.curPullProgress=this.scene.wavesManager.astronautsManager.pull_time,this.isWaitAstronaut&&this.blink(!0))}},{key:"runPullSuccessTween",value:function(){this.tweenOver1=this.scene.tweens.timeline({targets:this,tweens:[{delay:50,scale:1.05,ease:"Quad.easeOut",duration:60},{scale:1,ease:"Quad.easeInOut",duration:200}]})}},{key:"resetVars",value:function(){this.shooter=null,this.isFreeze=!1,this.ice=null,this.isWaitAstronaut=!1,this.isPull=!1,this.curPullProgress=1,this.isTriggerPullOn=!1,this.isTriggerPullOff=!1,this.blink(!1)}},{key:"set_skin",value:function(){return arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.skin,this.setTexture("atlas_objects","astronaut/station.png"),null===this.progressGO&&(this.progressGO=this.scene.wavesManager.astronautsManager.astronautProgressGroup.get(),this.progressGO.setZ(this.depth+1)),this.progressGO.setVisible(!1),this.set_collider(),this}},{key:"set_size",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.size;return this.size=e,this.setScale(this.size),this}},{key:"set_collider",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.collider;this.collider=e;var t=this.collider.shape;if("string"==typeof t&&"circle"===t){var s=this.collider.radius;this.body.setCircle(s,this.displayOriginX-s,this.displayOriginY-s),this.padding=1*s}return this}},{key:"readConfig",value:function(e){return this.set_skin(),this.set_size(),this}},{key:"readConfigByType",value:function(e){this.readConfig(this.config)}}])&&qr(s.prototype,i),n&&qr(s,n),t}();function na(e){return(na="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ra(e,t){for(var s=0;s<t.length;s++){var i=t[s];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function aa(e){return(aa=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function oa(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function ha(e,t){return(ha=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var la=function(e){function t(e,s,i,n){var r,a,o;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),a=this,(r=!(o=aa(t).call(this,e,s,i))||"object"!==na(o)&&"function"!=typeof o?oa(a):o).scene=e,r.scene.add.existing(oa(r)),r.setOrigin(.5),r.skin="",r.shooter=null,r.set_skin(),r}var s,i,n;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ha(e,t)}(t,Phaser.GameObjects.Image),s=t,(i=[{key:"spawn",value:function(e,t){this.show()}},{key:"show",value:function(){this.setActive(!0),this.setVisible(!0),this.setAlpha(1)}},{key:"hide",value:function(){this.setActive(!1),this.setVisible(!1)}},{key:"set_skin",value:function(){return this.setTexture("atlas_objects","astronaut/astronaut_ship.png"),this}}])&&ra(s.prototype,i),n&&ra(s,n),t}();function ua(e){return(ua="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ca(e,t){for(var s=0;s<t.length;s++){var i=t[s];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function pa(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function da(e,t,s){return(da="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,s){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=fa(e)););return e}(e,t);if(i){var n=Object.getOwnPropertyDescriptor(i,t);return n.get?n.get.call(s):n.value}})(e,t,s||e)}function fa(e){return(fa=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function ya(e,t){return(ya=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var ma=function(e){function t(e,s,i){var n,r,a;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),r=this,(n=!(a=fa(t).call(this,e,s,i))||"object"!==ua(a)&&"function"!=typeof a?pa(r):a).scene=e,n.scene.add.existing(pa(n)),n.setOrigin(.5),n.skin="",n.shooter=null,n.curProgress=0,n.isTriggerPushOn=!1,n.isTriggerPushOff=!1,n.set_skin(),n}var s,i,n;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ya(e,t)}(t,Phaser.GameObjects.Sprite),s=t,(i=[{key:"spawn",value:function(e,t){this.show()}},{key:"show",value:function(){this.setActive(!0),this.setVisible(!0),this.setAlpha(1)}},{key:"hide",value:function(){this.setActive(!1),this.setVisible(!1)}},{key:"preUpdate",value:function(e,s){da(fa(t.prototype),"preUpdate",this).call(this,e,s),this.active}},{key:"set_skin",value:function(){return this.play("astronaut_progress"),this}}])&&ca(s.prototype,i),n&&ca(s,n),t}();function va(e,t){for(var s=0;s<t.length;s++){var i=t[s];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var _a=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.scene=t,this.category="waves",this.type="0",this.units=Phaser.GLOBALS.units_waves[this.category].units,this.config=this.units.astronauts,this.delivery_score=2e3,this.pull_time=1e3,this.astronaut_size=1,this.astronaut_round_size=1,this.station_size=1,this.pickedPos=null,this.pickedZones=[];var s=this.scene.game.config.width/2,i=this.scene.game.config.height/2;this.STATION_POS=[{pos:[s,i],zones:[{x:210,y:80,w:170,h:120},{x:210,y:310,w:170,h:140},{x:40,y:180,w:180,h:140},{x:370,y:180,w:180,h:140}]}],this.astronautGroup=this.scene.physics.add.group({classType:Jr,maxSize:50,runChildUpdate:!0,active:!1,visible:!1}),this.stationGroup=this.scene.physics.add.group({classType:ia,maxSize:2,runChildUpdate:!0,active:!1,visible:!1}),this.astronautShipGroup=this.scene.physics.add.group({classType:la,maxSize:2,runChildUpdate:!1,active:!1,visible:!1}),this.astronautProgressGroup=this.scene.physics.add.group({classType:ma,maxSize:50,runChildUpdate:!0,active:!1,visible:!1});var n=this.scene.anims.generateFrameNames("atlas_objects",{start:1,end:61,zeroPad:4,prefix:"astronaut/astronaut_progress",suffix:".png",frames:!0});this.scene.anims.create({key:"astronaut_progress",frames:n,frameRate:0,repeat:0,yoyo:!1}),n=this.scene.anims.generateFrameNames("atlas_objects",{start:1,end:9,zeroPad:4,prefix:"astronaut/astronaut_pull_line",suffix:".png",frames:!0}),this.scene.anims.create({key:"astronaut_pull_line",frames:n,frameRate:10,repeat:-1,yoyo:!1}),b.addEditorEmmiter.call(this,function(e){})}var t,s,i;return t=e,(s=[{key:"reset",value:function(){this.scene.shipsGroup.getChildren().forEach(function(e){e.astronautPicked=null,e.astronautIsPull=!1,e.astronautFull=!1,e.astronautGO&&(e.remove(e.astronautGO),e.astronautGO.hide(),e.astronautGO=null)}),this.astronautGroup.getChildren().forEach(function(e){e.resetVars(),e.hide(!0)}),this.stationGroup.getChildren().forEach(function(e){e.resetVars(),e.hide(!0)}),this.astronautShipGroup.getChildren().forEach(function(e){e.hide(!0)}),this.pickedPos=null,this.pickedZones=[]}},{key:"pickPos",value:function(){return Phaser.Math.RND.pick(this.STATION_POS)}},{key:"generateStation",value:function(){var e=this;setTimeout(function(){var t=e.stationGroup.get();if(t){e.pickedPos||(e.pickedPos=e.pickPos());var s=e.pickedPos.pos[0],i=e.pickedPos.pos[1],n=Phaser.Math.DegToRad(Phaser.Math.Between(-30,30));t.spawn(s,i,n)}},this.scene.game.loop.delta)}},{key:"generateAstronauts",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.scene.wavesManager.astronauts_count,s=0,i=function i(){var n=e.astronautGroup.get();if(n){e.pickedPos||(e.pickedPos=e.pickPos()),0===e.pickedZones.length&&(e.pickedZones=e.pickedPos.zones.slice());var r=e.pickedZones.splice(Phaser.Math.Between(0,e.pickedZones.length-1),1)[0],a=Phaser.Math.Between(r.x,r.x+r.w),o=Phaser.Math.Between(r.y,r.y+r.h),h=Phaser.Math.RND.rotation();n.spawn(a,o,h)}++s<t&&setTimeout(function(){i()},e.scene.game.loop.delta)};setTimeout(function(){i()},this.scene.game.loop.delta)}},{key:"generate",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.scene.wavesManager.astronauts_count;this.generateStation(),this.generateAstronauts(e)}},{key:"putAstronautOnShip",value:function(e){e.set_skin("ship_yellow_1");var t=this.stationGroup.getFirstAlive();t&&(t.isWaitAstronaut=!0,t.blink(!0))}},{key:"removeAstronautFromShip",value:function(e){e.set_skin("ship_1");var t=this.stationGroup.getFirstAlive();t&&(t.isWaitAstronaut=!1,t.blink(!1))}},{key:"fadeStation",value:function(){var e=this;this.stationGroup.getChildren().forEach(function(t){e.scene.tweens.add({targets:t,alpha:0,ease:"Linear",duration:500,onComplete:function(){t.hide()}},e)})}},{key:"set_astronaut_size",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.astronaut_size;this.astronaut_size=e,this.astronautGroup.getChildren().forEach(function(t){t.active&&t.set_astronaut_size(e)})}},{key:"set_round_size",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.astronaut_round_size;this.astronaut_round_size=e,this.astronautGroup.getChildren().forEach(function(t){t.active&&t.set_round_size(e)})}},{key:"set_station_size",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.station_size;this.station_size=e,this.stationGroup.getChildren().forEach(function(t){t.active&&t.set_size(e)})}}])&&va(t.prototype,s),i&&va(t,i),e}();function ga(e){return(ga="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ba(e,t){for(var s=0;s<t.length;s++){var i=t[s];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function wa(e){return(wa=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function ka(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Oa(e,t){return(Oa=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Sa=function(e){function t(e,s,i){var n,r,a;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),r=this,a=wa(t).call(this,e,s,i),(n=!a||"object"!==ga(a)&&"function"!=typeof a?ka(r):a).scene=e,n.scene.add.existing(ka(n)),n.scene.physics.add.existing(ka(n)),n.setOrigin(.5),n.body.setEnable(!1),n.category="waves",n.units=Phaser.GLOBALS.units_waves[n.category].units,n.config=n.units.black_hole,n.skin="black_hole",n.size=n.scene.wavesManager.blackHoleManager.black_hole_size,n.collider={shape:"circle",radius:18,offset_x:0,offset_y:0},n.moveSpeed=n.scene.wavesManager.blackHoleManager.black_hole_speed,n.moveSpeedDir=1,n.moveRadiusH=n.scene.game.config.width/2,n.moveRadiusV=n.scene.game.config.height/2,n.moveRadiusMult=.86,n.moveRadiusAdd=0,n.moveInitAngle=0,n.moveAngle=0,n.rotateSpeed=n.scene.wavesManager.blackHoleManager.black_hole_rotate_speed,n.padding=0,n.shooter=null,n.enable=!1,n.isTriggerOn=!1,n.isTriggerOff=!1,n.timerEnableDelay=null,n.timerDelayAfterDeath=null,n.soundKilledByBlackHole=n.scene.sound.add("killed_by_black_hole",{mute:!1,volume:1,loop:!1}),n.soundCloseToBlackHole=n.scene.sound.add("close_to_black_hole",{mute:!1,volume:1,loop:!1}),n.isCloseToBlackHole=!1,n.soundCloseToBlackHole.on("complete",function(){n.isCloseToBlackHole&&n.soundCloseToBlackHole.play()}),n.set_skin(),n.set_size(),n}var s,i,n;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Oa(e,t)}(t,Phaser.Physics.Arcade.Image),s=t,(i=[{key:"spawn",value:function(e,t,s){this.set_size(this.scene.wavesManager.blackHoleManager.black_hole_size),this.resetVars(),this.body.reset(e,t),this.rotation=s,this.moveSpeedDir=Phaser.Math.RND.sign(),this.show(),this.body.preUpdate(),this.runTimerEnableDelay()}},{key:"spawnByAngle",value:function(e,t){this.moveInitAngle=Phaser.Math.DegToRad(e),this.set_size(this.scene.wavesManager.blackHoleManager.black_hole_size),this.resetVars();var s=this.getPosByAng(this.moveInitAngle);this.body.reset(s.x,s.y),this.rotation=t,this.moveSpeedDir=Phaser.Math.RND.sign(),this.moveAngle=0,this.show(),this.body.preUpdate(),this.runTimerEnableDelay()}},{key:"show",value:function(){this.setActive(!0),this.setVisible(!0),this.body.setEnable(!0),this.setAlpha(1)}},{key:"hide",value:function(){arguments.length>0&&void 0!==arguments[0]&&arguments[0],this.setActive(!1),this.setVisible(!1),this.body.setEnable(!1),this.resetVars()}},{key:"runTimerEnableDelay",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.scene.wavesManager.blackHoleManager.delay_before_enable;this.timerEnableDelay=this.scene.time.addEvent({delay:t,callback:function(){e.timerEnableDelay.remove(),e.enable=!0},callbackScope:this})}},{key:"runTimerDelayAfterDeath",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:300;this.timerDelayAfterDeath=this.scene.time.addEvent({delay:t,callback:function(){e.timerDelayAfterDeath.remove(),e.shooter.enable=!0,e.shooter.resetPosition(),e.shooter.rechargeShield(),e.runTimerEnableDelay()},callbackScope:this})}},{key:"getPosByAng",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Math.PI/4,t=this.scene.game.config.width/2+Math.cos(e)*(this.moveRadiusH*this.moveRadiusMult+this.moveRadiusAdd),s=this.scene.game.config.height/2+Math.sin(e)*(this.moveRadiusV*this.moveRadiusMult+this.moveRadiusAdd);return{x:t,y:s}}},{key:"preUpdate",value:function(e,t){var s=this;if(!this.scene.isGameOver){var i=t/1e3;if(this.moveSpeed>0){this.moveAngle+=this.moveSpeed*i*this.moveSpeedDir;var n=this.getPosByAng(this.moveAngle+this.moveInitAngle);this.body.reset(n.x,n.y),this.rotation+=this.rotateSpeed*i*this.moveSpeedDir}this.enable&&this.scene.shipsGroup.children.iterate(function(e){if(e.active){var i=s.scene.wavesManager.blackHoleManager.min_pull_force,n=s.scene.wavesManager.blackHoleManager.max_pull_force,r=Phaser.Math.Distance.Between(e.x,e.y,s.x,s.y)/2;r<s.scene.wavesManager.blackHoleManager.min_pull_radius&&(e.enable=!1),r>5&&r<s.scene.wavesManager.blackHoleManager.max_sound_radius?(s.isCloseToBlackHole=!0,s.soundCloseToBlackHole.isPlaying||s.soundCloseToBlackHole.play(),s.soundCloseToBlackHole.volume=1):s.isCloseToBlackHole=!1;var a=1e3;e.enable?(a=Math.lerp(n,i,Math.unlerp(s.scene.wavesManager.blackHoleManager.min_pull_radius,s.scene.wavesManager.blackHoleManager.max_pull_radius,r)),a=Phaser.Math.Clamp(a,i,n),a*=t):s.isTriggerOff||(s.isTriggerOff=!0,s.scene.tweens.add({targets:e,props:{scale:{value:.2,duration:200,ease:"Quad.easeIn",repeat:0},alpha:{value:0,duration:200,ease:"Quad.easeIn",repeat:0}},onComplete:function(t){e.shipDie({explode:!1,explode_zero_lives:!1}),s.scene.cameras.main.shake(80,.007),s.resetVars(),e.body.setGravity(0,0),e.gravity_={x:0,y:0},e.set_size(),s.shooter=e,s.scene.isGameOver||s.runTimerDelayAfterDeath(),s.soundCloseToBlackHole.stop(),s.soundKilledByBlackHole.play()}},s));var o=Phaser.Math.Angle.Between(e.x,e.y,s.x,s.y),h=Math.cos(o)*a*s.scene.wavesManager.blackHoleManager.pull_power,l=Math.sin(o)*a*s.scene.wavesManager.blackHoleManager.pull_power,u=Math.lerp(1,10,Math.unlerp(.994,.69,e.slowdown));e.gravity_={x:h*u,y:l*u}}})}}},{key:"resetVars",value:function(){this.enable=!1,this.isTriggerOff=!1,this.soundCloseToBlackHole.stop()}},{key:"set_skin",value:function(){return arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.skin,this.setTexture("atlas_objects","black_hole.png"),this.set_collider(),this}},{key:"set_size",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.size;return this.size=e,this.setScale(2*this.size),this}},{key:"set_collider",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.collider;this.collider=e;var t=this.collider.shape;if("string"==typeof t&&"circle"===t){var s=this.collider.radius;this.body.setCircle(s,this.displayOriginX-s,this.displayOriginY-s)}return this}}])&&ba(s.prototype,i),n&&ba(s,n),t}();function Pa(e,t){for(var s=0;s<t.length;s++){var i=t[s];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var Ma=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.scene=t,this.category="waves",this.type="0",this.units=Phaser.GLOBALS.units_waves[this.category].units,this.config=this.units.black_hole,this.black_hole_size=1,this.black_hole_speed=.05,this.black_hole_rotate_speed=1,this.min_pull_force=1.2,this.max_pull_force=6,this.max_pull_radius=300,this.min_pull_radius=20,this.max_sound_radius=50,this.min_sound_radius=10,this.delay_before_enable=1e3,this.pull_power=.5,this.pickedPos=null,this.BLACK_HOLE_POS=[[20,480],[580,480],[20,-20],[580,-20]],this.BLACK_HOLE_ANG=[45,-45,135,-135],this.blackHoleGroup=this.scene.physics.add.group({classType:Sa,maxSize:1,runChildUpdate:!0,active:!1,visible:!1}),b.addEditorEmmiter.call(this,function(e){})}var t,s,i;return t=e,(s=[{key:"reset",value:function(){this.blackHoleGroup.getChildren().forEach(function(e){e.hide(!0),e.soundCloseToBlackHole.stop()}),this.scene.shipsGroup.getChildren().forEach(function(e){e.body.setGravity(0,0),e.gravity_={x:0,y:0}}),this.pickedPos=null}},{key:"fadeHole",value:function(){var e=this;this.blackHoleGroup.getChildren().forEach(function(t){t.enable=!1,e.scene.tweens.add({targets:t,alpha:0,ease:"Linear",duration:500,onComplete:function(){t.hide()}},e),e.scene.tweens.add({targets:t.soundCloseToBlackHole,volume:0,ease:"Linear",duration:500,onComplete:function(){t.soundCloseToBlackHole.stop()}},e)})}},{key:"pickPos",value:function(){return Phaser.Math.RND.pick(this.BLACK_HOLE_POS)}},{key:"generate",value:function(){var e=this;setTimeout(function(){var t=e.blackHoleGroup.get();if(t){var s=Phaser.Math.RND.rotation();t.setDepth(0);var i=Phaser.Math.RND.pick(e.BLACK_HOLE_ANG);t.spawnByAngle(i,s),e.enableGravity()}},this.scene.game.loop.delta)}},{key:"enableGravity",value:function(){this.scene.shipsGroup.children.iterate(function(e){e.active})}},{key:"set_black_hole_size",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.black_hole_size;this.black_hole_size=e,this.blackHoleGroup.getChildren().forEach(function(t){t.set_size(e)})}},{key:"set_black_hole_speed",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.black_hole_speed;this.black_hole_speed=e}},{key:"set_black_hole_rotate_speed",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.black_hole_rotate_speed;this.black_hole_rotate_speed=e}},{key:"set_pull_power",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.pull_power;this.pull_power=e}}])&&Pa(t.prototype,s),i&&Pa(t,i),e}();function xa(e,t){for(var s=0;s<t.length;s++){var i=t[s];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var Ta=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.scene=t,this.category="waves",this.type="0",this.units=Phaser.GLOBALS.units_waves[this.category].units,this.config=this.units.limited_ammo,this.ammo_count=40,this.ammo_factor=10,this.isStartDelay=!0,this.isReloaded=!1,this.timerReloadDelay=null,this.soundAmmoReload=this.scene.sound.add("ammo_reload")}var t,s,i;return t=e,(s=[{key:"reset",value:function(){this.isStartDelay=!0,this.isReloaded=!1,this.timerReloadDelay&&this.timerReloadDelay.remove()}},{key:"generate",value:function(){setTimeout(function(){},this.scene.game.loop.delta)}},{key:"runTimerReloadDelay",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1e3;this.timerReloadDelay=this.scene.time.addEvent({delay:t,callback:function(){e.timerReloadDelay.remove(),e.isReloaded=!1,e.scene.isMissionCompleted||e.scene.isGameOver||(e.scene.wavesManager.limited_ammo_curCount=e.scene.wavesManager.limited_ammo_count,e.scene.wavesManager.updateTaskText(),e.soundAmmoReload.play(),e.scene.ui&&e.scene.ui.jumpMissionTask())},callbackScope:this})}},{key:"checkEmptyAmmo",value:function(){if(this.scene.wavesManager.limited_ammo_curCount<=0){if(this.scene.isMissionCompleted||this.scene.isGameOver)return;if(this.isReloaded)return;this.isReloaded=!0,this.scene.shipsGroup.getChildren().forEach(function(e){e.active&&e.shipDie({explode:!1})}),this.scene.effectsManager.spawnEffect(this.scene.game.config.width/2,this.scene.game.config.height/2,"wrong_color",{text:"Out of ammo, lose a life",font_size:50}),this.scene.cameras.main.shake(80,.007),this.runTimerReloadDelay()}}}])&&xa(t.prototype,s),i&&xa(t,i),e}();function Ca(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),s.push.apply(s,i)}return s}function Ea(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?Ca(s,!0).forEach(function(t){Aa(e,t,s[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):Ca(s).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))})}return e}function Aa(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}function ja(e,t){for(var s=0;s<t.length;s++){var i=t[s];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var Ba=function(){function e(t){var s=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.scene=t,this.mode=this.scene.hasOwnProperty("mode")?this.scene.mode:"classic",this.category="classic",this.type="default",this.unitsClassic=Phaser.GLOBALS.units_waves.classic.units[this.type],this.unitsMission=Phaser.GLOBALS.units_waves.waves.units,this.missionTitle="",this.missionDescr="",this.missionTask="",this.missiomTime=0,this.curMission=0,this.nextMissionType="",this.missionBonusScore=0,this.is_destroy_all=!0,this.destroy_all_time=20,this.is_color_based=!1,this.color_based_asteroids={},this.color_based_count=0,this.is_mines=!1,this.mines_count=0,this.is_timed_survival=!1,this.timed_survival_time=20,this.is_tasks=!1,this.tasks_time=20,this.tasks_asteroids=20,this.tasks_enemies=20,this.tasks_scores=20,this.tasks_is_asteroids=!1,this.tasks_is_enemies=!1,this.tasks_is_scores=!1,this.is_defend=!1,this.defend_type="unit_1",this.is_ufo_attack=!1,this.is_astronauts=!1,this.astronauts_count=2,this.astronauts_collected=0,this.is_black_hole=!1,this.is_limited_ammo=!1,this.limited_ammo_count=0,this.limited_ammo_curCount=0,this.limited_ammo_factor=1,this.limited_ammo_asteroids=0,this.spawn_powerups={},this.prepared_powerups={},this.curWave=0,this.wavesCount=10,this.waveText=null,this.startWaveTime=0,this.endWaveTime=0,this.startPartTime=0,this.endPartTime=0,this.soundDelayBeforeRun=1500,this.curSoundDelay=this.soundDelayBeforeRun,this.lastSoundBeatPlayed=0,this.isAttackTime=!1,this.isOneUfoOnScreen=!0,this.ufoSpawnedCount=0,this.curPart=0,this.partsCount=1,this.partPartWaitDelay=0,this.partAsteroidsCount=0,this.partAsteroidsPartsCount=0,this.partAsteroidsStartCount=0,this.partAsteroidsLeftSpawn=0,this.partAsteroidsArr=0,this.partAsteroidsWaitKill=0,this.partAsteroidsMaxCount=0,this.partEnemiesCount=0,this.partEnemiesLeftSpawn=0,this.partEnemiesStartCount=0,this.partEnemiesSpawnRate=3,this.partEnemiesIsIntervalAfterDeath=!1,this.partEnemiesWaitDeath=0,this.partEnemiesIsDeathByHero=!0,this.partEnemiesIsDeathByCollide=!1,this.partEnemiesIsDeathByBorder=!1,this.partEnemiesCreateDelayTimeouts=[],this.soundMissionFailOutOfTime=this.scene.sound.add("mission_fail_out_of_time",{mute:!1,volume:1,loop:!1}),this.soundMissionSuccess=this.scene.sound.add("mission_success_or_wave_complete",{mute:!1,volume:1,loop:!1}),this.timerSoundBeats=null,this.timerWaitBeforeUfoSpawn=null,this.timerSpawnUfoDelay=null,this.timerPartWaitDelay=null,this.timerAsteroidsSpawn=null,this.timerEnemiesSpawn=null,this.timerMissionTime=null,this.clockMissionTime=null,this.missionGenerator=new Or(this.scene),this.asteroidsManager=new xr(this.scene),this.enemiesManager=new Cr(this.scene),this.minesManager=new Nr(this.scene),this.astronautsManager=new _a(this.scene),this.blackHoleManager=new Ma(this.scene),this.limitedAmmoManager=new Ta(this.scene),this.updateCategory(),this.updateType(),this.updateWavesCount(),b.addEditorEmmiter.call(this,function(e){s.updateWavesCount()}),Phaser.hasOwnProperty("EDITOR")&&(this.editorEmmiter=Phaser.EDITOR.emitter.on("type_changed",function(e,t,i){s.category===t&&(s.updateType(),s.curWave=i,s.restartWave())},this))}var t,s,i;return t=e,(s=[{key:"runWave",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.curWave,s=arguments.length>1?arguments[1]:void 0;this.curWave=t;var i={is_first_launch:!1};s=Ea({},i,{},s),this.scene.lostLives=0,this.resetCurVars(),this.resetManagers(),this.timerFirstLaunch&&this.timerFirstLaunch.remove(),this.timerRunTextWave&&this.timerRunTextWave.remove(),this.timerRunWave&&this.timerRunWave.remove(),this.timerRunTaskText&&this.timerRunTaskText.remove(),this.clockMissionTime&&this.clockMissionTime.remove();var n=1e3,r=1500;if(s.is_first_launch&&(n=500,r=1e3),"classic"===this.mode)this.timerRunTextWave=this.scene.time.addEvent({delay:n,callback:function(){"game"===e.scene.layoutState&&(e.scene.ui&&e.scene.ui.waveText.run(e.curWave+1),e.scene.shipsManager.rechargeShield())},callbackScope:this}),this.timerRunWave=this.scene.time.addEvent({delay:r,callback:this.buildLevel,callbackScope:this});else if(s.type=this.nextMissionType,this.scene.shipsManager.resetPosition(),this.scene.shipsManager.rechargeShield(),this.buildMissionLevel(t,s),"game"===this.scene.layoutState){var a=this.missionDescr;this.scene.createMissionPanel({mission_num:this.curMission+1,title:this.missionTitle,descr:a}),this.scene.ui.setMissionToScore(this.curMission)}Phaser.hasOwnProperty("EDITOR")&&Phaser.EDITOR.setCurrentLevelText(this.curWave)}},{key:"runMissionTaskAndGame",value:function(){var e=this;this.timerRunTaskText=this.scene.time.addEvent({delay:800,callback:function(){e.scene.layoutState,e.is_limited_ammo&&(e.limitedAmmoManager.isStartDelay=!1,e.limitedAmmoManager.soundAmmoReload.play())},callbackScope:this}),this.missiomTime>0&&(this.timerRunTaskText=this.scene.time.addEvent({delay:200,callback:function(){"game"===e.scene.layoutState&&e.scene.ui&&(e.scene.ui.showMissionTimer(e.missiomTime),e.scene.ui.centerMissionTimer())},callbackScope:this})),this.timerRunWave=this.scene.time.addEvent({delay:1500,callback:function(){e.runPart(),e.missiomTime>0&&e.runTimerMissionTime(200),e.scene.shipsManager.startPowerupsRemain()},callbackScope:this}),this.scene.lostLives=0,this.scene.shipsManager.resetMoveKeys()}},{key:"buildLevel",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.curWave;arguments.length>1&&arguments[1],this.startWaveTime=this.scene.time.now,this.endWaveTime=this.startWaveTime+this.updateCurTimeBeforeAttack();var t,s,i,n=this.getValue("first_asteroids_count"),r=this.getValue("add_asteroids_count");t=n+r*Math.max(0,e),s=this.getValue("asteroids_type"),i=this.getValue("asteroids_spawn_zones"),this.asteroidsManager.spawnAsteroids(t,s,i);var a=this.updateCurUfoWaitBeforeSpawn();this.runTimerSpawnUfoDelay(a),this.runTimerSoundBeats(this.soundDelayBeforeRun)}},{key:"buildMissionLevel",value:function(){arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.curWave;var e=arguments.length>1?arguments[1]:void 0;this.missionGenerator.generateMission(this.curMission,e),this.startWaveTime=this.scene.time.now,this.partsCount=1,this.missiomTime=0,this.missionBonusScore=this.getValue("bonus_score"),this.is_destroy_all=this.getValue("destroy_all.is_destroy_all"),this.is_destroy_all&&(this.destroy_all_time=this.getValue("destroy_all.destroy_all_time"),this.missiomTime=this.destroy_all_time),this.is_mines=this.getValue("mines.is_mines"),this.is_mines&&(this.is_destroy_all=!0,this.mines_count=this.getValue("mines.mines_count"),this.minesManager.generate(this.mines_count)),this.is_timed_survival=this.getValue("timed_survival.is_timed_survival"),this.scene.mobileJoystick&&this.scene.mobileJoystick.fireBtn.setAlpha(1),this.is_timed_survival&&(this.is_destroy_all=!1,this.timed_survival_time=this.getValue("timed_survival.timed_survival_time"),this.missiomTime=this.timed_survival_time,this.scene.mobileJoystick&&this.scene.mobileJoystick.fireBtn.setAlpha(.1),this.scene.shipsGroup.getChildren().forEach(function(e){e.powerups.drill_bit&&e.powerups.drill_bit.go&&e.powerups.drill_bit.go.setEnabled(!1)})),this.is_ufo_attack=this.getValue("ufo_attack.is_ufo_attack"),this.is_ufo_attack&&(this.partMaxEnemiesOnScreen=this.getValue("ufo_attack.max_enemies_on_screen"),this.partMinEnemiesOnScreen=this.getValue("ufo_attack.min_enemies_on_screen")),this.is_black_hole=this.getValue("black_hole.is_black_hole"),this.is_black_hole&&(this.is_destroy_all=!0,this.blackHoleManager.pull_power=this.getValue("black_hole.pull_power"),this.blackHoleManager.generate()),this.partAsteroidsArr=this.createPartAsteroidsArr(),this.createTaskText()}},{key:"runPart",value:function(){if(arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.curPart,!this.scene.isMissionCompleted){this.partPartWaitDelay=0,this.startPartTime=this.scene.time.now,this.endPartTime=this.startPartTime+this.partPartWaitDelay,this.partAsteroidsCount=this.partAsteroidsArr[0].uid_count,this.partAsteroidsLeftSpawn=this.partAsteroidsCount,this.partAsteroidsMaxCount=-1,this.partAsteroidsPartsCount=this.partAsteroidsArr[this.curPart].destr_parts_count,this.partAsteroidsStartCount=this.partAsteroidsCount,this.partAsteroidsWaitKill=this.partAsteroidsPartsCount,this.partEnemiesStartCount=this.getPartValue("enemies.start_count_.ufo_1"),this.partEnemiesCount=this.getPartValue("enemies.count_"),this.partEnemiesCount=0===this.partEnemiesCount?this.partEnemiesStartCount:this.partEnemiesCount,this.partEnemiesLeftSpawn=this.partEnemiesCount>=0?this.partEnemiesCount:this.partEnemiesLeftSpawn,this.partEnemiesSpawnRate=this.getPartValue("enemies.spawn_rate.ufo_1"),this.partEnemiesChanceSmallUfo=this.getPartValue("enemies.chance_small_ufo"),this.partEnemiesIsIntervalAfterDeath=!1;var e=0===this.partEnemiesCount?this.partEnemiesStartCount:.99;e=e>0&&e<1?Math.round(this.partEnemiesCount*e):e,this.partEnemiesWaitDeath+=e,this.partEnemiesIsDeathByHero=!0,this.partEnemiesIsDeathByCollide=!0,this.partEnemiesIsDeathByBorder=!0;var t=0;this.runTimerAsteroidsSpawn(t);var s=0===this.partEnemiesStartCount?1e3*this.partEnemiesSpawnRate:0;this.runTimerEnemiesSpawn(s),this.is_ufo_attack&&this.scene.ui.setShipText(this.partEnemiesCount),Phaser.hasOwnProperty("EDITOR")&&Phaser.EDITOR.setCurrentLevelText("m:"+this.curMission+" p:"+this.curPart+"/"+this.partsCount)}}},{key:"checkEndOfWave",value:function(){var e=this;if("classic"===this.mode){var t=this.asteroidsManager.aliveCount,s=this.scene.enemiesGroup.countActive();this.is_destroy_all&&t<=0&&0===s&&(this.scene.cmgData(),this.curWave++,this.runWave(),setTimeout(function(){e.soundMissionSuccess.play()},300),this.curWave+1>this.scene.highestWave&&(this.scene.highestWave=this.curWave+1),(this.scene.curScores>this.scene.shipsSaves[this.scene.shipType].best_score_c||!this.scene.shipsSaves[this.scene.shipType].best_score_c)&&(this.scene.shipsSaves[this.scene.shipType].best_score_c=this.scene.curScores),this.scene.stats.beaten_waves_and_missions++,this.scene.saveSaves(),this.scene.checkReminders())}else{var i=(this.partEnemiesIsDeathByHero?this.enemiesManager.destroyedByHero:0)+(this.partEnemiesIsDeathByCollide?this.enemiesManager.destroyedByCollide:0)+(this.partEnemiesIsDeathByBorder?this.enemiesManager.destroyedByBorder:0);if(this.is_tasks){this.tasks_asteroids=Math.max(0,this.tasks_asteroids),this.tasks_enemies=Math.max(0,this.tasks_enemies),this.tasks_scores=Math.max(0,this.tasks_scores),this.updateTaskText();var n=!this.tasks_is_asteroids||this.tasks_is_asteroids===this.tasks_asteroids<=0,r=!this.tasks_is_enemies||this.tasks_is_enemies===this.tasks_enemies<=0,a=!this.tasks_is_scores||this.tasks_is_scores===this.tasks_scores<=0;if(n&&r&&a)return void this.endMission()}else if(this.is_astronauts&&(this.updateTaskText(),this.astronauts_collected>=this.astronauts_count))return void this.endMission();this.partAsteroidsWaitKill>=0&&this.asteroidsManager.destroyed>=this.partAsteroidsWaitKill&&i>=this.partEnemiesWaitDeath||this.partPartWaitDelay>0&&this.scene.time.now>=this.endPartTime&&this.partAsteroidsLeftSpawn<=0?(this.is_destroy_all||this.is_ufo_attack)&&this.asteroidsManager.aliveCount<=0&&0===this.scene.enemiesGroup.countActive()&&(this.endMission(),setTimeout(function(){e.soundMissionSuccess.play()},700)):(this.partEnemiesIsIntervalAfterDeath&&this.enemiesManager.uidDestroyed>=this.partEnemiesLeftSpawn&&this.runTimerEnemiesSpawn(),this.is_limited_ammo&&this.limitedAmmoManager.checkEmptyAmmo())}}},{key:"endMission",value:function(){var e=this;this.scene.isMissionCompleted||(this.scene.isMissionCompleted=!0,this.scene.shipsManager.pausePowerupsRemain(),this.scene.cmgData(),Phaser.hasOwnProperty("EDITOR")&&Phaser.EDITOR.isEdit&&this.curMission--,this.timerAsteroidsSpawn&&this.timerAsteroidsSpawn.remove(),this.timerEnemiesSpawn&&this.timerEnemiesSpawn.remove(),this.timerMissionTime&&this.timerMissionTime.remove(),this.clockMissionTime&&this.clockMissionTime.remove(),this.is_mines&&this.minesManager.setOverlapsActive(!1),this.scene.time.addEvent({delay:300,callback:function(){e.explodeAll()},callbackScope:this}),this.destroyEnemiesBullets(),this.timerShipText&&this.timerShipText.remove(),this.timerShipText=this.scene.time.addEvent({delay:300,callback:function(){e.scene.ui.shipTextGOcont.setVisible(!1)},callbackScope:this}),this.timerMissionTaskTimer&&this.timerMissionTaskTimer.remove(),this.timerMissionTaskTimer=this.scene.time.addEvent({delay:600,callback:function(){e.scene.ui.hideMissionTask(300),e.scene.ui.hideMissionTimer(300)},callbackScope:this}),this.timerMissionCompleted&&this.timerMissionCompleted.remove(),this.timerMissionCompleted=this.scene.time.addEvent({delay:800,callback:function(){if(!e.scene.isGameOver){e.curMission++;var t=function(){e.scene.createMissionCompletePanel("MISSION COMPLETE!"),e.scene.addScores(e.missionBonusScore)};e.is_mines||e.is_timed_survival||e.is_ufo_attack||e.is_black_hole?t():0===e.missiomTime?e.scene.createMissionCompletePanel("MISSION ABORTED"):t(),e.curMission+1>e.scene.highestMission&&(e.scene.highestMission=e.curMission+1),(e.scene.curScores>e.scene.shipsSaves[e.scene.shipType].best_score_m||!e.scene.shipsSaves[e.scene.shipType].best_score_m)&&(e.scene.shipsSaves[e.scene.shipType].best_score_m=e.scene.curScores),(e.curMission+1>e.scene.shipsSaves[e.scene.shipType].highest_m||!e.scene.shipsSaves[e.scene.shipType].highest_m)&&(e.scene.shipsSaves[e.scene.shipType].highest_m=e.curMission+1,e.scene.isNewBestMission=!0),e.scene.stats.beaten_waves_and_missions++,e.scene.saveSaves()}},callbackScope:this}),this.timerGotoNextMission&&this.timerGotoNextMission.remove(),this.timerGotoNextMission=this.scene.time.addEvent({delay:2300,callback:function(){e.scene.isGameOver||e.runWave()},callbackScope:this}))}},{key:"restartWave",value:function(){this.asteroidsManager.reset(),this.enemiesManager.reset(),this.updateWavesCount(),this.scene.runGame()}},{key:"nextWave",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;this.curWave+=e,this.curMission+=e,"mission"===this.mode&&(this.curWave=0),this.restartWave()}},{key:"prevWave",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;this.curWave-=e,this.curMission-=e,this.curWave=Math.max(0,this.curWave),this.curMission=Math.max(0,this.curMission),"mission"===this.mode&&(this.curWave=0),this.restartWave()}},{key:"runTimerSoundBeats",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;this.timerSoundBeats=this.scene.time.addEvent({delay:t,callback:function(){e.timerSoundBeats.remove();var t=e.getValue("start_sound_delay"),s=e.getValue("end_sound_delay");if(e.curSoundDelay=Math.lerp(t,s,Math.min(1,Math.unlerp(e.startWaveTime,e.endWaveTime,e.scene.time.now))),!e.isAttackTime&&e.scene.time.now>e.endWaveTime){e.isAttackTime=!0;var i=e.updateCurUfoWaitBeforeSpawn();e.isOneUfoOnScreen&&0===e.scene.enemiesGroup.countActive()&&e.runTimerSpawnUfoDelay(i)}e.runTimerSoundBeats(e.curSoundDelay)},callbackScope:this})}},{key:"runTimerAsteroidsSpawn",value:function(e){var t=this;this.timerAsteroidsSpawn&&this.timerAsteroidsSpawn.remove(),void 0===e&&(e=this.getStringRangeRand(this.getPartValue("asteroids.spawn_interval"))),this.timerAsteroidsSpawn=this.scene.time.addEvent({delay:e,callback:function(){var e=0;t.partAsteroidsStartCount>0&&(e=t.partAsteroidsStartCount,t.partAsteroidsStartCount=0),t.partAsteroidsCount>=0?(e=Math.min(t.partAsteroidsLeftSpawn,e),t.partAsteroidsLeftSpawn=Math.max(0,t.partAsteroidsLeftSpawn-e)):t.partAsteroidsLeftSpawn+=e;var s=["l","r","t","d"],i=!1;if(t.partAsteroidsMaxCount>=0&&t.asteroidsManager.aliveCount>=t.partAsteroidsMaxCount&&(i=!0),!i)if(t.partAsteroidsCount>=0)for(var n=0;n<e;n++){var r=t.partAsteroidsArr[t.curPart].types.pop(),a=r.type,o=r.destr,h=r.predicted_parts,l=Phaser.Math.RND.pick(s);t.asteroidsManager.spawnAsteroids(1,a,l,{destruction:o,predicted_parts:h})}else for(var u=["light_blue"],c=0;c<e;c++){var p=Phaser.Math.RND.pick(u),d=t.getStringRangeRand("0+2"[p]),f=Phaser.Math.RND.pick(s);t.asteroidsManager.spawnAsteroids(1,p,f,{destruction:d})}if(t.partAsteroidsLeftSpawn>0){if(!t.scene.isGameOver){var y=t.getStringRangeRand(t.getPartValue("asteroids.spawn_interval"));t.runTimerAsteroidsSpawn(y)}}else t.checkEndOfWave()},callbackScope:this})}},{key:"runTimerEnemiesSpawn",value:function(e){var t=this;void 0===e&&(e=this.getStringRangeRand(this.getPartValue("enemies.spawn_interval"))),this.timerEnemiesSpawn=this.scene.time.addEvent({delay:e,callback:function(){t.enemiesSpawn()},callbackScope:this})}},{key:"enemiesSpawn",value:function(){var e=this,t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],s=1;this.partEnemiesStartCount>0?(s=this.partEnemiesStartCount,this.partEnemiesStartCount=0):s=1,this.is_ufo_attack&&(s=Math.min(Math.max(0,this.partMaxEnemiesOnScreen-this.enemiesManager.aliveCount),s)),this.partEnemiesCount>=0?(s=Math.min(this.partEnemiesLeftSpawn,s),this.partEnemiesLeftSpawn=Math.max(0,this.partEnemiesLeftSpawn-s)):this.partEnemiesLeftSpawn+=s;for(var i=["l","r"],n=0,r=function(t){var s=Math.random()<e.partEnemiesChanceSmallUfo?"ufo_2":"ufo_1",r=Phaser.Math.RND.pick(i);n+=300;var a=setTimeout(function(){e.enemiesManager.spawnEnemies(1,s,r)},n);e.partEnemiesCreateDelayTimeouts.push(a)},a=0;a<s;a++)r(a);t&&(this.timerEnemiesSpawn&&this.timerEnemiesSpawn.remove(),this.partEnemiesLeftSpawn>0&&(this.scene.isGameOver||this.runTimerEnemiesSpawn(1e3*this.partEnemiesSpawnRate)))}},{key:"runTimerPartWaitDelay",value:function(e){var t=this;this.timerPartWaitDelay&&this.timerPartWaitDelay.remove(),this.timerPartWaitDelay=this.scene.time.addEvent({delay:e,callback:function(){t.checkEndOfWave()},callbackScope:this})}},{key:"runTimerWaitBeforeUfoSpawn",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;this.timerWaitBeforeUfoSpawn=this.scene.time.addEvent({delay:t,callback:function(){e.timerWaitBeforeUfoSpawn.remove(),e.runTimerSpawnUfoDelay(0)},callbackScope:this})}},{key:"runTimerSpawnUfoDelay",value:function(e){var t=this;this.timerSpawnUfoDelay&&this.timerSpawnUfoDelay.remove(),void 0===e&&(e=this.updateCurUfoSpawnDelay()),this.timerSpawnUfoDelay=this.scene.time.addEvent({delay:e,callback:function(){var e=t.updateCurUfoChanceSpawn();if(Phaser.Math.RND.frac()<=e){if(t.isOneUfoOnScreen&&0===t.scene.enemiesGroup.countActive()){var s=t.updateCurUfoChanceUfo();t.enemiesManager.spawnEnemies(1,[s],["l","r"])}}else{var i=t.updateCurUfoSpawnDelay();t.runTimerSpawnUfoDelay(i)}},callbackScope:this})}},{key:"runTimerMissionTime",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;this.timerMissionTime&&this.timerMissionTime.remove(),this.timerMissionTime=this.scene.time.addEvent({delay:t,callback:function(){e.clockMissionTime=e.scene.tweens.addCounter({from:0,to:1,ease:"Linear",duration:1e3,loop:-1,onStart:function(){e.missiomTime--,e.missionTask=Math.max(0,e.missiomTime),e.scene.ui&&(e.scene.ui.missionTimerSec.setText(e.missionTask),e.scene.ui.centerMissionTimer())},onLoop:function(t){e.missiomTime--,e.missionTask=Math.max(0,e.missiomTime),e.scene.ui&&e.scene.ui.missionTimerSec.setText(e.missionTask),0===e.missionTask?(t.remove(),e.scene.ui&&(e.scene.ui.missionTimerMillisec.setText("00"),e.scene.ui.jumpMissionTimer(),e.scene.ui.tweenTimerRedPulse&&e.scene.ui.tweenTimerRedPulse.stop(),e.is_timed_survival?e.endMission():e.is_destroy_all?(e.scene.ships.forEach(function(e){e.shipDie({explode:!1})}),e.scene.effectsManager.spawnEffect(e.scene.ui.missionTimerCont.x,e.scene.ui.missionTimerCont.y+.12*e.scene.game.config.height,"wrong_color",{text:"TIME OUT",font_size:36}),e.endMission(),e.soundMissionFailOutOfTime.play()):(e.scene.ships.forEach(function(e){e.shipDie({explode:!1})}),e.scene.lives>0?(e.scene.effectsManager.spawnEffect(e.scene.ui.missionTimerCont.x,e.scene.ui.missionTimerCont.y+.12*e.scene.game.config.height,"wrong_color",{text:"TIME OUT",font_size:36}),e.missiomTime=e.tasks_time,e.scene.ui.blinkMissionTimer(function(){e.scene.ui.showMissionTimer(e.missiomTime),e.timerMissionTime&&e.runTimerMissionTime(500)})):e.scene.effectsManager.spawnEffect(e.scene.ui.missionTimerCont.x,e.scene.ui.missionTimerCont.y+.12*e.scene.game.config.height,"wrong_color",{text:"TIME OUT",font_size:36})))):e.scene.ui.checkTimerRed(),e.scene.ui&&e.scene.ui.centerMissionTimer()},onUpdate:function(t,s){var i=Math.floor(Math.lerp(100,0,s.value));e.scene.ui&&e.scene.ui.missionTimerMillisec.setText(i<10?"0"+i:i)}},e)},callbackScope:this})}},{key:"updateCurTimeBeforeAttack",value:function(){var e=this.getLevelsRangeParams(this.getValue("time_before_attack")),t=e.first_level,s=e.last_level,i=e.first_val,n=e.last_val;return Math.lerp(i,n,Math.unlerp(t,s,this.curWave))}},{key:"updateCurUfoWaitBeforeSpawn",value:function(){var e=this.isAttackTime?"attack_time_ufo":"ufo_before_attack_time",t=this.getLevelsRangeParams(this.getValue(e).wait_before_spawn),s=t.first_level,i=t.last_level,n=t.first_val,r=t.last_val,a=Phaser.Math.RND.between(n.from,n.to),o=Phaser.Math.RND.between(r.from,r.to);return Math.lerp(a,o,Math.unlerp(s,i,this.curWave))}},{key:"updateCurUfoChanceSpawn",value:function(){var e=this.isAttackTime?"attack_time_ufo":"ufo_before_attack_time",t=this.getLevelsRangeParams(this.getValue(e).chance_spawn),s=t.first_level,i=t.last_level,n=t.first_val,r=t.last_val;return Phaser.Math.Clamp(Math.lerp(n,r,Math.unlerp(s,i,this.curWave)),0,1)}},{key:"updateCurUfoChanceUfo",value:function(){var e=this.isAttackTime?"attack_time_ufo":"ufo_before_attack_time",t=this.getLevelsRangeParams(this.getValue(e).chance_ufo),s=t.first_level,i=t.last_level,n=t.first_val,r=t.last_val,a=Math.unlerp(s,i,this.curWave),o={};for(var h in n)if(r.hasOwnProperty(h)){var l=n[h],u=r[h];o[h]=Math.max(0,Math.lerp(l,u,a))}var c=[];for(var p in o)for(var d=0;d<10*o[p];d++)c.push(p);return Phaser.Math.RND.pick(c)}},{key:"updateCurUfoSpawnDelay",value:function(){var e=this.isAttackTime?"attack_time_ufo":"ufo_before_attack_time",t=this.getLevelsRangeParams(this.getValue(e).spawn_delay),s=t.first_level,i=t.last_level,n=t.first_val,r=t.last_val,a=Math.unlerp(s,i,this.curWave),o={};for(var h in n)if(r.hasOwnProperty(h)){var l=n[h],u=r[h];o[h]=Math.max(0,Math.lerp(l,u,a))}var c=[];for(var p in o)for(var d=0;d<10*o[p];d++)c.push(p);return 1e3*Phaser.Math.RND.pick(c)}},{key:"createPartAsteroidsArr",value:function(){var e=[{uid_count:0,destr_parts_count:0,types:[]}],t=this.getPartValue("asteroids.start_count_",0),s=0;for(var i in t){var n=0;"middle"===i?n=1:"small"===i&&(n=2);for(var r=t[i],a=0;a<r;a++){var o={},h=[];s++;for(var l=1,u=n;u<2;u++){if(0===h.length)h.push(2),s+=2,l+=2;else{var c=h.slice();h=[];for(var p=0;p<c.length;p++)for(var d=c[p],f=0;f<d;f++)h.push(2),s+=2,l+=2}o[u]=h}e[0].types.push({type:"light_blue",destr:n,destr_type_count:l,predicted_parts:o})}}return e[0].uid_count=e[0].types.length,e[0].destr_parts_count=s,e}},{key:"createPartAsteroidsArr_",value:function(){for(var e=[],t={},s=[],i=0;i<this.partsCount;i++){var n=this.getStringRangeRand(this.getPartValue("asteroids.count",i));if(n<0)return[];var r=this.getPartValue("asteroids.chance_types",i);for(var a in s.push({count:n}),r)t.hasOwnProperty(a)||(t[a]=0),t[a]+=r[a],s[i].hasOwnProperty(a)||(s[i][a]=r[a])}for(var o=Object.assign({},this.color_based_asteroids),h=s.length,l=0;l<h;l++){e.push([]);var u=s[l].count;if(delete s[l].count,this.is_color_based)for(var c in this.color_based_asteroids){var p=this.color_based_asteroids[c],d=1/h;t[c]>0&&(d=s[l][c]/t[c]);var f=l===h-1?Math.max(0,o[c]):Math.round(p*d);o[c]-=f;for(var y=0;y<f;y++)e[l].push(c),u--;delete s[l][c]}var m=[];for(var v in s[l])for(var _=s[l][v],b=0;b<_;b++)m.push(v);if(m.length>0)for(var w=0;w<u;w++)e[l].push(Phaser.Math.RND.pick(m));e[l]=Phaser.Math.RND.shuffle(e[l])}for(var k=[],O=Phaser.GLOBALS.units_waves.asteroids.units,S=0;S<e.length;S++){var P=e[S],M=this.getPartValue("asteroids.init_destr",S),x=0,T=!1,C=0;k.push({uid_count:P.length,destr_parts_count:x,types:[]});for(var E=0;E<P.length;E++){var A=P[E],j=g(O[A],"destructions",2).value,B=this.getStringRangeRand(M[A]),D={},R=[];x++;for(var G=1,I=B;I<j;I++){if(0===R.length){var L=g(O[A],"explosive_parts",[2]).value,z=Phaser.Math.RND.pick(L);R.push(z),x+=z,G+=z}else{var V=R.slice();R=[];for(var U=0;U<V.length;U++)for(var F=V[U],H=0;H<F;H++){var N=g(O[A],"explosive_parts",[2]).value,W=Phaser.Math.RND.pick(N);R.push(W),x+=W,G+=W}}D[I]=R}k[S].types.push({type:A,destr:B,destr_type_count:G,predicted_parts:D}),this.is_color_based&&this.color_based_asteroids.hasOwnProperty(A)&&(T=!0,C+=G)}if(k[S].destr_parts_count=x,this.is_color_based)if(T){var K=this.getStringRangeRand(this.unitsMission[this.curWave].color_based.color_part_wait_kill_coeff,"float"),Q=Math.round(C*K),Y=C-Q;this.unitsMission[this.curWave].parts[S].asteroids.wait_kill_count=Q+"+"+Y}else this.unitsMission[this.curWave].parts[S].wait_delay=this.unitsMission[this.curWave].color_based.no_color_part_wait_delay}return k}},{key:"createLimitedAmmoPartAsteroidsArr",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;if(0===e||0===t)return[];var s=Math.round(e/t),i=(Phaser.GLOBALS.units_waves.asteroids.units,[]),n=0;i.push({uid_count:0,destr_parts_count:0,types:[]});for(var r={light_blue:"0+2"},a=0;n<s&&!(a>1e3);){var o="light_blue",h=2,l=this.getStringRangeRand(r[o]),u=1,c=2,p=s-n;if(n++,p<0)break;p<=2?l=2:p<7&&(l=1);for(var d={},f=[],y=l;y<h;y++){if(0===f.length)f.push(c),n+=c,u+=c;else{var m=f.slice();f=[];for(var v=0;v<m.length;v++)for(var _=m[v],g=0;g<_;g++)f.push(c),n+=c,u+=c}d[y]=f}i[0].types.push({type:o,destr:l,destr_type_count:u,predicted_parts:d})}return i[0].uid_count=i[0].types.length,i[0].destr_parts_count=n,i}},{key:"getSteroidsInitDestr",value:function(e){for(var t in e)e[t]=this.getStringRangeRand(e[t]);return e}},{key:"preparePowerups",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.spawn_powerups,t={comulative:0,loot:{}};for(var s in e){var i=e[s];if(i>0){var n=t.comulative;t.comulative+=i;var r=t.comulative;t.loot[s]={from:n,to:r}}}return t}},{key:"createTaskText",value:function(){var e="Timed Destroy",t="DESTROY ALL ASTEROIDS AND UFOS",s="THE CLOCK IS TICKING";if(this.is_mines)e="Don't Hit the Kitty!",t="DON'T HIT THE KITTY!",s="DESTROY EVERYTHING THAT DOESN'T HAVE EARS AND A TAIL";else if(this.is_timed_survival)e="Blasters Disabled",t="BLASTERS DISABLED",s="CAN YOU SURVIVE WITHOUT SHOOTING?";else if(this.is_tasks){var i="",n="";this.tasks_is_asteroids&&(i=n='<font="white" size='.concat(2," alpha=").concat(this.tasks_asteroids<=0?.2:1,">").concat(this.tasks_asteroids+" asteroids","</>")),this.tasks_is_enemies&&(n='<font="white" size='.concat(2," alpha=").concat(this.tasks_enemies<=0?.2:1,">").concat(this.tasks_enemies+" UFOs","</>"),i+=""===i?n:"\n"+n),i=""!==i?"Destroy "+i+"\n":"",this.tasks_is_scores&&(i+="Get "+(n='<font="white" size='.concat(2," alpha=").concat(this.tasks_scores<=0?.2:1,">").concat(this.tasks_scores+" scores","</>"))),s=t=i,e="Destroy certain objects"}else this.is_ufo_attack?(e="UFO Attack",s=t="DESTROY THE ENEMY FLEET"):this.is_astronauts?(e="Save the astronauts",t='Deliver <font="white" size='.concat(2," alpha=",1,">").concat(this.astronauts_collected,"/").concat(this.astronauts_count," </>astronauts\nto the station"),s="Deliver all astronauts\nto the station"):this.is_black_hole?(e="Black Hole",t='\x3c!--Destroy all asteroids and UFO<font="aller_red" size='.concat(16," alpha=",1,">\nBeware of the Black Hole!</>--\x3e"),t='\x3c!--DESTROY ALL ASTEROIDS AND UFOS<font="aller_red" size='.concat(16," alpha=",1,">\nBEWARE OF THE BLACK HOLE!</>--\x3e"),s=t="DON'T GET SUCKED IN!"):this.is_limited_ammo&&(e="Limited Ammo",s=t='Destroy <font="white" size='.concat(2," alpha=").concat(this.limited_ammo_asteroids<=0?.2:1,">").concat(this.limited_ammo_asteroids,' </>asteroids\nYou have <font="yellow" size=').concat(2," alpha=").concat(this.limited_ammo_curCount<=0?.2:1,">").concat(this.limited_ammo_curCount,"</> ammo"));this.missionTitle=e,this.missionDescr=s,this.missionTask=t}},{key:"updateTaskText",value:function(){this.createTaskText(),this.scene.ui&&this.scene.ui.missionTask.setText(this.missionTask)}},{key:"explodeAll",value:function(){var e=this;this.scene.ships.forEach(function(t){t.body.setGravity(0,0),t.gravity_={x:0,y:0};var s=e.scene.physics.add.image(t.x,t.y,"atlas_objects","powerups/bomb_explode.png");s.setVisible(!1);var i=s.width/2;s.body.setCircle(i,s.displayOriginX-i,s.displayOriginY-i),e.scene.tweens.add({targets:s,scale:10,ease:"Linear",duration:1500,onUpdate:function(){e.scene.physics.world.overlap(s,e.scene.asteroidsGroup,function(e,t){("asteroids"===e.category?e:t).subDestruction(99,!0)}),e.scene.physics.world.overlap(s,e.scene.enemiesGroup,function(e,t){("enemies"===e.category?e:t).subDestruction(99)})},onComplete:function(){s.destroy()}},e)}),this.is_mines&&this.minesManager.fadeMines(),this.is_astronauts&&this.astronautsManager.fadeStation(),this.is_black_hole&&this.blackHoleManager.fadeHole()}},{key:"destroyEnemiesBullets",value:function(){this.scene.enemiesBulletsGroup.getChildren().forEach(function(e){e.active&&e.hide()})}},{key:"updateCurSoundDelay",value:function(){}},{key:"resetCurVars",value:function(){this.scene.isMissionCompleted=!1,this.curSoundDelay=this.soundDelayBeforeRun,this.lastSoundBeatPlayed=0,this.isAttackTime=!1,this.missionBonusScore=0,this.is_destroy_all=!0,this.is_mines=!1,this.is_timed_survival=!1,this.is_tasks=!1,this.is_ufo_attack=!1,this.is_astronauts=!1,this.is_black_hole=!1,this.is_limited_ammo=!1,this.curPart=0,this.partAsteroidsWaitKill=0,this.partAsteroidsLeftSpawn=0,this.partEnemiesWaitDeath=0,this.partEnemiesLeftSpawn=0,this.updateCategory(),this.updateType();for(var e=0;e<this.partEnemiesCreateDelayTimeouts.length;e++)clearTimeout(this.partEnemiesCreateDelayTimeouts[e]);this.timerSoundBeats&&this.timerSoundBeats.remove(),this.timerWaitBeforeUfoSpawn&&this.timerWaitBeforeUfoSpawn.remove(),this.timerSpawnUfoDelay&&this.timerSpawnUfoDelay.remove(),this.timerAsteroidsSpawn&&this.timerAsteroidsSpawn.remove(),this.timerEnemiesSpawn&&this.timerEnemiesSpawn.remove(),this.clockMissionTime&&this.clockMissionTime.remove(),this.timerRunTextWave&&this.timerRunTextWave.remove(),this.timerRunTaskText&&this.timerRunTaskText.remove(),this.timerRunWave&&this.timerRunWave.remove(),this.timerMissionTime&&this.timerMissionTime.remove(),this.timerShipText&&this.timerShipText.remove(),this.timerMissionTaskTimer&&this.timerMissionTaskTimer.remove(),this.timerMissionCompleted&&this.timerMissionCompleted.remove(),this.timerGotoNextMission&&this.timerGotoNextMission.remove(),this.ufoSpawnedCount=0,this.scene.shipsManager.resetThrusters(),this.scene.shipsGroup.getChildren().forEach(function(e){e.powerups.drill_bit&&e.powerups.drill_bit.go&&e.powerups.drill_bit.go.setEnabled(!0)}),this.nextMissionType="",Phaser.hasOwnProperty("EDITOR")&&Phaser.EDITOR.isEdit&&Phaser.EDITOR.unitsFirst.hasOwnProperty("pcg")&&(this.nextMissionType=Phaser.EDITOR.unitsFirst.pcg)}},{key:"resetManagers",value:function(){this.asteroidsManager.reset(),this.enemiesManager.reset(),this.minesManager.reset(),this.astronautsManager.reset(),this.blackHoleManager.reset(),this.limitedAmmoManager.reset()}},{key:"updateWavesCount",value:function(){return this.wavesCount=this.missionGenerator.lvl_max,this.wavesCount}},{key:"updateCategory",value:function(){return this.category="classic"===this.mode?"classic":"waves",this.category}},{key:"updateType",value:function(){return this.type="classic"===this.mode?"default":""+this.curWave,this.type}},{key:"getLevelsRangeParams",value:function(e){var t,s,i=9999999,n=0;for(var r in e){var a=Math.max(0,Number(r.replace(/[^0-9]+/i,"")));a<=i&&(i=a,t=e[r]),a>=n&&(n=a,s=e[r])}return{first_level:i,last_level:n,first_val:t=t.hasOwnProperty("e_val")?t.e_val:t,last_val:s=s.hasOwnProperty("e_val")?s.e_val:s}}},{key:"getStringRangeRand",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"int",s=[];return/\+/i.test(e)?(s=e.split("+"))[1]=Number(s[0])+Number(s[1]):/\,/i.test(e)?s=e.split(","):/\.{2,}/i.test(e)?s=e.split(/\.{2,}/i):s.push(e),1===s.length?Number(s[0]):2===s.length?"int"===t?Phaser.Math.RND.between(Number(s[0]),Number(s[1])):Phaser.Math.RND.realInRange(Number(s[0]),Number(s[1])):Number(Phaser.Math.RMD.pick(s))}},{key:"getConfig",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.mode;return this.mode!==e&&(this.mode=e),"classic"===this.mode?this.config=this.unitsClassic:(this.curWave=Math.min(this.unitsMission.length,this.curWave),this.config=this.unitsMission[this.curWave]),this.config}},{key:"getValue",value:function(e){return g(this.getConfig(),e,this[e]).value}},{key:"getPartValue",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.curPart;return this.getValue("parts."+t+"."+e)}},{key:"set_mode",value:function(e){return this.mode=e,this}},{key:"set_category",value:function(e){return this.category=e,this}},{key:"set_asteroids_type",value:function(e){return this.asteroids_type=e,this}},{key:"set_asteroids_spawn_zones",value:function(e){return this.asteroids_spawn_zones=e,this}},{key:"set_is_destroy_all",value:function(e){return this.is_destroy_all=e,this}},{key:"set_destroy_all_time",value:function(e){return this.destroy_all_time=e,this}},{key:"set_is_timed_survival",value:function(e){return this.is_timed_survival=e,this}},{key:"set_timed_survival_time",value:function(e){return this.timed_survival_time=e,this}},{key:"set_is_tasks",value:function(e){return this.is_tasks=e,this}},{key:"set_tasks_time",value:function(e){return this.tasks_time=e,this}},{key:"set_tasks_asteroids",value:function(e){return this.tasks_asteroids=e,this}},{key:"set_tasks_enemies",value:function(e){return this.tasks_enemies=e,this}},{key:"set_tasks_scores",value:function(e){return this.tasks_scores=e,this}},{key:"set_is_defend",value:function(e){return this.is_defend=e,this}},{key:"set_defend_type",value:function(e){return this.defend_type=e,this}},{key:"set_first_asteroids_count",value:function(e){return this.first_asteroids_count=e,this}},{key:"set_add_asteroids_count",value:function(e){return this.add_asteroids_count=e,this}},{key:"set_time_before_attack",value:function(e){return this.time_before_attack=e,this}},{key:"readConfig",value:function(e){void 0===e&&(e=this.getConfig())}}])&&ja(t.prototype,s),i&&ja(t,i),e}();function Da(e){return(Da="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Ra(e,t){for(var s=0;s<t.length;s++){var i=t[s];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function Ga(e,t){return!t||"object"!==Da(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Ia(e){return(Ia=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function La(e,t){return(La=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var za=function(e){function t(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=Ga(this,Ia(t).call(this,{key:"MenuUI"}))).gameScene=null,e.panelsManager=null,e.btnPlayerOne=null,e.btnPlayerTwo=null,e.btnModeClassic=null,e.btnModeMission=null,e.highestMissionText=null,e.btnPlay=null,e.btnSound=null,e.isInputActive=!1,e.CARUSEL_BETWEEN_ITEMS=140,e}var s,i,n;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&La(e,t)}(t,Phaser.Scene),s=t,(i=[{key:"create",value:function(){var e=this;this.gameScene=this.scene.get("GameScene"),this.panelsManager=new Pn(this),this.createMenuUI(),this.input.keyboard.on("keydown",function(t){Phaser.EDITOR||t.preventDefault(),e.isInputActive&&(t.keyCode!==Phaser.Input.Keyboard.KeyCodes.SPACE||e.gameScene.keyPressed.has(t.keyCode)||(e.gameScene.keyPressed.add(t.keyCode),e.playHandler(),e.btnPlay.soundDown.play()),t.keyCode===Phaser.Input.Keyboard.KeyCodes.LEFT?(e.gameScene.keyPressed.has(t.keyCode)||e.gameScene.keyPressed.add(t.keyCode),e.caruselArrowsHandler("right"),e.cariselLeftArrow.soundDown.play()):t.keyCode===Phaser.Input.Keyboard.KeyCodes.RIGHT&&(e.gameScene.keyPressed.has(t.keyCode)||e.gameScene.keyPressed.add(t.keyCode),e.caruselArrowsHandler("left"),e.cariselRightArrow.soundDown.play()))}),this.input.keyboard.on("keyup",function(t){e.isInputActive&&e.gameScene.keyPressed.delete(t.keyCode)}),this.events.on("wake",function(t,s){e.sound.setMute(!e.gameScene.is_sound),e.setPlayers(),e.setGameMode(),e.orderCarusel(),e.isInputActive=!1,setTimeout(function(){e.isInputActive=!0},500)}),this.scene.sleep()}},{key:"playersHandler",value:function(){this.gameScene.changePlayers(this.players)}},{key:"modeHandler",value:function(){this.gameScene.changeMode(this.mode)}},{key:"playHandler",value:function(){"off"!==this.btnPlay.state&&this.btnPlay.active&&(this.gameScene.changeMode(this.mode),this.gameScene.wavesManager.curWave=0,this.gameScene.runGame())}},{key:"soundHandler",value:function(e){this.gameScene.toggleSound("on"===e)}},{key:"setPlayers",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.gameScene.players;this.players!==e&&(this.players=e,this.playersHandler())}},{key:"setGameMode",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.gameScene.mode;if(this.mode!==e&&(this.mode=e,this.gameScene.mode=this.mode),"classic"===this.mode){this.btnModeClassic.setState("on"),this.btnModeMission.setState("off");var t=0;Phaser.GLOBALS.saves.ships&&Phaser.GLOBALS.saves.ships[this.gameScene.shipType]&&Phaser.GLOBALS.saves.ships[this.gameScene.shipType].best_score_c&&(t=Phaser.GLOBALS.saves.ships[this.gameScene.shipType].best_score_c),this.highestMissionText.setText("High Score: "+t)}else{this.btnModeClassic.setState("off"),this.btnModeMission.setState("on");var s=0;Phaser.GLOBALS.saves.ships&&Phaser.GLOBALS.saves.ships[this.gameScene.shipType]&&Phaser.GLOBALS.saves.ships[this.gameScene.shipType].highest_m&&(s=Phaser.GLOBALS.saves.ships[this.gameScene.shipType].highest_m),this.highestMissionText.setText("Best Mission: "+s)}}},{key:"caruselArrowsHandler",value:function(e){var t=this;if("left"===e){var s=this.caruselItemsArr.shift();this.caruselItemsArr.push(s)}else{var i=this.caruselItemsArr.pop();this.caruselItemsArr.unshift(i)}this.gameScene.shipType=this.caruselItemsArr[1].name,this.gameScene.saveSaves(),this.caruselDetails.setText(""),this.btnPlay.active=!1;for(var n=function(s){var i=t.caruselItemsArr[s],n=i.x,r=0,a=1;"left"===e?0===s||1===s?n=t.CARUSEL_BETWEEN_ITEMS*s-t.CARUSEL_BETWEEN_ITEMS:s===t.caruselItemsArr.length-1?(a=.5,3===t.caruselItemsArr.length&&(i.x=t.CARUSEL_BETWEEN_ITEMS,n=i.x,i.scale=.5,a=1)):2===s&&(i.x=t.CARUSEL_BETWEEN_ITEMS,n=i.x,i.scale=.5):1===s||2===s?n=t.CARUSEL_BETWEEN_ITEMS*s-t.CARUSEL_BETWEEN_ITEMS:3===s?a=.5:0===s&&(i.x=-t.CARUSEL_BETWEEN_ITEMS,n=i.x,i.scale=.5),0===s||2===s?r=.2:1===s&&(r=1),i.tweenMove&&i.tweenMove.stop(),i.tweenMove=t.tweens.timeline({targets:i,tweens:[{x:n,ease:"Linear",duration:300},{alpha:r,ease:"Linear",duration:300,offset:"-=300"},{scale:a,ease:"Linear",duration:300,offset:"-=300"}],onComplete:function(e){i.name===t.gameScene.shipType&&(i.isLocked?(t.btnPlay.setState("off"),t.btnPlay.alpha=.5):(t.btnPlay.setState("on"),t.btnPlay.alpha=1,t.btnPlay.active=!0),t.setShipDescr(i)),t.setGameMode()}})},r=0;r<this.caruselItemsArr.length;r++)n(r)}},{key:"orderCarusel",value:function(){for(var e={classic_scores:"Score [num] in Classic mode",reach_wave:"Reach wave [num] in classic",reach_mission:"Reach mission [num]",destroy_asteroids:"Destroy [num] asteroids in any mode",destroy_ufos:"Destroy [num] UFOs",beat_waves_and_missions:"Beat [num] waves/missions total"},t=this.gameScene.shipType,s=0;s<this.caruselItemsArr.length&&this.caruselItemsArr[1].name!==t;s++)this.caruselItemsArr.push(this.caruselItemsArr.shift());for(var i=function(e,t,s,i){return e+=""!==e?"\n":"",e+=t.replace(/\[num\]/i,s)+" ("+i+"/"+s+")"},n=Phaser.GLOBALS.units_waves.ships.units,r=0;r<this.caruselItemsArr.length;r++){var a=this.caruselItemsArr[r];a.x=this.CARUSEL_BETWEEN_ITEMS*r-this.CARUSEL_BETWEEN_ITEMS,a.alpha=0,0===r||2===r?a.alpha=.2:1===r&&(a.alpha=1);var o=a.getByName("lock"),h=!1,l="",u=n[a.name],c=u.unlock&&u.unlock.rules?u.unlock.rules:null;if(c){var p=!1,d=!0;for(var f in l="",c)if("e_descr"!==f&&c[f]>0)switch(d=!1,f){case"classic_scores":c[f]<=this.gameScene.bestClassicScores?p=!0:l=i(l,e[f],c[f],this.gameScene.bestClassicScores);break;case"reach_wave":c[f]<=this.gameScene.highestWave?p=!0:l=i(l,e[f],c[f],this.gameScene.highestWave);break;case"reach_mission":c[f]<=this.gameScene.highestMission?p=!0:l=i(l,e[f],c[f],this.gameScene.highestMission);break;case"destroy_asteroids":this.gameScene.stats.hasOwnProperty("destroyed_asteroids")&&(c[f]<=this.gameScene.stats.destroyed_asteroids?p=!0:l=i(l,e[f],c[f],this.gameScene.stats.destroyed_asteroids));break;case"destroy_ufos":this.gameScene.stats.hasOwnProperty("destroyed_ufos")&&(c[f]<=this.gameScene.stats.destroyed_ufos?p=!0:l=i(l,e[f],c[f],this.gameScene.stats.destroyed_ufos));break;case"beat_waves_and_missions":this.gameScene.stats.hasOwnProperty("beaten_waves_and_missions")&&(c[f]<=this.gameScene.stats.beaten_waves_and_missions?p=!0:l=i(l,e[f],c[f],this.gameScene.stats.beaten_waves_and_missions))}h=!(p||d)}a.isLocked=h,a.lockedText=l,o.visible=a.isLocked,a.name===t&&(a.isLocked?(this.btnPlay.setState("off"),this.btnPlay.alpha=.5,this.btnPlay.active=!1):(this.btnPlay.setState("on"),this.btnPlay.alpha=1,this.btnPlay.active=!0),this.setShipDescr(a))}}},{key:"setShipDescr",value:function(e){var t=Phaser.GLOBALS.units_waves.ships.units[e.name];e.isLocked?this.caruselDetails.setText(e.lockedText):this.caruselDetails.setText(t.details)}},{key:"createMenuUI",value:function(){var e=this,t=this.panelsManager.addSprite({key:["atlas_objects","panels/menu_logo.png"]});this.panelsManager.addContainer({init_x:.5,init_y:.16,anchor_ltrd:"t",anchor_weight:[1,.65],name:"menu_logo",children:[t]}),this.btnModeClassic=this.panelsManager.addButton({init_x:-64,init_y:0,anchor_ltrd:"",name:"btn_mode_classic",state:"on",tween_down:{type:"scale_down"},bg:{on:["atlas_objects","panels/btn_mode_left0001.png"],off:["atlas_objects","panels/btn_mode_left0002.png"]},text:{text_on:"CLASSIC",text_off:"CLASSIC",font_on:"aller_dark",font_off:"aller_white",font_size:20,pos:[.5,.55],is_bitmap:!0}}),this.btnModeMission=this.panelsManager.addButton({init_x:64,init_y:0,anchor_ltrd:"",name:"btn_player_one",state:"off",tween_down:{type:"scale_down"},bg:{on:["atlas_objects","panels/btn_mode_right0001.png"],off:["atlas_objects","panels/btn_mode_right0002.png"]},text:{text_on:"MISSIONS",text_off:"MISSIONS",font_on:"aller_dark",font_off:"aller_white",font_size:20,pos:[.5,.55],is_bitmap:!0}}),this.btnModeClassic.on("down",function(t){e.setGameMode("classic"),t.state}),this.btnModeMission.on("down",function(t){e.setGameMode("mission"),t.state}),this.panelsManager.addContainer({init_x:.5,init_y:.38,anchor_ltrd:"",anchor_weight:[1,1],name:"",children:[this.btnModeClassic,this.btnModeMission]}),this.caruselItemsCont=this.panelsManager.addContainer({init_x:0,init_y:0,children:function(){var t=Phaser.GLOBALS.units_waves.ships.units;e.caruselItemsArr=[];var s=0;for(var i in t){var n=e.panelsManager.addBitmapText({init_x:0,init_y:-56,origin:[.5],font:"aller_white",text:t[i].name.toUpperCase(),font_size:12,align_h:"center"}),r=e.panelsManager.addImage({name:"ship",init_x:0,init_y:-14,key:["atlas_objects","panels/carusel_"+t[i].skin+".png"]});r.scale=.9;var a=e.panelsManager.addImage({name:"lock",init_x:25,init_y:16,key:["atlas_objects","panels/carusel_lock.png"]}),o=e.panelsManager.addButton({init_x:0,init_y:-6,name:t[i].name,bg:{on:["atlas_objects","panels/carusel_item_btn.png"]},collider:{size:[2,2]},sound:{down:null}});o.on("down",function(e){});var h=e.panelsManager.addContainer({init_x:e.CARUSEL_BETWEEN_ITEMS*s,init_y:0,name:i,children:[n,r,a,o]});e.caruselItemsArr.push(h),s++}return e.caruselItemsArr}()});var s=this.panelsManager.addImage({init_x:0,init_y:0,key:["atlas_objects","panels/carusel_bg.png"]});this.highestMissionText=this.panelsManager.addBitmapText({init_x:0,init_y:40,origin:[.5],font:"aller_red",text:"Highest mission reached: 10",font_size:12,align_h:"center"}),this.caruselDetails=this.panelsManager.addBitmapText({init_x:0,init_y:60,origin:[.5],font:"aller_white",text:"Fast an agile but low fire distance.\nPress [up arrow] for reverse thrusters.",font_size:12,letterSpacing:0,align_h:"center"}),this.cariselRightArrow=this.panelsManager.addButton({init_x:-235,init_y:0,name:"right",bg:{on:["atlas_objects","panels/carusel_arrow.png"]}}),this.cariselRightArrow.rotation=Math.PI,this.cariselRightArrow.on("down",function(t){e.caruselArrowsHandler(t.name)}),this.cariselLeftArrow=this.panelsManager.addButton({init_x:235,init_y:0,name:"left",bg:{on:["atlas_objects","panels/carusel_arrow.png"]}}),this.cariselLeftArrow.on("down",function(t){e.caruselArrowsHandler(t.name)}),this.carusel=this.panelsManager.addContainer({init_x:.5,init_y:.62,anchor_ltrd:"d",anchor_weight:[1,.3],name:"",children:[s,this.highestMissionText,this.caruselDetails,this.caruselItemsCont,this.cariselRightArrow,this.cariselLeftArrow]}),this.btnPlay=this.panelsManager.addButton({init_x:.5,init_y:.88,anchor_ltrd:"d",anchor_weight:[1,.65],name:"btn_play",tween_down:{type:"scale_down"},bg:{on:["atlas_objects","panels/btn_play.png"],off:["atlas_objects","panels/btn_play_off.png"]},text:{text:"START",weight:"bold",font_size:26,pos:[.5,4],is_bitmap:!0,font:"white"}}),this.btnPlay.active=!0,this.btnPlay.on("down",function(t){e.playHandler()}),this.btnSound=this.panelsManager.addButton({init_x:.07,init_y:.91,anchor_ltrd:"ld",name:"btn_sound",is_toggle:!0,state:this.gameScene.is_sound?"on":"off",tween_down:{type:"scale_down"},bg:{on:["atlas_objects","panels/btn_sound_on.png"],off:["atlas_objects","panels/btn_sound_off.png"]}}),this.btnSound.on("down",function(t){e.soundHandler(t.state)})}}])&&Ra(s.prototype,i),n&&Ra(s,n),t}();function Va(e){return(Va="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Ua(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Fa(e,t){for(var s=0;s<t.length;s++){var i=t[s];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function Ha(e,t,s){return t&&Fa(e.prototype,t),s&&Fa(e,s),e}function Na(e,t){return!t||"object"!==Va(t)&&"function"!=typeof t?Ka(e):t}function Wa(e){return(Wa=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Ka(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Qa(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Ya(e,t)}function Ya(e,t){return(Ya=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Xa=function(e){function t(e){var s;return Ua(this,t),(s=Na(this,Wa(t).call(this,e,0,0,"white"))).scene=e,s.scene.add.existing(Ka(s)),s}return Qa(t,Phaser.GameObjects.BitmapText),Ha(t,[{key:"show",value:function(){this.setActive(!0),this.setVisible(!0)}},{key:"hide",value:function(){this.setActive(!1),this.setVisible(!1)}}]),t}(),Ja=function(e){function t(e,s){var i;return Ua(this,t),(i=Na(this,Wa(t).call(this,e,0,0))).scene=e,i.scene.add.existing(Ka(i)),i.text="MISSION COMPLETED",i.timelines=[],i.textGO=null,i.panelsManager=new Pn(i.scene),i.lettersGroup=i.scene.add.group({classType:Xa,maxSize:30,runChildUpdate:!1,active:!1,visible:!1}),i.create(i.text),i}return Qa(t,Phaser.GameObjects.Container),Ha(t,[{key:"create",value:function(){this.textGO=this.panelsManager.addBitmapText({init_x:0,init_y:0,origin:[.5,.6],font:"aller_white",text:this.text,font_size:36,align_h:"center"}),this.textGO.setVisible(!1),this.add(this.textGO)}},{key:"create_",value:function(e){var t=this;this.stop(),this.timelines=[];var s=e,i=s.length;this.x=0,this.y=0;for(var n=0,r=function(e){var r=t.lettersGroup.get();r.setText(s[e]),r.setFont("white"),r.setFontSize(-64),r.setOrigin(0,.5);var a=r.getTextBounds().local.width;r.x=0+n+2,r.y=-40,n+=a+2,r.show(),r.setAlpha(0);var o=t.scene.tweens.timeline({targets:r,tweens:[{y:r.y,ease:"Linear",duration:30*e},{y:0,ease:"Quad.easeOut",duration:300},{alpha:1,ease:"Linear",duration:200,offset:"-=200"},{y:-2,ease:"Quad.easeInOut",duration:1e3},{y:24,ease:"Quad.easeIn",duration:500,onComplete:function(){e===i-1&&t.stop()}},{alpha:0,ease:"Linear",duration:200,offset:"-=400"}]});t.timelines.push(o),t.add(r)},a=0;a<i;a++)r(a);n-=2,this.x-=Math.round(n/2)}},{key:"setText",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.text;this.text=e,this.textGO.setText(this.text)}},{key:"run",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.text;this.setText(t),this.textGO.setPosition(0,0),this.textGO.setScale(.2),this.textGO.setAlpha(0),this.textGO.setVisible(!0),this.scene.tweens.timeline({targets:this.textGO,tweens:[{scale:1,ease:"Back.easeOut",duration:400},{alpha:1,ease:"Linear",duration:200,offset:"-=400"},{y:0,ease:"Quad.easeInOut",duration:500},{alpha:0,ease:"Linear",duration:200,onComplete:function(){e.stop()}}]})}},{key:"stop",value:function(){this.textGO.setVisible(!1),this.scene.tweens.killAll()}}]),t}();function Za(e){return(Za="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function qa(e,t){for(var s=0;s<t.length;s++){var i=t[s];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function $a(e,t){return!t||"object"!==Za(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function eo(e){return(eo=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function to(e,t){return(to=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var so=function(e){function t(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=$a(this,eo(t).call(this,{key:"MissionCompleteUI"}))).gameScene=null,e.panelsManager=null,e.missionCompleteText=null,e.missionCompleteTextCont=null,e}var s,i,n;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&to(e,t)}(t,Phaser.Scene),s=t,(i=[{key:"create",value:function(e){var t=this;this.gameScene=this.scene.get("GameScene"),this.panelsManager=new Pn(this),this.createMissionCompleteUI(),this.events.on("wake",function(e){var s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};t.runPanel(void 0!==s.delay?s.delay:0,s.text)}),this.events.on("pause",function(e){t.missionCompleteText.stop()}),this.scene.sleep()}},{key:"createMissionCompleteUI",value:function(){this.game.config.width,this.game.config.height,this.missionCompleteText=new Ja(this),this.missionCompleteTextCont=this.panelsManager.addContainer({init_x:.5,init_y:.5,anchor_ltrd:"",anchor_weight:[1,1],children:[this.missionCompleteText]})}},{key:"runPanel",value:function(){arguments.length>0&&void 0!==arguments[0]&&arguments[0];var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";this.missionCompleteText.run(e)}}])&&qa(s.prototype,i),n&&qa(s,n),t}();function io(e){return(io="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function no(e){return(no=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function ro(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function ao(e,t){return(ao=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var oo=function(e){function t(e){var s,i,n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),i=this,(s=!(n=no(t).call(this,e,0,0,"",{color:"white",fontSize:"14px",backgroundColor:"black",align:"right"}))||"object"!==io(n)&&"function"!=typeof n?ro(i):n).scene=e,e.add.existing(ro(s)),s.aaa=0,s.setOrigin(.5,1),s.x=s.scene.sys.game.config.width/2,s.y=s.scene.screenResizer.worldView.bottom-20,s}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ao(e,t)}(t,Phaser.GameObjects.Text),t}();function ho(e){return(ho="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function lo(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function uo(e,t){for(var s=0;s<t.length;s++){var i=t[s];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function co(e,t,s){return t&&uo(e.prototype,t),s&&uo(e,s),e}function po(e,t){return!t||"object"!==ho(t)&&"function"!=typeof t?yo(e):t}function fo(e){return(fo=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function yo(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function mo(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&vo(e,t)}function vo(e,t){return(vo=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var _o=function(e){function t(e){var s;return lo(this,t),(s=po(this,fo(t).call(this,e,0,0,"aller_white"))).scene=e,s.scene.add.existing(yo(s)),s}return mo(t,Phaser.GameObjects.BitmapText),co(t,[{key:"show",value:function(){this.setActive(!0),this.setVisible(!0)}},{key:"hide",value:function(){this.setActive(!1),this.setVisible(!1)}}]),t}(),go=function(e){function t(e,s){var i;return lo(this,t),(i=po(this,fo(t).call(this,e,0,0))).scene=e,i.scene.add.existing(yo(i)),i.text="WAVE 2",i.timelines=[],i.panelsManager=new Pn(i.scene),i.lettersGroup=i.scene.add.group({classType:_o,maxSize:20,runChildUpdate:!1,active:!1,visible:!1}),i}return mo(t,Phaser.GameObjects.Container),co(t,[{key:"create",value:function(e){var t=this;this.stop(),this.timelines=[];var s=e,i=s.length;this.x=0,this.y=0;for(var n=0,r=function(e){var r=t.lettersGroup.get();r.setText(s[e]),r.setFont("aller_vwhite"),r.setFontSize(40),r.setOrigin(0,.5);var a=r.getTextBounds().local.width;r.x=200+n+12,r.y=0,n+=a+12,r.setAlpha(0),r.show();var o=t.scene.tweens.timeline({targets:r,tweens:[{x:r.x,ease:"Linear",duration:120*e},{x:r.x-200,ease:"Back.easeOut",duration:900},{alpha:1,ease:"Linear",duration:200,offset:"-=800"},{x:r.x-198,ease:"Linear",duration:1e3},{x:r.x-400,ease:"Back.easeIn",duration:1e3,onComplete:function(){e===i-1&&t.stop()}},{alpha:0,ease:"Linear",duration:100,offset:"-="+(300-20*e)}]});t.timelines.push(o),t.add(r)},a=0;a<i;a++)r(a);n-=12,this.x-=Math.round(n/2)}},{key:"setText",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"WAVE 2";this.text=e,this.create(this.text)}},{key:"run",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;this.create("WAVE "+e)}},{key:"stop",value:function(){for(var e=0;e<this.timelines.length;e++)this.timelines[e].stop();this.iterate(function(e){e.hide()})}}]),t}();function bo(e){return(bo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function wo(e,t){for(var s=0;s<t.length;s++){var i=t[s];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function ko(e,t){return!t||"object"!==bo(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Oo(e){return(Oo=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function So(e,t){return(So=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Po=function(e){function t(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=ko(this,Oo(t).call(this,{key:"IngameUI"}))).gameScene=null,e.score=0,e.lives=3,e.best_score=0,e.liveSkin="panels/life_1",e.liveFirstX=20,e.liveFirstY=50,e.liveBetween=25,e.panelsManager=null,e.shipTextGO=null,e.shipTextGOcont=null,e.scoreGO=null,e.scoreGO2=null,e.livesGOarr=[],e.livesGOcont=null,e.bestScoreGO=null,e.gameOverCont=null,e.btnPauseGO=null,e.missionTask=null,e.missionTimerSec=null,e.missionTimerMillisec=null,e.isTimerRed=!1,e.leftBlockCont=null,e.centerBlockCont=null,e.rightBlockCont=null,e.missionTaskCont=null,e.missionTimerCont=null,e.waveText=null,e.waveTextCont=null,e.isMissionTimerRun=!1,e.pauseUI=null,e.blink=null,e.help=null,e.helpZoomyShip=null,e.isHelpNeed=!0,e.helpTime=0,e.powerupsCont=[],e.ingamePowerups=null,e.timelineWaveText=null,e}var s,i,n;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&So(e,t)}(t,Phaser.Scene),s=t,(i=[{key:"create",value:function(e){var t=this;Phaser.EDITOR&&(this.fpsText=new oo(this)),this.gameScene=this.scene.get("GameScene"),this.panelsManager=new Pn(this),this.blink=new E(this.scene,this),this.soundDown=this.sound.add("player_clicks_any_ui_button",{mute:!1,volume:1,loop:!1}),this.createIngameUI(),this.input.keyboard.on("keydown",function(e){Phaser.EDITOR||e.preventDefault(),e.keyCode!==Phaser.Input.Keyboard.KeyCodes.ESC||t.gameScene.keyPressed.has(e.keyCode)||(t.gameScene.keyPressed.add(e.keyCode),t.pauseHandler())}),this.input.keyboard.on("keyup",function(e){t.gameScene.keyPressed.delete(e.keyCode)}),this.events.on("wake",function(e){t.timerHide&&t.timerHide.remove(),t.cameras.main.setAlpha(1),t.scene.moveDown("GameScene"),t.scene.moveUp(),t.set_mode(t.gameScene.mode),t.set_score(t.gameScene.curScores),t.set_lives(t.gameScene.curLives,t.gameScene.lives),t.gameScene.ships.length>0&&(t.help.visible=!1,t.helpZoomyShip.visible=!1,"ship_zoomy"===t.gameScene.ships[0].type?t.setZoomyShipHelp():"ship_drilly"!==t.gameScene.ships[0].type&&t.setHelp(),t.shipTextGOcont.setVisible(!1))}),this.scene.sleep()}},{key:"setMissionToScore",value:function(e){"mission"===this.gameScene.mode&&this.scoreGO&&(this.scoreGO.setText("LEVEL: "+(e+1)),this.scoreGO.setFontSize(24))}},{key:"set_score",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return this.score=e,"classic"===this.gameScene.mode&&(this.scoreGO&&(this.scoreGO.setText(this.score),this.scoreGO.setFontSize(32)),this.scoreGO2&&this.scoreGO2.setText(t)),this}},{key:"set_lives",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.gameScene.curLives,s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.gameScene.lives;this.liveFirstX=0,this.liveFirstY=0,this.liveBetween=30;var i=.2,n=function(){var t=e.liveFirstX+e.liveBetween*e.livesGOcont.list.length;return e.panelsManager.addSprite({init_x:t,init_y:e.liveFirstY,origin:[0],key:["atlas_objects","panels/life_1.png"]})};if(this.livesGOcont){if(this.livesGOcont.list.length<s)for(var r=this.livesGOcont.list.length;r<s;r++){var a=n();this.livesGOcont.add(a)}for(var o=this.livesGOcont.list.length-1;o>=0;o--){var h=this.livesGOcont.list[o];o>=t?(h.setVisible(!0),("classic"===this.gameScene.mode||o>=s)&&h.setVisible(!1),h.setAlpha(i)):(h.setVisible(!0),h.setAlpha(1))}}return this}},{key:"set_best_score",value:function(e){return this.best_score=e,this.bestScoreGO.setText(this.best_score),this}},{key:"set_mode",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"classic";"mission"===e||(this.hideMissionTask(),this.hideMissionTimer()),this.livesGOcont.setInitY(50)}},{key:"setShipText",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;"mission"===this.gameScene.mode&&this.gameScene.wavesManager.is_ufo_attack&&(this.shipTextGO.setText(e),this.shipTextGOcont.setVisible(!0))}},{key:"fadeOut",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{wait:0,time:100},t=arguments.length>1?arguments[1]:void 0;this.timerHide=this.tweens.add({delay:e.wait,targets:this.cameras.main,alpha:0,duration:e.time,ease:"Linear",onComplete:function(){t()}},this)}},{key:"pauseHandler",value:function(){this.gameScene.createPausePanel()}},{key:"setHelp",value:function(){var e=this;this.help&&(this.isHelpNeed&&(this.help.visible=!0,this.timerHelpHideDelay=this.time.addEvent({delay:5e3,callback:function(){e.isHelpNeed||(e.timerHelpHideDelay.remove(),e.help.destroy())},callbackScope:this})),this.timerHelpHideDelay&&this.timerHelpHideDelay.getProgress()>=1&&(this.isHelpNeed||(this.timerHelpHideDelay.remove(),this.help.destroy())))}},{key:"setZoomyShipHelp",value:function(){var e=this;this.helpZoomyShip&&(this.isHelpNeed&&(this.helpZoomyShip.visible=!0,this.timerHelpHideDelay=this.time.addEvent({delay:5e3,callback:function(){e.isHelpNeed||(e.timerHelpHideDelay.remove(),e.helpZoomyShip.destroy())},callbackScope:this})),this.timerHelpHideDelay.getProgress()>=1&&(this.isHelpNeed||(this.timerHelpHideDelay.remove(),this.help.destroy())))}},{key:"createIngameUI",value:function(){var e=this;this.shipTextTitle=this.panelsManager.addBitmapText({init_x:0,init_y:0,origin:[0,.5],font:"aller_white",text:"UFOS: ",font_size:24}),this.shipTextGO=this.panelsManager.addBitmapText({init_x:75,init_y:0,origin:[0,.5],font:"aller_orange",text:"0",font_size:24}),this.shipTextGOcont=this.panelsManager.addContainer({init_x:15,init_y:110,children:[this.shipTextTitle,this.shipTextGO]}),this.scoreGO=this.panelsManager.addBitmapText({init_x:15,init_y:14,origin:[0],font:"aller_white",text:"0",font_size:24}),this.livesGOcont=this.panelsManager.addContainer({init_x:15,init_y:50,anchor_ltrd:"",anchor_weight:[1,1],name:"",children:[]}),this.leftBlockCont=this.panelsManager.addContainer({init_x:0,init_y:0,anchor_ltrd:"lt",anchor_weight:[1,1],name:"",children:[this.scoreGO,this.livesGOcont,this.shipTextGOcont]}),this.centerBlockCont=this.panelsManager.addContainer({init_x:.5,init_y:0,anchor_ltrd:"t",anchor_weight:[1,1],children:[]}),2===this.gameScene.players&&(this.scoreGO2=this.panelsManager.addText({init_x:-30,init_y:10,origin:[1,0],text:"0",font_size:19,color:"#ffff00",weight:"aller_bold"}),this.rightBlockCont=this.panelsManager.addContainer({init_x:1,init_y:0,anchor_ltrd:"rt",anchor_weight:[1,1],name:"",children:[this.scoreGO2]})),this.btnPauseGO=this.panelsManager.addButton({init_x:.96,init_y:.05,anchor_ltrd:"rt",name:"btn_pause",collider:{shape:"rectangle",size:[1.2,1.2]},tween_down:{type:"scale_down"},bg:{on:["atlas_objects","panels/btn_pause.png"]},sound:{down:null}}),this.btnPauseGO.on("down",function(t){e.pauseHandler()}),this.missionTask=this.panelsManager.addColoredBitmapText({origin:[.5,0],text:"Destroy all RED and GREEN",font:"aller_white",font_size:16,line_height:20,align_h:"center"}),this.missionTaskCont=this.panelsManager.addContainer({init_x:.52,init_y:18,anchor_ltrd:"t",anchor_weight:[1,1],children:[this.missionTask]}),this.hideMissionTask(),this.missionTimerSec=this.panelsManager.addBitmapText({init_x:20,init_y:0,origin:[1,.5],text:"0",font:"aller_white",font_size:40,align_h:"right"}),this.missionTimerMillisec=this.panelsManager.addBitmapText({init_x:22,init_y:3,origin:[0,.5],text:"00",font:"aller_yellow",font_size:22,align_h:"left"}),this.missionTimerCont=this.panelsManager.addContainer({init_x:.5,init_y:40,anchor_ltrd:"t",anchor_weight:[1,.9],children:[this.missionTimerSec,this.missionTimerMillisec]}),this.hideMissionTimer(),this.waveText=new go(this),this.waveTextCont=this.panelsManager.addContainer({init_x:.5,init_y:.7,anchor_ltrd:"d",anchor_weight:[1,.45],children:[this.waveText]});var t=this.panelsManager.addImage({init_x:-40,init_y:0,key:["atlas_objects","panels/key_left.png"]}),s=this.panelsManager.addImage({init_x:0,init_y:-40,key:["atlas_objects","panels/key_up.png"]}),i=this.panelsManager.addImage({init_x:40,init_y:0,key:["atlas_objects","panels/key_left.png"]});i.setFlipX(!0);var n=this.panelsManager.addBitmapText({init_x:70,init_y:0,origin:[0,.5],text:"move",font:"aller_white",font_size:18,align_h:"left"}),r=this.panelsManager.addContainer({init_x:-150,init_y:0,children:[t,s,i,n]}),a=this.panelsManager.addImage({init_x:0,init_y:0,key:["atlas_objects","panels/key_space.png"]}),o=this.panelsManager.addBitmapText({init_x:60,init_y:0,origin:[0,.5],text:"shoot",font:"aller_white",font_size:18,align_h:"left"}),h=this.panelsManager.addContainer({init_x:80,init_y:0,children:[a,o]});this.help=this.panelsManager.addContainer({init_x:.5,init_y:.9,anchor_ltrd:"d",anchor_weight:[1,1],name:"",children:[r,h]}),this.help.visible=!1;var l=this.panelsManager.addBitmapText({text:"Press down to use reverse thrusters",font:"white",font_size:16});this.helpZoomyShip=this.panelsManager.addContainer({init_x:.5,init_y:.9,anchor_ltrd:"",anchor_weight:[1,1],children:[l]}),this.helpZoomyShip.visible=!1,this.set_score(this.gameScene.curScores),this.set_lives(this.gameScene.curLives,this.gameScene.lives)}},{key:"jumpMissionTask",value:function(){this.timelineMissionTask=this.tweens.timeline({targets:this.missionTask,tweens:[{alpha:1,ease:"Linear",duration:100},{scale:1.3,ease:"Quad.easeOut",duration:200,offset:"-=100"},{scale:1,ease:"Quad.easeIn",duration:200,offset:"-=100"}]})}},{key:"showMissionTask",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Some Task Description";this.missionTask.setText(e),this.missionTask.setAlpha(0),this.jumpMissionTask(),this.missionTaskCont.setActive(!0),this.missionTaskCont.setVisible(!0)}},{key:"hideMissionTask",value:function(e){var t=this;void 0===e?(this.timelineMissionTask&&this.timelineMissionTask.destroy(),this.missionTaskCont.setActive(!1),this.missionTaskCont.setVisible(!1)):this.timelineMissionTask=this.tweens.timeline({targets:this.missionTask,tweens:[{alpha:0,ease:"Linear",duration:e,onComplete:function(){t.hideMissionTask()}}]})}},{key:"missionTaskBlink",value:function(){var e=this;this.missionTask.list[1]&&this.blink.start({scene:this,game_object:this.missionTask.list[1],wait:80,duration:500,on_time:80,off_time:80,steps:[]},function(){e.missionTask.list[1].setVisible(!0),e.isMissionTaskBlinking=!1})}},{key:"correctMissionTimerY",value:function(){this.missionTimerCont.init_y=this.missionTaskCont.init_y+this.missionTask.boundingBox.height+34,this.missionTimerCont.y=this.missionTimerCont.init_y,this.scale.refresh()}},{key:"centerMissionTimer",value:function(){var e=this.missionTimerSec.getTextBounds().local.width,t=this.missionTimerMillisec.getTextBounds().local.width,s=Math.round(.3*(e+t));this.missionTimerSec.x=e-s,this.missionTimerMillisec.x=this.missionTimerSec.x+2}},{key:"jumpMissionTimer",value:function(){this.timelineMissionTimer=this.tweens.timeline({targets:this.missionTimerCont,tweens:[{alpha:1,ease:"Linear",duration:100,onComplete:function(){}},{scale:1.3,ease:"Quad.easeOut",duration:200,offset:"-=100"},{scale:1,ease:"Quad.easeIn",duration:200,offset:"-=100"}]})}},{key:"blinkMissionTimer",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:function(){};this.blink.start({scene:this,game_object:this.missionTimerCont,wait:80,duration:640,on_time:80,off_time:80,steps:[]},function(){e.missionTimerCont.setVisible(!0),t()})}},{key:"showMissionTimer",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:120;this.isTimerRed=this.gameScene.wavesManager.is_destroy_all,this.isTimerGreen=this.gameScene.wavesManager.is_timed_survival,this.setTimerRed(),this.setTimerGreen(),this.missionTimerSec.setText(e),this.missionTimerMillisec.setText("00"),this.missionTimerCont.setAlpha(0),this.jumpMissionTimer(),this.missionTimerCont.setActive(!0),this.missionTimerCont.setVisible(!0)}},{key:"hideMissionTimer",value:function(e){var t=this;void 0===e?(this.missionTimerCont.setActive(!1),this.missionTimerCont.setVisible(!1),this.timelineMissionTimer&&this.timelineMissionTimer.destroy()):this.timelineMissionTimer=this.tweens.timeline({targets:this.missionTimerCont,tweens:[{alpha:0,ease:"Linear",duration:e,onComplete:function(){t.hideMissionTimer()}}]})}},{key:"checkTimerRed",value:function(){this.gameScene.wavesManager.is_destroy_all&&this.gameScene.wavesManager.missiomTime<5&&(this.tweenTimerRedPulse?this.tweenTimerRedPulse.play():this.tweenTimerRedPulse=this.tweens.add({targets:this.missionTimerCont,props:{scale:{value:1.1,duration:200,ease:"Power2.easeInOut",yoyo:!0,repeat:-1}}},this))}},{key:"setTimerRed",value:function(){this.isTimerRed?(this.missionTimerSec.setTint(16711680),this.missionTimerMillisec.setTint(16711680)):(this.missionTimerSec.clearTint(),this.missionTimerMillisec.clearTint(),this.tweenTimerRedPulse&&this.tweenTimerRedPulse.stop())}},{key:"setTimerGreen",value:function(){this.isTimerGreen&&(this.missionTimerSec.setTint(171058),this.missionTimerMillisec.setTint(171058))}},{key:"createWaveText_",value:function(e){var t=this;null!==this.waveTextCont&&this.waveTextCont.destroy();var s=this.panelsManager.addBitmapText({init_y:1e3,text:"WAVE "+e,font:"white",font_size:80});this.waveTextCont=this.panelsManager.addContainer({init_x:.5,init_y:.7,anchor_ltrd:"d",anchor_weight:[1,.45],name:"",children:[s]}),this.timelineWaveText=this.tweens.timeline({targets:s,tweens:[{y:0,ease:"Cubic.easeOut",duration:1500},{delay:1500,y:1e3,ease:"Quad.easeIn",duration:1500,onComplete:function(e,s){t.removeWaveText()}}]})}},{key:"createGameOverPanel",value:function(){var e=this.cameras.main.centerX,t=.4*this.cameras.main.height;this.gameOverCont=this.add.container(this),this.gameOverCont.setPosition(e,t);var s=this.add.text(0,0,"",{color:"white",fontSize:"20px"});s.setOrigin(.5),s.setText("GAME OVER"),this.gameOverCont.add(s)}},{key:"deleteGameOverPanel",value:function(){this.gameOverCont&&this.gameOverCont.destroy()}},{key:"setPowerupIcon",value:function(e){arguments.length>1&&void 0!==arguments[1]&&arguments[1],arguments.length>2&&void 0!==arguments[2]&&arguments[2]}},{key:"powerupsReset",value:function(){if(this.powerupsCont.length>0)for(var e=0;e<this.powerupsCont.length;e++){var t=this.powerupsCont[e].powerups;for(var s in t)this.setPowerupIcon(s,e,0)}}},{key:"createPlayersText",value:function(){var e=this.panelsManager.addBitmapText({text:1===this.gameScene.players?"PLAYER 1":"PLAYERS 2",font:"white",font_size:40}),t=this.panelsManager.addContainer({init_x:.5,init_y:.25,anchor_ltrd:"t",anchor_weight:[1,.7],name:"text_players",children:[e]});t.setAlpha(0),this.tweens.timeline({targets:t,tweens:[{alpha:1,ease:"Linear",duration:300},{delay:1e3,alpha:0,ease:"Linear",duration:500,onComplete:function(e,t){t[0].destroy()}}]})}},{key:"update",value:function(){}}])&&wo(s.prototype,i),n&&wo(s,n),t}();function Mo(e){return(Mo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function xo(e,t){for(var s=0;s<t.length;s++){var i=t[s];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function To(e,t){return!t||"object"!==Mo(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Co(e){return(Co=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Eo(e,t){return(Eo=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Ao=function(e){function t(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=To(this,Co(t).call(this,{key:"PauseUI"}))).gameScene=null,e.panelsManager=null,e.panel_shading=null,e.panel_bg_blue=null,e.btnSound=null,e.isInputActive=!1,e}var s,i,n;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Eo(e,t)}(t,Phaser.Scene),s=t,(i=[{key:"create",value:function(){var e=this;this.gameScene=this.scene.get("GameScene"),this.panelsManager=new Pn(this),this.soundDown=this.sound.add("player_clicks_any_ui_button",{mute:!1,volume:1,loop:!1}),this.createPauseUI(),this.input.keyboard.on("keydown",function(t){Phaser.EDITOR||t.preventDefault(),e.isInputActive&&(t.keyCode===Phaser.Input.Keyboard.KeyCodes.SPACE||t.keyCode===Phaser.Input.Keyboard.KeyCodes.ESC&&!e.gameScene.keyPressed.has(t.keyCode))&&(e.gameScene.keyPressed.add(t.keyCode),e.resumeHandler())}),this.input.keyboard.on("keyup",function(t){e.isInputActive&&e.gameScene.keyPressed.delete(t.keyCode)}),this.events.on("wake",function(t){e.cameras.main.fadeIn(0),e.runPanel(),e.isInputActive=!1,setTimeout(function(){e.isInputActive=!0},500)}),this.scene.sleep()}},{key:"homeHandler",value:function(){var e=this;this.gameScene.layoutState="menu",this.cameras.main.fadeOut(100),this.cameras.main.on("camerafadeoutcomplete",function(){e.cameras.main.removeListener("camerafadeoutcomplete"),e.gameScene.restartScene(!0)}),this.soundDown.play()}},{key:"replayHandler",value:function(){this.gameScene.wavesManager.curWave=0,this.gameScene.wavesManager.curMission=0,this.gameScene.wavesManager.curPart=0,this.resumeHandler(),this.gameScene.runGame()}},{key:"resumeHandler",value:function(){this.sound.setMute(!this.gameScene.is_sound),this.isInputActive=!1,this.scene.sleep(),this.gameScene.scene.resume(),this.scene.resume("IngameUI"),this.scene.resume("MissionUI"),this.scene.resume("MobileJoystick"),this.soundDown.play()}},{key:"soundHandler",value:function(e){this.gameScene.toggleSound("on"===e)}},{key:"createPauseUI",value:function(){var e=this,t=this.game.config.width/2,s=this.game.config.height/2;this.panel_shading=this.add.tileSprite(t,s,2e3,2e3,"atlas_objects","panels/panel_shading.png"),this.panel_shading.setAlpha(.9),this.panel_bg_blue=this.add.tileSprite(t,s,2e3,2e3,"atlas_objects","panels/panel_bg_blue.png"),this.panel_bg_blue.setAlpha(.6);var i=this.panelsManager.addBitmapText({init_x:0,init_y:-74,origin:[.5],font:"white",text:"PAUSED",font_size:22,align_h:"center"});this.btnHome=this.panelsManager.addButton({init_x:39,init_y:62,tween_down:{type:"scale_down"},bg:{on:["atlas_objects","panels/btn_home.png"]},sound:{down:null}}),this.btnHome.on("down",function(t){e.homeHandler()}),this.btnResume=this.panelsManager.addButton({init_x:0,init_y:-8,tween_down:{type:"scale_down"},bg:{on:["atlas_objects","panels/btn_play.png"]},sound:{down:null},text:{text:"RESUME",font_size:22,pos:[.5,4],is_bitmap:!0,font:"dark"}}),this.btnResume.on("down",function(t){e.resumeHandler()}),this.btnSound=this.panelsManager.addButton({init_x:-39,init_y:62,name:"btn_sound",is_toggle:!0,state:this.gameScene.is_sound?"on":"off",tween_down:{type:"scale_down"},bg:{on:["atlas_objects","panels/btn_sound_on.png"],off:["atlas_objects","panels/btn_sound_off.png"]}}),this.btnSound.on("down",function(t){e.soundHandler(t.state)}),this.panelsManager.addContainer({init_x:t,init_y:.5,name:"",children:[i,this.btnHome,this.btnResume,this.btnSound]})}},{key:"runPanel",value:function(){this.btnSound.setState(this.gameScene.is_sound?"on":"off"),this.sound.setMute(!0)}}])&&xo(s.prototype,i),n&&xo(s,n),t}();function jo(e){return(jo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Bo(e,t){for(var s=0;s<t.length;s++){var i=t[s];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function Do(e,t){return!t||"object"!==jo(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Ro(e){return(Ro=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Go(e,t){return(Go=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Io=function(e){function t(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=Do(this,Ro(t).call(this,{key:"ScoreUI"}))).gameScene=null,e.panelsManager=null,e.mode="classic",e.score=0,e.old_best=0,e.new_best=0,e.isStamp=!1,e.panel_shading=null,e.panel_bg_blue=null,e.title=null,e.yourScoresText=null,e.scoresCount=null,e.scoreMultiplyer=null,e.contScoreText=null,e.leftRound=null,e.rightRound=null,e.bestScoresText=null,e.bestScores=null,e.contBest=null,e.contButtons=null,e.stampMasked=null,e.stamp=null,e.btnHome=null,e.btnReplay=null,e.blink=null,e.isInputActive=!1,e.tweenStamp=null,e}var s,i,n;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Go(e,t)}(t,Phaser.Scene),s=t,(i=[{key:"create",value:function(e){var t=this;this.gameScene=this.scene.get("GameScene"),this.panelsManager=new Pn(this),this.blink=new E(this.scene,this),this.createScoreUI(),this.input.keyboard.on("keydown",function(e){Phaser.EDITOR||e.preventDefault(),t.isInputActive&&(e.keyCode!==Phaser.Input.Keyboard.KeyCodes.SPACE||t.gameScene.keyPressed.has(e.keyCode)?e.keyCode!==Phaser.Input.Keyboard.KeyCodes.ESC||t.gameScene.keyPressed.has(e.keyCode)||(t.gameScene.keyPressed.add(e.keyCode),t.homeHandler()):(t.gameScene.keyPressed.add(e.keyCode),t.replayHandler()))}),this.input.keyboard.on("keyup",function(e){t.isInputActive&&t.gameScene.keyPressed.delete(e.keyCode)}),this.events.on("wake",function(e){var s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(t.cameras.main.fadeIn(0),t.mode=s.mode||t.gameScene.mode,t.score=s.score||t.gameScene.curScores,t.old_best=s.old_best||t.gameScene.oldBestScores,"mission"===t.mode){t.score=t.gameScene.wavesManager.curMission+1;var i=0;Phaser.GLOBALS.saves.ships&&Phaser.GLOBALS.saves.ships[t.gameScene.shipType]&&Phaser.GLOBALS.saves.ships[t.gameScene.shipType].highest_m&&(i=Phaser.GLOBALS.saves.ships[t.gameScene.shipType].highest_m),t.bestScores.setText(i),t.old_best=i}"classic"===t.mode?t.isStamp=t.score>t.old_best:(t.isStamp=t.gameScene.isNewBestMission,t.gameScene.isNewBestMission=!1),t.set_mode(),t.set_score(),t.set_best_score(),t.runPanel(),t.isInputActive=!1,setTimeout(function(){t.isInputActive=!0},500)}),this.scene.sleep()}},{key:"set_score",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.score;this.score=e,this.scoresCount.setText(""+this.score)}},{key:"set_best_score",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.old_best;this.old_best=e,this.bestScores.setText(""+this.old_best)}},{key:"set_mode",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.gameScene.mode;this.mode=e,"classic"===this.mode?(this.panel_bg_blue.setTexture("atlas_objects","panels/panel_bg_blue.png"),this.bestScoresText.setText("High score".toUpperCase()),this.yourScoresText.setText("Your score".toUpperCase())):(this.panel_bg_blue.setTexture("atlas_objects","panels/panel_bg_purple.png"),this.bestScoresText.setText("Best Mission".toUpperCase()),this.yourScoresText.setText("Mission reached".toUpperCase()))}},{key:"homeHandler",value:function(){var e=this;this.gameScene.layoutState="menu",this.cameras.main.fadeOut(100),this.cameras.main.on("camerafadeoutcomplete",function(){e.cameras.main.removeListener("camerafadeoutcomplete"),e.gameScene.restartScene(!0)})}},{key:"replayHandler",value:function(){this.gameScene.wavesManager.curWave=0,this.gameScene.wavesManager.curMission=0,this.gameScene.wavesManager.curPart=0,this.gameScene.runGame(),this.isInputActive=!1,this.scene.sleep(),this.scene.resume("IngameUI"),this.scene.resume("MobileJoystick")}},{key:"createScoreUI",value:function(){var e=this,t=this.game.config.width/2,s=this.game.config.height/2;this.panel_shading=this.add.tileSprite(t,s,2e3,2e3,"atlas_objects","panels/panel_shading.png"),this.panel_shading.setVisible(!1),this.panel_bg_blue=this.add.tileSprite(0,0,2e3,100,"atlas_objects","panels/panel_bg_blue.png"),this.panel_bg_blue.setVisible(!1),this.yourScoresText=this.panelsManager.addBitmapText({init_x:0,init_y:-24,anchor_ltrd:"",anchor_weight:[1,1],origin:[.5],font:"aller_yellow",text:"Your scores",font_size:20,align_h:"center"}),this.scoresCount=this.panelsManager.addBitmapText({init_x:0,init_y:23,anchor_ltrd:"",anchor_weight:[1,1],origin:[.5],font:"aller_white",text:"5615978",font_size:46,align_h:"center"}),this.contScoreText=this.panelsManager.addContainer({init_x:0,init_y:0,anchor_ltrd:"",anchor_weight:[1,1],name:"",children:[this.yourScoresText,this.scoresCount]}),this.stamp=this.panelsManager.addBitmapText({init_x:130,init_y:20,origin:[.5],font:"aller_red",text:"New High Score!",font_size:18,align_h:"center"}),this.stamp.rotation=Phaser.Math.DegToRad(-30),this.stamp.setVisible(!1),this.panelsManager.addContainer({init_x:t,init_y:.46,anchor_ltrd:"",anchor_weight:[1,1],name:"",children:[this.panel_bg_blue,this.contScoreText,this.stamp]}),this.bestScoresText=this.panelsManager.addBitmapText({init_x:0,init_y:-22,anchor_ltrd:"",anchor_weight:[1,1],origin:[.5],font:"aller_red",text:"Best scores",font_size:18,align_h:"center"}),this.bestScores=this.panelsManager.addBitmapText({init_x:0,init_y:15,anchor_ltrd:"",anchor_weight:[1,1],origin:[.5],font:"aller_white",text:"5615978",font_size:30,align_h:"center"}),this.contBest=this.panelsManager.addContainer({init_x:0,init_y:0,anchor_ltrd:"",anchor_weight:[1,1],children:[this.bestScoresText,this.bestScores]}),this.panelsManager.addContainer({init_x:.5,init_y:.69,anchor_ltrd:"d",anchor_weight:[1,.1],children:[this.contBest]}),this.btnHome=this.panelsManager.addButton({init_x:70,init_y:0,tween_down:{type:"scale_down"},bg:{on:["atlas_objects","panels/btn_home.png"]}}),this.btnReplay=this.panelsManager.addButton({init_x:-40,init_y:0,tween_down:{type:"scale_down"},bg:{on:["atlas_objects","panels/btn_try_again.png"]},text:{text:"START\nAGAIN",font_size:20,pos:[.5,3],is_bitmap:!0,font:"white"}}),this.btnHome.on("down",function(t){e.homeHandler()}),this.btnReplay.on("down",function(t){e.replayHandler()}),this.contButtons=this.panelsManager.addContainer({init_x:0,init_y:0,anchor_ltrd:"",anchor_weight:[1,1],children:[this.btnHome,this.btnReplay]}),this.panelsManager.addContainer({init_x:t,init_y:.86,anchor_ltrd:"d",anchor_weight:[1,.65],children:[this.contButtons]}),this.title=this.panelsManager.addBitmapText({init_x:0,init_y:0,origin:[.5],font:"white",text:"GAME OVER",font_size:40,align_h:"center"}),this.title.setVisible(!1),this.panelsManager.addContainer({init_x:.5,init_y:.27,anchor_ltrd:"t",anchor_weight:[1,.3],children:[this.title]})}},{key:"runPanel",value:function(){var e=this;this.tweens.pauseAll(),this.game.config.width;var t=this.game.config.height/2,s=0;this.title.setPosition(0,t-this.title.parentContainer.y),this.title.setScale(.2),this.title.setAlpha(0),this.title.setVisible(!0),this.tweens.timeline({targets:this.title,tweens:[{scale:1,ease:"Back.easeOut",duration:400},{alpha:1,ease:"Linear",duration:200,offset:"-=400"},{delay:500,y:this.title.init_y,ease:"Quad.easeInOut",duration:600,offset:"-=400"}]}),s+=600,this.panel_shading.setAlpha(0),this.panel_shading.setVisible(!0),this.tweenPanelShading=this.tweens.timeline({targets:this.panel_shading,delay:s,tweens:[{alpha:.9,ease:"Linear",duration:300}]}),s+=50,this.panel_bg_blue.setAlpha(0),this.panel_bg_blue.setVisible(!0),this.tweenPanelBgBlue=this.tweens.timeline({targets:this.panel_bg_blue,delay:s,tweens:[{alpha:.9,ease:"Linear",duration:300}]}),s+=200,this.yourScoresText.setScale(.2),this.yourScoresText.setAlpha(0),this.yourScoresText.setVisible(!0),this.tweens.add({targets:this.yourScoresText,delay:s,props:{scale:{value:1,duration:400,ease:"Back.easeOut"},alpha:{value:1,duration:200,ease:"Linear"}}},this),s+=50,this.scoresCount.setScale(.2),this.scoresCount.setAlpha(0),this.scoresCount.setVisible(!0),this.tweens.add({targets:this.scoresCount,delay:s,props:{scale:{value:1,duration:400,ease:"Back.easeOut"},alpha:{value:1,duration:200,ease:"Linear"}}},this),s+=50,this.bestScoresText.setScale(.2),this.bestScoresText.setAlpha(0),this.bestScoresText.setVisible(!0),this.tweens.add({targets:this.bestScoresText,delay:s,props:{scale:{value:1,duration:400,ease:"Back.easeOut"},alpha:{value:1,duration:200,ease:"Linear"}}},this),s+=50,this.bestScores.setScale(.2),this.bestScores.setAlpha(0),this.bestScores.setVisible(!0),this.tweens.add({targets:this.bestScores,delay:s,props:{scale:{value:1,duration:400,ease:"Back.easeOut"},alpha:{value:1,duration:200,ease:"Linear"}}},this),s+=50,this.btnReplay.setScale(.2),this.btnReplay.setAlpha(0),this.btnReplay.setVisible(!0),this.tweens.add({targets:this.btnReplay,delay:s,props:{scale:{value:1,duration:400,ease:"Back.easeOut"},alpha:{value:1,duration:200,ease:"Linear"}}},this),s+=50,this.btnHome.setScale(.2),this.btnHome.setAlpha(0),this.btnHome.setVisible(!0),this.tweens.add({targets:this.btnHome,delay:s,props:{scale:{value:1,duration:400,ease:"Back.easeOut"},alpha:{value:1,duration:200,ease:"Linear"}}},this);var i=this.scoresCount.getTextBounds().local.width/2;this.stamp.setVisible(!1),this.isStamp&&(s=1e3,this.contBest.setScale(1),this.tweens.timeline({targets:this.contBest,delay:s,tweens:[{scale:1,ease:"Linear",duration:100,onComplete:function(){e.set_best_score(e.score),e.blink.start({scene:e,game_object:e.contBest,wait:80,duration:640,on_time:80,off_time:80,steps:[]},function(){e.contBest.setVisible(!0)})}}],onComplete:function(){}}),s+=0,this.stamp.x=i+50,this.stamp.setText("classic"===this.mode?"NEW\nHIGH\nSCORE!":"NEW\nBEST!"),this.stamp.setScale(.2),this.stamp.setAlpha(0),this.stamp.setVisible(!0),this.tweens.add({targets:this.stamp,delay:s,props:{scale:{value:1,duration:400,ease:"Back.easeOut"},alpha:{value:1,duration:200,ease:"Linear"}}},this))}},{key:"runPanel_",value:function(){var e=this;this.tweens.pauseAll(),this.panel_shading.setAlpha(0),this.panel_shading.setVisible(!0),this.tweenPanelShading=this.tweens.timeline({targets:this.panel_shading,tweens:[{alpha:.9,ease:"Linear",duration:330}]}),this.panel_bg_blue.setAlpha(0),this.panel_bg_blue.setSize(15,15),this.panel_bg_blue.setAngle(-92),this.panel_bg_blue.setVisible(!0),this.tweenPanelBgBlue=this.tweens.timeline({targets:this.panel_bg_blue,tweens:[{alpha:0,ease:"Linear",duration:330},{alpha:.4,ease:"Linear",duration:66},{alpha:.8,ease:"Linear",duration:132}]}),this.tweens.timeline({targets:this.panel_bg_blue,tweens:[{alpha:0,ease:"Linear",duration:330},{width:90,ease:"Quad.easeOut",duration:66},{width:600,ease:"Quad.easeInOut",duration:132},{width:2e3,ease:"Linear",duration:66}]}),this.tweens.timeline({targets:this.panel_bg_blue,tweens:[{alpha:0,ease:"Linear",duration:330},{height:90,ease:"Quad.easeOut",duration:66},{height:110,ease:"Quad.easeInOut",duration:198}]}),this.tweens.timeline({targets:this.panel_bg_blue,tweens:[{alpha:0,ease:"Linear",duration:330},{angle:.5,ease:"Quad.easeOut",duration:198},{angle:0,ease:"Quad.easeInOut",duration:99}]}),this.contScoreText.setAlpha(0),this.contScoreText.setScale(.82),this.contScoreText.setVisible(!0),this.tweens.timeline({targets:this.contScoreText,tweens:[{alpha:0,ease:"Linear",duration:528},{alpha:1,ease:"Quad.easeOut",duration:66}]}),this.tweens.timeline({targets:this.contScoreText,tweens:[{alpha:0,ease:"Linear",duration:528},{scale:1.06,ease:"Quad.easeOut",duration:66},{scale:.98,ease:"Quad.easeInOut",duration:132},{scale:1.01,ease:"Quad.easeInOut",duration:198},{scale:1,ease:"Quad.easeInOut",duration:264}]}),this.scoresCount.getTextBounds().local.width,this.contBest.y=-6,this.contBest.setAlpha(0),this.contBest.setScale(1),this.contBest.setVisible(!0),this.tweens.timeline({targets:this.contBest,tweens:[{alpha:0,ease:"Linear",duration:528},{alpha:1,ease:"Quad.easeOut",duration:165}]}),this.tweens.timeline({targets:this.contBest,tweens:[{alpha:0,ease:"Linear",duration:528},{y:3,ease:"Quad.easeOut",duration:165},{y:-2,ease:"Quad.easeInOut",duration:198},{y:0,ease:"Quad.easeInOut",duration:231}]}),this.title.y=-5,this.title.setAlpha(0),this.title.setScale(1),this.title.setVisible(!0),this.tweens.timeline({targets:this.title,tweens:[{alpha:0,ease:"Linear",duration:528},{alpha:1,ease:"Quad.easeOut",duration:561}]}),this.tweens.timeline({targets:this.title,tweens:[{alpha:0,ease:"Linear",duration:528},{y:0,ease:"Quad.easeOut",duration:561}]}),this.contButtons.y=100,this.contButtons.setAlpha(0),this.contButtons.setScale(1),this.contButtons.setVisible(!0),this.tweens.timeline({targets:this.contButtons,tweens:[{alpha:0,ease:"Linear",duration:528},{alpha:1,ease:"Quad.easeOut",duration:561}]}),this.tweens.timeline({targets:this.contButtons,tweens:[{alpha:0,ease:"Linear",duration:528},{y:0,ease:"Quad.easeOut",duration:561}]}),this.btnReplay.resume(),this.stamp.setVisible(!1),this.isStamp&&(this.contBest.setScale(1),this.tweens.timeline({targets:this.contBest,tweens:[{scale:1,ease:"Linear",duration:660,onComplete:function(){e.set_best_score(e.score),e.blink.start({scene:e,game_object:e.contBest,wait:80,duration:640,on_time:80,off_time:80,steps:[]},function(){e.contBest.setVisible(!0)})}},{scale:1.6,ease:"Quart.easeOut",duration:231},{scale:1.58,ease:"Linear",duration:66},{scale:1,ease:"Bounce.easeOut",duration:1056}],onComplete:function(){}}),this.stamp.setAlpha(0),this.stamp.setVisible(!0),this.stamp.x=targX+60,this.stamp.setText("classic"===this.mode?"NEW\nHIGH\nSCORE!":"NEW\nBEST!"),this.tweenStamp=this.tweens.timeline({targets:this.stamp,tweens:[{alpha:0,ease:"Linear",duration:660},{alpha:1,ease:"Linear",duration:100}]}))}}])&&Bo(s.prototype,i),n&&Bo(s,n),t}();function Lo(e){return(Lo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function zo(e,t){for(var s=0;s<t.length;s++){var i=t[s];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function Vo(e,t){return!t||"object"!==Lo(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Uo(e){return(Uo=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Fo(e,t){return(Fo=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Ho=function(e){function t(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=Vo(this,Uo(t).call(this,{key:"MobileJoystick"}))).gameScene=null,e.buttonWidthThreshold=.7,e.stickBg=null,e.contStick=null,e.engineBtn=null,e.reverseEngineBtn=null,e.fireBtn=null,e.bombBtn=null,e.pointerStickID=-1,e.pointerEngineID=-1,e.pointerReverseEngineID=-1,e.pointerFireID=-1,e.pointerBombID=-1,e.maxStickRadius=0,e.stickDist=0,e.stickRot=0,e.isStickMove=!1,e.isEngineDown=!1,e.isReverseEngineDown=!1,e.isFireDown=!1,e.isBombDown=!1,e.isFreezeDown=!1,e.panelsManager=null,e.isCreated=!1,e}var s,i,n;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Fo(e,t)}(t,Phaser.Scene),s=t,(i=[{key:"create",value:function(){var e=this;this.gameScene=this.scene.get("GameScene"),this.panelsManager=new Pn(this),this.createJoystick(),this.events.on("wake",function(t,s){e.isMobile||e.scene.sleep(),e.cameras.main.alpha=1,e.resetState(),e.gameScene.ui&&(e.gameScene.ui.help&&e.gameScene.ui.help.destroy(),e.gameScene.ui.helpZoomyShip&&e.gameScene.ui.helpZoomyShip.destroy())}),this.events.on("resume",function(t,s){e.resetState()}),this.scene.sleep()}},{key:"onResize",value:function(){this.scene.isActive("GameScene")&&(this.isMobile&&"game"===this.gameScene.layoutState?this.scene.wake("MobileJoystick"):this.scene.sleep("MobileJoystick"))}},{key:"fadeOut",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{wait:0,time:100},t=arguments.length>1?arguments[1]:void 0;this.timerHide=this.tweens.add({delay:e.wait,targets:this.cameras.main,alpha:0,duration:e.time,ease:"Linear",onComplete:function(){t()}},this)}},{key:"resetState",value:function(){this.pointerStickID=-1,this.stickDragger.x=this.stickBg.x,this.stickDragger.y=this.stickBg.y,this.isStickMove=!1,this.pointerEngineID=-1,this.isEngineDown=!1,this.pointerReverseEngineID=-1,this.isReverseEngineDown=!1,this.pointerFireID=-1,this.isFireDown=!1,this.pointerBombID=-1,this.isBombDown=!1}},{key:"setReverseEnabled",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.reverseEngineBtn.setActive(e),this.reverseEngineBtn.setVisible(e),e?(this.engineBtn.init_x=this.engineBtn.options.reverse_x,this.engineBtn.init_y=this.engineBtn.options.reverse_y,this.engineBtn.x=this.engineBtn.init_x,this.engineBtn.y=this.engineBtn.init_y):(this.engineBtn.init_x=this.engineBtn.options.init_x,this.engineBtn.init_y=this.engineBtn.options.init_y,this.engineBtn.x=this.engineBtn.init_x,this.engineBtn.y=this.engineBtn.init_y)}},{key:"createJoystick",value:function(){var e=this;this.input.addPointer(2),this.stickBg=this.panelsManager.addImage({key:["atlas_objects","panels/joystick_bg.png"]}),this.stickDragger=this.panelsManager.addImage({key:["atlas_objects","panels/btn_stick.png"]});var t=this.panelsManager.addContainer({init_x:.2,init_y:.75,anchor_ltrd:"ld",anchor_weight:[.9,.7],name:"joystick_stick",children:[this.stickBg,this.stickDragger]});this.maxStickRadius=.5*this.stickBg.displayWidth,this.stickBg.setInteractive(new Phaser.Geom.Circle(this.stickBg.displayOriginX,this.stickBg.displayOriginY,this.stickBg.displayWidth*this.buttonWidthThreshold),Phaser.Geom.Circle.Contains),this.stickBg.on("pointerdown",function(t){-1===e.pointerStickID&&(e.pointerStickID=t.id)}),this.input.on("pointermove",function(s){if(-1!==e.pointerStickID&&e.pointerStickID===s.id){var i=s.worldX-t.x,n=s.worldY-t.y;e.stickDist=Phaser.Math.Distance.Between(e.stickBg.x,e.stickBg.y,i,n),e.stickRot=Phaser.Math.Angle.Between(e.stickBg.x,e.stickBg.y,i,n);var r=Math.min(e.maxStickRadius,e.stickDist);e.stickDragger.x=e.stickBg.x+Math.cos(e.stickRot)*r,e.stickDragger.y=e.stickBg.y+Math.sin(e.stickRot)*r,r>10&&(e.isStickMove=!0)}}),this.input.on("pointerup",function(t){-1!==e.pointerStickID&&e.pointerStickID===t.id&&(e.pointerStickID=-1,e.stickDragger.x=e.stickBg.x,e.stickDragger.y=e.stickBg.y,e.isStickMove=!1),-1!==e.pointerEngineID&&e.pointerEngineID===t.id&&(e.pointerEngineID=-1,e.isEngineDown=!1),-1!==e.pointerReverseEngineID&&e.pointerReverseEngineID===t.id&&(e.pointerReverseEngineID=-1,e.isReverseEngineDown=!1),-1!==e.pointerFireID&&e.pointerFireID===t.id&&(e.pointerFireID=-1,e.isFireDown=!1),-1!==e.pointerBombID&&e.pointerBombID===t.id&&(e.pointerBombID=-1,e.isBombDown=!1)}),this.engineBtn=this.panelsManager.addImage({init_x:-70,init_y:50,reverse_x:-100,reverse_y:-70,key:["atlas_objects","panels/btn_fire.png"]}),this.reverseEngineBtn=this.panelsManager.addImage({init_x:-100,init_y:50,key:["atlas_objects","panels/btn_reverse_engine.png"]}),this.setReverseEnabled(!1),this.fireBtn=this.panelsManager.addImage({init_x:30,init_y:-30,key:["atlas_objects","panels/btn_engine.png"]}),this.bombBtn=this.panelsManager.addImage({init_x:40,init_y:-150,key:["atlas_objects","panels/btn_joystick_bomb.png"]}),this.bombBtn.setActive(!1),this.bombBtn.setVisible(!1),this.panelsManager.addContainer({init_x:.83,init_y:.74,anchor_ltrd:"rd",anchor_weight:[.9,.7],name:"joystick_buttons",children:[this.engineBtn,this.reverseEngineBtn,this.fireBtn,this.bombBtn]}),this.engineBtn.setInteractive(new Phaser.Geom.Circle(this.engineBtn.displayOriginX,this.engineBtn.displayOriginY,this.engineBtn.displayWidth*this.buttonWidthThreshold),Phaser.Geom.Circle.Contains),this.engineBtn.on("pointerdown",function(t){-1===e.pointerEngineID&&(e.pointerEngineID=t.id,e.isEngineDown=!0)}),this.reverseEngineBtn.setInteractive(new Phaser.Geom.Circle(this.reverseEngineBtn.displayOriginX,this.reverseEngineBtn.displayOriginY,this.reverseEngineBtn.displayWidth*this.buttonWidthThreshold),Phaser.Geom.Circle.Contains),this.reverseEngineBtn.on("pointerdown",function(t){-1===e.pointerReverseEngineID&&(e.pointerReverseEngineID=t.id,e.isReverseEngineDown=!0)}),this.fireBtn.setInteractive(new Phaser.Geom.Circle(this.fireBtn.displayOriginX,this.fireBtn.displayOriginY,this.fireBtn.displayWidth*this.buttonWidthThreshold),Phaser.Geom.Circle.Contains),this.fireBtn.on("pointerdown",function(t){-1===e.pointerFireID&&(e.pointerFireID=t.id,e.isFireDown=!0)}),this.bombBtn.setInteractive(new Phaser.Geom.Circle(this.bombBtn.displayOriginX,this.bombBtn.displayOriginY,this.bombBtn.displayWidth*this.buttonWidthThreshold),Phaser.Geom.Circle.Contains),this.bombBtn.on("pointerdown",function(t){-1===e.pointerBombID&&(e.pointerBombID=t.id,e.isBombDown=!0,e.isFreezeDown=!0)})}},{key:"removeJoystick",value:function(){if(0!==this.children.list.length){for(var e=this.children.list.length-1;e>=0;e--)this.children.list[e].destroy();this.panelsManager=null}}}])&&zo(s.prototype,i),n&&zo(s,n),t}();function No(e){return(No="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Wo(e,t){for(var s=0;s<t.length;s++){var i=t[s];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function Ko(e,t){return!t||"object"!==No(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Qo(e){return(Qo=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Yo(e,t){return(Yo=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Xo=function(e){function t(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=Ko(this,Qo(t).call(this,{key:"GameScene"}))).baseConfig={},e.unitsWaves={},e.savesData={},e.mode="mission",e.players=1,e.ships=[],e.shipType="ship_drilly",e.is_sound=!0,e.classicConfig={},e.layoutState="menu",e.isGameOver=!1,e.isMissionCompleted=!1,e.lives=3,e.new_live_scores=1e4,e.delatBeforeGameOver=3500,e.delatBeforeGameOverPanel=600,e.scoreIncreaseMult=1,e.bestClassicScores=0,e.bestMissionScores=0,e.highestWave=0,e.highestMission=0,e.isNewBestMission=!1,e.stats={},e.shipsSaves={},e.curLives=e.lives,e.lostLives=0,e.curScores=0,e.oldBestScores=0,e.newBestScores=0,e.ui=null,e.missionComplete=null,e.menuUI=null,e.mobileJoystick=null,e.pauseUI=null,e.scoreUI=null,e.missionUI=null,e.shipsManager=null,e.wavesManager=null,e.powerupManager=null,e.effectsManager=null,e.editorEmmiter=null,e.keyPressed=new Set,e.missionsPregeneratedCount=10,e.missionsShipsUnlocks={ship_zoomy:{unlock_level:4,carusel_skin:"carusel_ship_2.png"},ship_tanky:{unlock_level:8,carusel_skin:"carusel_ship_3.png"}},e.timerExtraLiveSound=null,e.timerShipExplode=null,e.timerGameOverPanel=null,e.soundExtraShip=null,e}var s,i,n;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Yo(e,t)}(t,Phaser.Scene),s=t,(i=[{key:"preload",value:function(){this.loadSaves(),this.set_best()}},{key:"create",value:function(){var e=this;this.classicConfig=Phaser.GLOBALS.units_waves.classic.units.default,this.bg=this.add.tileSprite(this.game.config.width/2,this.game.config.height/2,2e3,2e3,"bg_1"),this.bg.setTilePosition(512,460),this.soundExtraShip=this.sound.add("extra_ship",{mute:!1,volume:1,loop:!1}),this.soundGameOver=this.sound.add("game_over",{mute:!1,volume:1,loop:!1}),this.soundNewShipUnlocked=this.sound.add("new_ship_unlocked",{mute:!1,volume:1,loop:!1}),this.soundExtraLife=this.sound.add("extra_life",{mute:!1,volume:1,loop:!1}),this.shipsGroup=this.add.group({classType:Q,maxSize:2,runChildUpdate:!0,active:!1,visible:!1}),this.playerBulletsGroup=this.add.group({classType:x,maxSize:100,runChildUpdate:!0,active:!1,visible:!1}),this.asteroidsGroup=this.add.group({classType:ie,maxSize:1e3,runChildUpdate:!0,active:!1,visible:!1}),this.enemiesGroup=this.physics.add.group({classType:ue,maxSize:100,runChildUpdate:!0,active:!1,visible:!1}),this.enemiesBulletsGroup=this.physics.add.group({classType:x,maxSize:100,runChildUpdate:!0,active:!1,visible:!1}),this.menuUI=this.scene.get("MenuUI"),this.missionComplete=this.scene.get("MissionCompleteUI"),this.ui=this.scene.get("IngameUI"),this.missionUI=this.scene.get("MissionUI"),this.mobileJoystick=this.scene.get("MobileJoystick"),this.shipsManager=new fe(this),this.powerupManager=new Un(this),this.effectsManager=new _r(this),this.wavesManager=new Ba(this),"menu"===this.layoutState?this.runMenu():this.runGame(),this.toggleSound(this.is_sound),Phaser.EDITOR&&this.createCheats(),this.bluredScenes=[],this.unfocus=function(){if(e.bluredScenes.length)for(var t=e.bluredScenes.length-1;t>=0;t--)e.bluredScenes.pop().scene.resume()},this.game.events.addListener(Phaser.Core.Events.FOCUS,function(){e.unfocus()},this),this.game.events.addListener(Phaser.Core.Events.BLUR,function(){e.unfocus(),e.isMobile||e.game.scene.getScenes().forEach(function(t){e.bluredScenes.push(t),t.scene.pause()})},this),this.events.on("resume",function(t,s){e.onResize()}),this.input.on("pointerdown",function(e){}),Phaser.hasOwnProperty("EDITOR")&&(this.editorEmmiter=Phaser.EDITOR.emitter.on("cheats",function(t){var s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";switch(t){case"restart-level":e.restart();break;case"next-level":e.nextLevel();break;case"next-shift-level":e.nextLevel(10);break;case"end-level":e.nextLevel(50);break;case"prev-level":e.prevLevel();break;case"prev-shift-level":e.prevLevel(10);break;case"start-level":e.prevLevel(50);break;case"current-mode":e.changeMode(s);break;case"immortal":e.setImmortal(Phaser.EDITOR.immortal)}},this))}},{key:"onResize",value:function(){if(this.scene.isActive("GameScene"))if(this.isMobile&&"game"===this.layoutState){var e=(this.game.renderer.width-this.game.config.width)/2,t=.3*(this.game.renderer.height-this.game.config.height);this.cameras.main.setBounds(-1e3,-1e3,this.game.config.width+2e3,this.game.config.height+2e3,!0),this.cameras.main.setSize(this.game.config.width,this.game.config.height),this.cameras.main.setPosition(e,t),this.cameras.main.setScroll(0,0),this.physics.world.setBounds(0,0,this.game.config.width,this.game.config.height,!1,!1,!1,!1)}else this.cameras.main.setPosition(0,0)}},{key:"runMenu",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.isGameOver=!1,this.isMissionCompleted=!1,this.layoutState="menu",this.scene.sleep("MissionCompleteUI"),this.scene.sleep("IngameUI"),this.scene.sleep("MissionUI"),this.scene.sleep("MobileJoystick"),this.scene.sleep("PauseUI"),this.scene.sleep("ScoreUI"),this.ui.hideMissionTask(),this.ui.hideMissionTimer(),this.scene.wake("MenuUI"),e&&this.menuUI.cameras.main.fadeIn(100),this.scale.refresh(),this.powerupManager.reset(),this.shipsManager.reset(),this.wavesManager.curWave=0,this.wavesManager.curMission=0,this.wavesManager.curPart=0,this.wavesManager.resetCurVars(),this.wavesManager.resetManagers(),this.wavesManager.set_mode("classic"),this.wavesManager.updateCategory(),this.wavesManager.updateType(),this.wavesManager.curWave=2,this.wavesManager.buildLevel(this.wavesManager.curWave)}},{key:"runGame",value:function(){this.isGameOver=!1,this.isMissionCompleted=!1,this.readConfig(this.classicConfig),this.curScores=0,this.lostLives=0,this.scoreIncreaseMult=1,this.set_best(),this.layoutState="game",this.scene.sleep("MenuUI"),this.scene.sleep("MissionUI"),this.scene.sleep("ScoreUI"),this.ui.hideMissionTask(),this.ui.hideMissionTimer(),this.scene.wake("IngameUI"),this.scene.wake("MobileJoystick"),this.powerupManager.reset(),this.effectsManager.reset(),this.shipsManager.reset(),this.ships.forEach(function(e){return e.hide(!0)}),this.ships=[],this.ships=this.shipsManager.createPlayers(this.players,this.shipType),this.wavesManager.missionGenerator.reset(),this.missionUI.resetProgressHeroPos(),this.wavesManager.runWave(this.wavesManager.curWave,{is_first_launch:!0}),Phaser.EDITOR&&Phaser.EDITOR.setCurrentMode(),this.cmgStart()}},{key:"createCheats",value:function(){var e=this;this.input.keyboard.on("keydown",function(t){if(Phaser.EDITOR||t.preventDefault(),t.keyCode===Phaser.Input.Keyboard.KeyCodes.Z)e.cheatDesctroyAsteroid();else if(t.keyCode===Phaser.Input.Keyboard.KeyCodes.X)e.cheatDesctroyAllAsteroids();else if(t.keyCode===Phaser.Input.Keyboard.KeyCodes.R)e.restart();else if(t.keyCode===Phaser.Input.Keyboard.KeyCodes.M)e.toggleSound();else if(t.keyCode===Phaser.Input.Keyboard.KeyCodes.C)e.cheatDesctroyEnemy();else if(t.keyCode===Phaser.Input.Keyboard.KeyCodes.U)localStorage.removeItem(Phaser.GLOBALS.saves_name);else if(t.keyCode===Phaser.Input.Keyboard.KeyCodes.G){var s=e.enemiesGroup.getFirst(!0),i=e.shipsManager.ships[0],n=e.enemiesBulletsGroup.getFirstDead(!0);n&&(n.shooter=s,n.fire(i.x-50,i.y,0)),s.shipBulletHitEnemy({power:10})}else t.keyCode===Phaser.Input.Keyboard.KeyCodes.ONE?e.powerupManager.applyPowerup("shield",{ship:e.shipsGroup.getFirstAlive()}):t.keyCode===Phaser.Input.Keyboard.KeyCodes.TWO?e.powerupManager.applyPowerup("triple_shot",{ship:e.shipsGroup.getFirstAlive()}):t.keyCode===Phaser.Input.Keyboard.KeyCodes.THREE?e.powerupManager.applyPowerup("fast_shot",{ship:e.shipsGroup.getFirstAlive()}):t.keyCode===Phaser.Input.Keyboard.KeyCodes.FOUR?e.powerupManager.applyPowerup("fast_acceleration",{ship:e.shipsGroup.getFirstAlive()}):t.keyCode===Phaser.Input.Keyboard.KeyCodes.FIVE?e.powerupManager.applyPowerup("bomb",{ship:e.shipsGroup.getFirstAlive()}):t.keyCode===Phaser.Input.Keyboard.KeyCodes.SIX?e.powerupManager.applyPowerup("extra_life",{ship:e.shipsGroup.getFirstAlive()}):t.keyCode===Phaser.Input.Keyboard.KeyCodes.SEVEN?e.powerupManager.applyPowerup("life_refill",{ship:e.shipsGroup.getFirstAlive()}):t.keyCode===Phaser.Input.Keyboard.KeyCodes.EIGHT?e.powerupManager.applyPowerup("increase_score",{ship:e.shipsGroup.getFirstAlive()}):t.keyCode===Phaser.Input.Keyboard.KeyCodes.NINE?e.powerupManager.applyPowerup("blast_radius",{ship:e.shipsGroup.getFirstAlive()}):t.keyCode===Phaser.Input.Keyboard.KeyCodes.ZERO?e.powerupManager.applyPowerup("drill_bit",{ship:e.shipsGroup.getFirstAlive()}):t.keyCode===Phaser.Input.Keyboard.KeyCodes.MINUS&&e.powerupManager.applyPowerup("freeze",{ship:e.shipsGroup.getFirstAlive()})})}},{key:"cheatDesctroyAsteroid",value:function(){var e=this.asteroidsGroup.getFirstAlive();e&&e.body.enable&&(this.addScores(e.curScore),"classic"===this.scene.mode&&this.effectsManager.spawnEffect(e.x,e.y,"scores_asteroid_1",{scores:e.curScore,ast_size:e.curDestr}),e.subDestruction())}},{key:"cheatDesctroyAllAsteroids",value:function(){this.asteroidsGroup.getChildren().forEach(function(e){e.hide(!0)}),this.enemiesGroup.getChildren().forEach(function(e){e.hide(!0)}),this.wavesManager.checkEndOfWave()}},{key:"cheatDesctroyEnemy",value:function(){var e=this.enemiesGroup.getFirstAlive();e&&e.body.enable&&(this.addScores(e.score),"classic"===this.scene.mode&&this.effectsManager.spawnEffect(e.x,e.y,"scores_enemy_1",{scores:e.curScore,enemy_type:e.curDestr}),e.subDestruction())}},{key:"changeMode",value:function(e){e=void 0===e||""===e?"classic":e,this.mode=e,this.ui.waveText.stop(),this.scene.sleep("MissionUI"),this.ui.set_mode(this.mode),this.wavesManager.set_mode(this.mode),"game"===this.layoutState&&(this.wavesManager.updateCategory(),this.wavesManager.updateType(),this.wavesManager.restartWave()),this.saveSaves(),Phaser.EDITOR&&Phaser.EDITOR.setCurrentMode()}},{key:"restart",value:function(){this.scene.sleep("ScoreUI"),this.shipsManager.resetPosition(),this.wavesManager.restartWave(),this.readConfig(this.classicConfig),this.curScores=0,this.ui.waveText.stop(),this.ui.set_score(this.curScores),this.ui.set_lives(this.curLives)}},{key:"nextLevel",value:function(e){this.scene.sleep("ScoreUI"),this.ui.waveText.stop(),this.wavesManager.nextWave(e)}},{key:"prevLevel",value:function(e){this.scene.sleep("ScoreUI"),this.ui.waveText.stop(),this.wavesManager.prevWave(e)}},{key:"setImmortal",value:function(e){this.ships.forEach(function(t){t.setImmortal(e)})}},{key:"toggleSound",value:function(e){this.is_sound=void 0!==e?e:this.sound.mute,this.sound.setMute(!this.is_sound),this.menuUI&&this.menuUI.btnSound.setState(this.is_sound?"on":"off"),this.saveSaves()}},{key:"changePlayers",value:function(e){e=void 0===e?1:e,this.players=e,this.saveSaves()}},{key:"addScores",value:function(e){var t=Math.floor(this.curScores/this.new_live_scores);this.curScores+=e,this.curScores=Math.max(0,this.curScores),this.ui.set_score(this.curScores),Math.floor(this.curScores/this.new_live_scores)-t>0&&"classic"===this.mode&&(this.curLives++,this.lives=Math.max(this.curLives,this.lives),this.ui.set_lives(this.curLives,this.lives),this.soundExtraLife.play()),"mission"===this.mode?this.wavesManager.is_tasks&&this.wavesManager.tasks_is_scores&&(this.wavesManager.tasks_scores-=e,this.ui&&this.ui.jumpMissionTask(),this.wavesManager.checkEndOfWave()):(this.stats||(this.stats={}),this.stats.hasOwnProperty("classic_scores")||(this.stats.classic_scores=0),this.stats.classic_scores+=this.curScores,this.curScores>this.oldBestScores&&(this.newBestScores=this.curScores,this.bestClassicScores=Math.max(this.bestClassicScores,this.newBestScores)),this.saveSaves()),this.checkReminders()}},{key:"addLife",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;this.lives+=e,this.curLives+=e,this.curLives=Math.min(this.lives,this.curLives),this.ui.set_lives(this.curLives,this.lives)}},{key:"refillLifes",value:function(){this.curLives=this.lives,this.ui.set_lives(this.curLives,this.lives)}},{key:"setScoreIncrease",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;this.scoreIncreaseMult=e}},{key:"gameOver",value:function(){var e=this;this.isGameOver=!0,this.cmgData(),this.wavesManager.resetCurVars(),this.wavesManager.missionGenerator.reset(),this.stats||(this.stats={}),this.stats.hasOwnProperty("beaten_waves_and_missions")||(this.stats.beaten_waves_and_missions=0),this.shipsSaves[this.shipType]||(this.shipsSaves[this.shipType]={highest_m:0,best_score_m:0,best_score_c:0}),"mission"===this.mode?(this.wavesManager.curMission+1>this.highestMission&&(this.highestMission=this.wavesManager.curMission+1),this.curScores>this.shipsSaves[this.shipType].best_score_m&&(this.shipsSaves[this.shipType].best_score_m=this.curScores),this.wavesManager.curMission+1>this.shipsSaves[this.shipType].highest_m&&(this.shipsSaves[this.shipType].highest_m=this.wavesManager.curMission+1)):(this.wavesManager.curWave+1>this.highestWave&&(this.highestWave=this.wavesManager.curWave+1),this.curScores>this.shipsSaves[this.shipType].best_score_c&&(this.shipsSaves[this.shipType].best_score_c=this.curScores)),this.saveSaves(),this.ui.fadeOut({wait:700,time:300},function(){e.scene.pause("IngameUI")}),this.mobileJoystick.fadeOut({wait:700,time:300},function(){e.scene.pause("MobileJoystick")}),setTimeout(function(){e.wavesManager.timerSoundBeats&&e.wavesManager.timerSoundBeats.remove(),e.wavesManager.timerSpawnUfoDelay&&e.wavesManager.timerSpawnUfoDelay.remove(),e.wavesManager.enemiesManager.controlEnemiesSound(),e.createScorePanel()},1e3)}},{key:"createMissionCompletePanel",value:function(e){this.scene.wake("MissionCompleteUI",{text:e}),this.scene.moveUp("MissionCompleteUI"),this.scene.moveAbove("IngameUI","MissionCompleteUI")}},{key:"createPausePanel",value:function(){this.isGameOver||this.isMissionCompleted||(this.scene.pause(),this.scene.pause("IngameUI"),this.scene.pause("MissionUI"),this.scene.pause("MobileJoystick"),this.scene.wake("PauseUI"),this.scene.moveUp("PauseUI"),this.scene.moveAbove("MobileJoystick","PauseUI"))}},{key:"createScorePanel",value:function(){this.scene.wake("ScoreUI",{mode:this.mode,scores:this.curScores,old_best:this.oldBestScores}),this.scene.moveUp("ScoreUI"),this.scene.moveAbove("MobileJoystick","ScoreUI"),this.soundGameOver.play()}},{key:"checkReminders",value:function(){var e=Phaser.GLOBALS.units_waves.ships.units;for(var t in e)if(!Phaser.GLOBALS.saves.ships[t].hasOwnProperty("locked")||Phaser.GLOBALS.saves.ships[t].locked){var s=e[t],i=s.unlock&&s.unlock.rules?s.unlock.rules:null,n=!1;if(i)for(var r in i)if("e_descr"!==r&&i[r]>0)switch(r){case"classic_scores":i[r]<=this.bestClassicScores&&(n=!0);break;case"reach_wave":i[r]<=this.highestWave&&(n=!0);break;case"reach_mission":i[r]<=this.highestMission&&this.scene.isActive("MissionUI")&&(n=!0);break;case"destroy_asteroids":this.stats.hasOwnProperty("destroyed_asteroids")&&i[r]<=this.stats.destroyed_asteroids&&(n=!0);break;case"destroy_ufos":this.stats.hasOwnProperty("destroyed_ufos")&&i[r]<=this.stats.destroyed_ufos&&(n=!0);break;case"beat_waves_and_missions":this.stats.hasOwnProperty("beaten_waves_and_missions")&&i[r]<=this.stats.beaten_waves_and_missions&&(n=!0)}n&&(Phaser.GLOBALS.saves.ships[t].locked=!1,this.saveSaves(),this.createReminderPanel({ship_type:t,delay:400}),this.cmgUnlockShip(t))}}},{key:"createReminderPanel",value:function(e){this.scene.wake("ReminderUI",e),this.soundNewShipUnlocked.play()}},{key:"createMissionPanel",value:function(e){this.shipsGroup.getChildren().forEach(function(e){e.active&&e.setAlpha(0)}),this.scene.pause(),this.scene.pause("MissionCompleteUI"),this.scene.pause("IngameUI"),this.scene.pause("MobileJoystick"),this.scene.setVisible(!1,"IngameUI"),this.scene.setVisible(!1,"MobileJoystick"),this.scene.wake("MissionUI",e),this.scene.moveUp("MissionUI")}},{key:"restartScene",value:function(){for(var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=this.asteroidsGroup.getChildren().length-1;t>=0;t--){var s=this.asteroidsGroup.getChildren()[t];s.hide(!0)}for(var i=this.enemiesGroup.getChildren().length-1;i>=0;i--){var n=this.enemiesGroup.getChildren()[i];n.timerMoveDelay&&n.timerMoveDelay.remove(),n.timerWaitBeforeFirstShot&&n.timerWaitBeforeFirstShot.remove(),n.timerShotDelay&&n.timerShotDelay.remove(),n.hide(!0)}this.wavesManager.resetCurVars(),this.scene.sleep("IngameUI"),this.scene.sleep("MenuUI"),this.scene.sleep("MobileJoystick"),this.scene.sleep("PauseUI"),this.scene.resume("GameScene"),this.scene.sleep("IngameUI"),this.effectsManager.reset(),this.shipsManager.reset(),"menu"===this.layoutState?this.runMenu(e):this.runGame(e)}},{key:"update",value:function(e,t){}},{key:"loadSaves",value:function(){Phaser.GLOBALS.hasOwnProperty("saves")&&(this.mode=Phaser.GLOBALS.saves.game_mode,this.players=Phaser.GLOBALS.saves.players,this.is_sound=Phaser.GLOBALS.saves.sound,this.bestClassicScores=Phaser.GLOBALS.saves.best_score_classic,this.bestMissionScores=Phaser.GLOBALS.saves.best_score_mission,this.highestMission=Phaser.GLOBALS.saves.highest_mission,this.highestWave=Phaser.GLOBALS.saves.highest_wave,this.stats=Phaser.GLOBALS.saves.stats,this.shipType=Phaser.GLOBALS.saves.ship_type,this.shipsSaves=Phaser.GLOBALS.saves.ships)}},{key:"saveSaves",value:function(){Phaser.GLOBALS.hasOwnProperty("saves")||(Phaser.GLOBALS.saves={}),Phaser.GLOBALS.saves.game_mode=this.mode,Phaser.GLOBALS.saves.players=this.players,Phaser.GLOBALS.saves.sound=this.is_sound,Phaser.GLOBALS.saves.best_score_classic=this.bestClassicScores,Phaser.GLOBALS.saves.best_score_mission=this.bestMissionScores,Phaser.GLOBALS.saves.highest_mission=this.highestMission,Phaser.GLOBALS.saves.highest_wave=this.highestWave,Phaser.GLOBALS.saves.stats=this.stats,Phaser.GLOBALS.saves.ship_type=this.shipType,Phaser.GLOBALS.saves.ships=this.shipsSaves,Phaser.GLOBALS.save_data()}},{key:"cmgStart",value:function(){this.stats||(this.stats={}),this.stats.hasOwnProperty("total_games_played")||(this.stats.total_games_played=0);var e="";e+="classic"===this.mode?0:1,e+=this.stats.total_games_played<10?"0"+this.stats.total_games_played:Math.min(50,this.stats.total_games_played);var t="classic"===this.mode?this.highestWave:this.highestMission;if(e+=t<10?"0"+t:Math.min(50,t),e+=["ship_classic","ship_zoomy","ship_tanky","ship_mini","ship_backy","ship_drilly","ship_multi"].indexOf(this.shipType)+1,window.hasOwnProperty("cmgGameEvent"))window.cmgGameEvent("start",e);else try{parent&&parent.hasOwnProperty("cmgGameEvent")&&parent.cmgGameEvent("start",e)}catch(e){}console.log("%c%s","color: green; font: bold 1.3em/1 Arial;","cmgGameEvent --- start --- "+e),this.stats.total_games_played++,this.saveSaves()}},{key:"cmgData",value:function(){var e="";if(this.stats&&this.stats.total_games_played?this.stats.total_games_played<=4?e+=1:this.stats.total_games_played<=19?e+=2:e+=3:e+=0,"classic"===this.mode?e+=0:this.wavesManager.is_black_hole?e+=5:this.wavesManager.is_ufo_attack?e+=4:this.wavesManager.is_mines?e+=3:this.wavesManager.is_timed_survival?e+=2:e+=1,e+=["ship_classic","ship_zoomy","ship_tanky","ship_mini","ship_backy","ship_drilly","ship_multi"].indexOf(this.shipType)+1,"classic"===this.mode?e+=this.wavesManager.curWave+1<10?"0"+(this.wavesManager.curWave+1):Math.min(99,this.wavesManager.curWave+1):e+=this.wavesManager.curMission+1<10?"0"+(this.wavesManager.curMission+1):Math.min(99,this.wavesManager.curMission+1),e+=Math.min(3,this.lostLives),e+=this.isGameOver?1:0,window.hasOwnProperty("cmgDataEvent"))window.cmgDataEvent("data",e);else try{parent&&parent.hasOwnProperty("cmgDataEvent")&&parent.cmgDataEvent("data",e)}catch(e){}console.log("%c%s","color: blue; font: bold 1.3em/1 Arial;","cmgDataEvent --- data --- "+e)}},{key:"cmgUnlockShip",value:function(e){var t="9";if(t+=["ship_classic","ship_zoomy","ship_tanky","ship_mini","ship_backy","ship_drilly","ship_multi"].indexOf(e)+1,this.stats&&this.stats.total_games_played?t+=this.stats.total_games_played<10?"0"+this.stats.total_games_played:Math.min(99,this.stats.total_games_played):t+="00",window.hasOwnProperty("cmgDataEvent"))window.cmgDataEvent("data",t);else try{parent&&parent.hasOwnProperty("cmgDataEvent")&&parent.cmgDataEvent("data",t)}catch(e){}console.log("%c%s","color: orange; font: bold 1.3em/1 Arial;","cmgDataEvent --- unlocked --- "+t)}},{key:"runTimerGameOverPanel",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){};this.timerGameOverPanel=this.time.addEvent({delay:e,callback:t,callbackScope:this})}},{key:"runTimerExtraLiveSound",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:100;this.timerExtraLiveSound&&this.timerExtraLiveSound.remove(),this.soundExtraShip.stop(),this.soundExtraShip.play(),this.timerExtraLiveSound=this.time.addEvent({delay:t,repeat:8,callback:function(){e.soundExtraShip.stop(),e.soundExtraShip.play()},callbackScope:this})}},{key:"soundFadeTo",value:function(e,t,s){e.isFading=!0,e.tweenFadeOut&&e.tweenFadeOut.remove(),e.tweenFadeOut=this.tweens.add({targets:e,volume:t,duration:s,ease:"Linear",onComplete:function(){e.isFading=!1,e.stop(),e.tweenFadeOut.remove()}},this)}},{key:"set_best",value:function(e){return this.oldBestScores=0,"classic"===this.mode?Phaser.GLOBALS.saves.ships&&Phaser.GLOBALS.saves.ships[this.shipType]&&Phaser.GLOBALS.saves.ships[this.shipType].best_score_c&&(this.oldBestScores=Phaser.GLOBALS.saves.ships[this.shipType].best_score_c):Phaser.GLOBALS.saves.ships&&Phaser.GLOBALS.saves.ships[this.shipType]&&Phaser.GLOBALS.saves.ships[this.shipType].highest_m&&(this.oldBestScores=Phaser.GLOBALS.saves.ships[this.shipType].highest_m),this}},{key:"set_lives",value:function(e){return this.lives=e,this.curLives=this.lives,this}},{key:"set_new_live_scores",value:function(e){return this.new_live_scores=e,this}},{key:"set_start_sound_delay",value:function(e){return this.start_sound_delay=e,this}},{key:"set_end_sound_delay",value:function(e){return this.end_sound_delay=e,this}},{key:"readConfig",value:function(e){return this.set_lives(g(e,"lives",this.lives).value),this.set_new_live_scores(g(e,"new_live_scores",this.new_live_scores).value),this}}])&&Wo(s.prototype,i),n&&Wo(s,n),t}();function Jo(e){return(Jo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Zo(e,t){for(var s=0;s<t.length;s++){var i=t[s];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function qo(e,t){return!t||"object"!==Jo(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function $o(e){return($o=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function eh(e,t){return(eh=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var th=function(e){function t(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=qo(this,$o(t).call(this,{key:"ReminderUI"}))).gameScene=null,e.panelsManager=null,e.reminderTitle=null,e.reminderShip=null,e.reminderCont=null,e.tweenHideBg=null,e.tweenHideTitle=null,e.tweenHideShip=null,e.timeoutHidePanel=null,e}var s,i,n;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&eh(e,t)}(t,Phaser.Scene),s=t,(i=[{key:"create",value:function(e){var t=this;this.gameScene=this.scene.get("GameScene"),this.panelsManager=new Pn(this),this.createReminderUI(),this.events.on("wake",function(e){var s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};t.setShip(s.ship_type||"ship_classic"),t.runPanel(void 0!==s.delay?s.delay:0),t.tweenHideBg&&t.tweenHideBg.stop(),t.tweenHideTitle&&t.tweenHideTitle.stop(),t.tweenHideShip&&t.tweenHideShip.stop(),t.timeoutHidePanel&&clearTimeout(t.timeoutHidePanel),t.scene.moveAbove("MissionUI","ReminderUI"),t.timeoutHidePanel=setTimeout(function(){t.hidePanel()},2500)}),this.scene.sleep()}},{key:"setShip",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"ship_classic",t=Phaser.GLOBALS.units_waves.ships.units;this.reminderTitle.setText("New ship unlocked:\n"+t[e].name.toUpperCase()),this.reminderShip.setTexture("atlas_objects","panels/carusel_"+t[e].skin+".png")}},{key:"createReminderUI",value:function(){this.game.config.width,this.game.config.height,this.reminderBg=this.panelsManager.addImage({init_x:0,init_y:45,origin:[0,.5],key:["atlas_objects","panels/reminder_bg.png"]}),this.reminderBg.scale=2,this.reminderTitle=this.panelsManager.addBitmapText({init_x:20,init_y:0,origin:[0,0],font:"aller_white",text:"New ship unlocked:\n[SHIP NAME]",font_size:16,align_h:"left"}),this.reminderShip=this.panelsManager.addImage({init_x:50,init_y:70,key:["atlas_objects","panels/carusel_ship_1.png"]}),this.reminderShip.scale=.5,this.reminderCont=this.panelsManager.addContainer({init_x:0,init_y:.2,anchor_ltrd:"lt",anchor_weight:[1,1],children:[this.reminderBg,this.reminderTitle,this.reminderShip]})}},{key:"runPanel",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;this.tweens.pauseAll(),this.reminderCont.setVisible(!0),this.reminderBg.setAlpha(0),this.reminderBg.setVisible(!0),this.tweens.add({targets:this.reminderBg,delay:e,props:{alpha:{value:1,duration:200,ease:"Linear"}}},this),this.reminderTitle.setAlpha(0),this.reminderTitle.x=this.reminderTitle.init_x-50,this.reminderTitle.setVisible(!0),this.tweens.add({targets:this.reminderTitle,delay:e,props:{alpha:{value:1,duration:200,ease:"Linear"},x:{value:this.reminderTitle.init_x,duration:400,ease:"Quad.Out"}}},this),this.reminderShip.setAlpha(0),this.reminderShip.x=this.reminderShip.init_x-50,this.reminderShip.setVisible(!0),this.tweens.add({targets:this.reminderShip,delay:e,props:{alpha:{value:1,duration:200,ease:"Linear"},x:{value:this.reminderShip.init_x,duration:400,ease:"Quad.Out"}}},this)}},{key:"hidePanel",value:function(){var e=this;this.tweenHideBg=this.tweens.add({targets:this.reminderBg,props:{alpha:{value:0,duration:200,ease:"Linear"}},onComplete:function(){e.reminderBg.setVisible(!1)}},this),this.tweenHideTitle=this.tweens.add({targets:this.reminderTitle,props:{alpha:{value:0,duration:200,ease:"Linear"},x:{value:this.reminderTitle.init_x-30,duration:400,ease:"Quad.In"}},onComplete:function(){e.reminderTitle.setVisible(!1)}},this),this.tweenHideShip=this.tweens.add({targets:this.reminderShip,props:{alpha:{value:0,duration:200,ease:"Linear"},x:{value:this.reminderShip.init_x-30,duration:400,ease:"Quad.In"}},onComplete:function(){e.reminderShip.setVisible(!1)}},this)}}])&&Zo(s.prototype,i),n&&Zo(s,n),t}();function sh(e){return(sh="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ih(e,t){for(var s=0;s<t.length;s++){var i=t[s];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function nh(e,t){return!t||"object"!==sh(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function rh(e){return(rh=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function ah(e,t){return(ah=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var oh=function(e){function t(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=nh(this,rh(t).call(this,{key:"MissionUI"}))).gameScene=null,e.panelsManager=null,e.mission_num=1,e.mission_name="Destroy certain objects\nin a certain amount of time",e.descr="Stay Alive\nfor 320 sec",e.panel_shading=null,e.panel_bg_purple=null,e.missionNum=null,e.title=null,e.descrText=null,e.cont=null,e.isInputActive=!1,e.curMissionShipPosition=0,e}var s,i,n;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ah(e,t)}(t,Phaser.Scene),s=t,(i=[{key:"create",value:function(e){var t=this;this.gameScene=this.scene.get("GameScene"),this.panelsManager=new Pn(this),this.createMissionUI(),this.input.keyboard.on("keydown",function(e){Phaser.EDITOR||e.preventDefault(),t.isInputActive&&(e.keyCode!==Phaser.Input.Keyboard.KeyCodes.SPACE||t.gameScene.keyPressed.has(e.keyCode)||(t.gameScene.keyPressed.add(e.keyCode),t.goHandler(),t.btnGo.soundDown.play()))}),this.input.keyboard.on("keyup",function(e){t.isInputActive&&t.gameScene.keyPressed.delete(e.keyCode)}),this.events.on("wake",function(e){var s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};t.cameras.main.fadeIn(0),t.mission_num=s.mission_num||t.mission_num,t.mission_name=s.title||t.mission_name,t.descr=s.descr||t.descr,t.set_mission_num(),t.set_title(),t.set_descr(),t.gameScene.checkReminders(),t.isInputActive=!1,setTimeout(function(){t.isInputActive=!0,t.gameScene.keyPressed.clear()},300)}),this.scene.sleep()}},{key:"goHandler",value:function(){this.gameScene.shipsGroup.getChildren().forEach(function(e){e.active&&e.setAlpha(1)}),this.gameScene.effectsManager.reset(),this.isInputActive=!1,this.scene.sleep(),this.gameScene.scene.resume(),this.scene.resume("IngameUI"),this.scene.resume("MobileJoystick"),this.scene.setVisible(!0,"IngameUI"),this.gameScene.isMobile&&this.scene.setVisible(!0,"MobileJoystick"),this.gameScene.wavesManager.runMissionTaskAndGame()}},{key:"set_mission_num",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.mission_num;this.mission_num=e,this.missionNum.setText("MISSION "+this.mission_num)}},{key:"set_title",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.mission_name;this.mission_name=e,this.title.setText(this.mission_name)}},{key:"set_descr",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.descr;this.descr=e,this.descrText.setText(this.descr)}},{key:"recreateProgressLine",value:function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,s=0;s<this.actionsProgressIcons.list.length;s++)s<e.length&&this.actionsProgressIcons.list[s].setTexture("atlas_objects","panels/action_progress_icon_"+e[s].mission+".png"),this.actionsProgressNumbers.list[s].setText(t+1+s);var i=Phaser.GLOBALS.units_waves.ships.units;this.missionProgressHeroGO.setTexture("atlas_objects","panels/mission_"+i[this.gameScene.shipType].skin+".png"),this.actionsProgressShipsUnlocks.visible=!0,t>=e.length&&(this.actionsProgressShipsUnlocks.visible=!1),this.actionsProgressBest.visible=!1;var n=Phaser.GLOBALS.saves.ships[this.gameScene.shipType].highest_m;n>0&&n>=t&&n<=t+this.actionsProgressIcons.list.length&&(this.actionsProgressBest.x=this.actionsProgressNumbers.list[Math.max(0,n-1)%this.actionsProgressIcons.list.length].x,this.actionsProgressBest.visible=!0),this.resetProgressHeroPos()}},{key:"setProgressHeroPosition",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;if(this.curMissionShipPosition<this.actionsProgressIcons.list.length&&t>this.curMissionShipPosition){var s=t%this.actionsProgressIcons.list.length;this.tweenProgressHeroPos&&this.tweenProgressHeroPos.stop(),this.tweenProgressHeroPos=this.tweens.add({targets:this.actionsProgressHero,props:{x:{delay:100,value:this.actionsProgressIcons.list[s].x,duration:800,ease:"Cubic.easeOut"}},onStart:function(){if(s>0){var t=e.actionsProgressIcons.list[s-1].frame.name.replace(/(_off)?\.png$/i,"");e.actionsProgressIcons.list[s-1].setTexture("atlas_objects",t+"_off.png"),e.actionsProgressNumbers.list[s-1].alpha=.3}}},this),this.curMissionShipPosition=s;var i=Phaser.GLOBALS.saves.ships[this.gameScene.shipType].highest_m;i<=t+1&&(this.tweenProgressBestPos&&this.tweenProgressBestPos.stop(),this.tweenProgressBestPos=this.tweens.add({targets:this.actionsProgressBest,props:{x:{delay:100,value:this.actionsProgressIcons.list[s].x,duration:800,ease:"Cubic.easeOut"}}},this),t>1&&(this.actionsProgressBest.visible=!0))}}},{key:"resetProgressHeroPos",value:function(){this.curMissionShipPosition=0,this.tweenProgressHeroPos&&this.tweenProgressHeroPos.stop(),this.actionsProgressHero.x=this.actionsProgressIcons.list[this.curMissionShipPosition].x;for(var e=0;e<this.actionsProgressIcons.list.length;e++){var t=this.actionsProgressIcons.list[e].frame.name.replace(/(_off)?\.png$/i,"");this.actionsProgressIcons.list[e].setTexture("atlas_objects",t+".png"),this.actionsProgressNumbers.list[e].alpha=1}}},{key:"createMissionUI",value:function(){var e=this,t=this.game.config.width/2,s=this.game.config.height/2;this.panel_shading=this.add.tileSprite(t,s,2e3,2e3,"atlas_objects","panels/panel_shading.png"),this.panel_shading.setAlpha(1),this.missionNum=this.panelsManager.addBitmapText({init_x:0,init_y:-45,origin:[.5],font:"aller_white",text:"MISSION 2",font_size:22,align_h:"center"}),this.title=this.panelsManager.addBitmapText({init_x:0,init_y:0,origin:[.5],font:"yellow",text:"Destroy certain objects\nin a certain amount of time",font_size:27,align_h:"center"}),this.descrText=this.panelsManager.addColoredBitmapText({init_x:0,init_y:40,origin:[.5],font:"aller_white_it",text:'Stay Alive\nfor <font="yellow" size=50>320</> sec',font_size:16,align_h:"center",line_height:30}),this.panelsManager.addContainer({init_x:.5,init_y:.23,anchor_ltrd:"t",anchor_weight:[1,.3],children:[this.missionNum,this.title,this.descrText]});var i=this.panelsManager.addSprite({key:["atlas_objects","panels/actions_progress_line.png"]}),n={};for(var r in this.gameScene.missionsShipsUnlocks)n[this.gameScene.missionsShipsUnlocks[r].unlock_level]={ship_type:r,carusel_skin:this.gameScene.missionsShipsUnlocks[r].carusel_skin};for(var a=[],o=[],h=this.gameScene.missionsPregeneratedCount,l=i.width/(h-1),u=0;u<h;u++){var c=Math.round(u*l-l*(h-1)/2);a.push(this.panelsManager.addBitmapText({init_x:c,init_y:33,origin:[.5],font:"aller_white",text:u+1,font_size:18,align_h:"center"})),o.push(this.panelsManager.addSprite({init_x:c,init_y:-3,key:["atlas_objects","panels/action_progress_icon_mines.png"]}))}this.actionsProgressNumbers=this.panelsManager.addContainer({init_x:0,init_y:0,children:a}),this.actionsProgressShipsUnlocks=this.panelsManager.addContainer({init_x:0,init_y:0,children:[]}),this.actionsProgressIcons=this.panelsManager.addContainer({init_x:0,init_y:0,children:o}),this.missionProgressHeroGO=this.panelsManager.addSprite({init_x:0,init_y:-60,scale:.7,rotation:Math.PI/2,key:["atlas_objects","panels/carusel_ship_1.png"]}),this.actionsProgressHero=this.panelsManager.addContainer({init_x:this.actionsProgressIcons.list[0].x,init_y:0,children:[this.missionProgressHeroGO]}),this.actionsProgressBest=this.panelsManager.addBitmapText({init_x:this.actionsProgressIcons.list[0].x,init_y:60,font:"aller_red",text:"BEST",font_size:14,align_h:"center"}),this.actionsProgress=this.panelsManager.addContainer({init_x:.5,init_y:.6,anchor_ltrd:"",anchor_weight:[1,1],children:[i,this.actionsProgressIcons,this.actionsProgressNumbers,this.actionsProgressHero,this.actionsProgressBest]}),this.btnGo=this.panelsManager.addButton({init_x:.5,init_y:.85,anchor_ltrd:"d",anchor_weight:[1,.65],tween_down:{type:"scale_down"},bg:{on:["atlas_objects","panels/btn_go.png"]},text:{text:"GO",weight:"bold",font_size:26,pos:[.5,4],is_bitmap:!0,font:"white"},sound:{down:"press_go_button"}}),this.btnGo.on("down",function(t){e.goHandler()})}},{key:"runPanel",value:function(){var e=this;this.tweens.pauseAll(),this.cont.setVisible(!0),this.panel_bg_purple.setAlpha(0),this.panel_bg_purple.setSize(25,35),this.panel_bg_purple.setAngle(-10),this.panel_bg_purple.setVisible(!0),this.tweens.timeline({targets:this.panel_bg_purple,tweens:[{alpha:.9,ease:"Quad.easeOut",duration:99},{alpha:.9,ease:"Linear",duration:2640},{alpha:0,ease:"Linear",duration:66,onComplete:function(){e.scene.sleep("MissionUI")}}]}),this.tweens.timeline({targets:this.panel_bg_purple,tweens:[{width:600,ease:"Quad.easeOut",duration:99},{width:2e3,ease:"Linear",duration:66},{width:2e3,ease:"Linear",duration:2508},{width:400,ease:"Quad.easeIn",duration:66},{width:110,ease:"Linear",duration:66}]}),this.tweens.timeline({targets:this.panel_bg_purple,tweens:[{height:4,ease:"Quad.easeInOut",duration:99},{height:14,ease:"Linear",duration:99},{height:166,ease:"Quad.easeOut",duration:165},{height:162,ease:"Linear",duration:2310},{height:4,ease:"Quad.easeIn",duration:66},{height:8,ease:"Linear",duration:66}]}),this.tweens.timeline({targets:this.panel_bg_purple,tweens:[{angle:0,ease:"Quad.easeOut",duration:99},{angle:0,ease:"Linear",duration:2640},{angle:12,ease:"Linear",duration:66}]}),this.title.setAlpha(0),this.title.x=-148,this.title.setVisible(!0),this.tweens.timeline({targets:this.title,tweens:[{alpha:0,ease:"Linear",duration:264},{alpha:1,ease:"Quad.easeOut",duration:297},{alpha:1,ease:"Linear",duration:1320},{alpha:0,ease:"Quad.easeIn",duration:429}]}),this.tweens.timeline({targets:this.title,tweens:[{alpha:0,ease:"Linear",duration:264},{x:4,ease:"Quad.easeOut",duration:297},{x:-2,ease:"Quad.easeInOut",duration:1320},{x:167,ease:"Quad.easeIn",duration:429}]}),this.descrText.setAlpha(0),this.descrText.x=2,this.descrText.setVisible(!0),this.tweens.timeline({targets:this.descrText,tweens:[{alpha:0,ease:"Linear",duration:330},{alpha:1,ease:"Linear",duration:429},{alpha:1,ease:"Linear",duration:1551},{alpha:0,ease:"Linear",duration:429}]}),this.tweens.timeline({targets:this.descrText,tweens:[{alpha:0,ease:"Linear",duration:330},{x:14,ease:"Linear",duration:2310}]})}}])&&ih(s.prototype,i),n&&ih(s,n),t}(),hh={type:Phaser.AUTO,pixelArt:!1,roundPixels:!1,backgroundColor:"#000000 ",maxWidth:1600,maxHeight:1600,scale:{parent:"canvas-div",mode:Phaser.Scale.NONE,width:600,height:500},plugins:{scene:[{key:"ScreenResizer",plugin:u,mapping:"screenResizer"}]},scene:[_,Xo,za,so,Po,Ao,Io,th,oh,Ho],physics:{default:"arcade",arcade:{debug:!1}}};window.addEventListener("load",function(){var e=new Phaser.Game(hh);Phaser.GLOBALS={saves_name:"retro_space_blaster",saves:{game_mode:"mission",players:1,sound:1,best_score_classic:0,best_score_mission:0,highest_mission:0,highest_wave:0,stats:{destroyed_asteroids:0,destroyed_ufos:0,beaten_waves_and_missions:0,classic_scores:0,total_games_played:0},ship_type:"ship_classic",ships:{ship_classic:{highest_m:0,best_score_m:0,best_score_c:0,locked:!0},ship_zoomy:{highest_m:0,best_score_m:0,best_score_c:0,locked:!0},ship_tanky:{highest_m:0,best_score_m:0,best_score_c:0,locked:!0},ship_mini:{highest_m:0,best_score_m:0,best_score_c:0,locked:!0},ship_backy:{highest_m:0,best_score_m:0,best_score_c:0,locked:!0},ship_multi:{highest_m:0,best_score_m:0,best_score_c:0,locked:!0},ship_drilly:{highest_m:0,best_score_m:0,best_score_c:0,locked:!0}}},save_data:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Phaser.GLOBALS.saves;localStorage.setItem(Phaser.GLOBALS.saves_name,JSON.stringify(e))},load_data:function(){var e=JSON.parse(localStorage.getItem(Phaser.GLOBALS.saves_name));e&&(Phaser.GLOBALS.saves.game_mode=e.game_mode||Phaser.GLOBALS.saves.game_mode,Phaser.GLOBALS.saves.players=e.players||Phaser.GLOBALS.saves.players,Phaser.GLOBALS.saves.sound=void 0!==e.sound?e.sound:Phaser.GLOBALS.saves.sound,Phaser.GLOBALS.saves.best_score_classic=e.best_score_classic||0,Phaser.GLOBALS.saves.best_score_mission=e.best_score_mission||0,Phaser.GLOBALS.saves.highest_mission=e.highest_mission||0,Phaser.GLOBALS.saves.highest_wave=e.highest_wave||0,Phaser.GLOBALS.saves.stats=e.stats&&Object.keys(e.stats).length>0?e.stats:Phaser.GLOBALS.saves.stats,Phaser.GLOBALS.saves.ship_type=e.ship_type||Phaser.GLOBALS.saves.ship_type,Phaser.GLOBALS.saves.ships=e.ships&&Object.keys(e.ships).length>0?e.ships:Phaser.GLOBALS.saves.ships)}};var t,s=function(t){var s=document.getElementById("canvas-div"),i=Math.min(s.clientWidth,window.innerWidth),n=Math.min(s.clientHeight,window.innerHeight);if(e.width!==i||e.height!==n){e.width=i,e.height=n;var r,a=0,o=0,h=0,l=0,u=0,c=0;1.2,h=600,l=500,u=i,c=n,(r=i/n/1.2)>1?(h=Math.floor(600*r),a=(i-(u=n*((h=Math.min(e.config.maxWidth,h))/l)))/2):r<1&&(l=Math.floor(500/r),o=(n-(c=i/(h/(l=Math.min(e.config.maxHeight,l)))))/2),e.scale.resize(h,l),e.canvas.style.width=Math.round(u)+"px",e.canvas.style.height=Math.round(c)+"px",s.style.marginLeft=Math.round(a)+"px",s.style.marginTop=Math.round(o)+"px",e.scale.refresh()}};window.addEventListener("resize",function(e){var i=/edge\//i.test(navigator.userAgent),n=(/msie/i.test(navigator.userAgent)||/trident/i.test(navigator.userAgent)||/iemobile/i.test(navigator.userAgent))&&!(void 0).isMicrosoftEdge;(/iphone/i.test(navigator.userAgent)||/ipod/i.test(navigator.userAgent))&&!n&&!i&&!t?t=setInterval(function(){window.scrollTo(0,-1),s()},500):s()}),s()})},529:function(e,t,s){s(1430),e.exports=s(1429)}});